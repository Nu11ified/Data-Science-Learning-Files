"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1990],{86671:function(e,t,a){a.d(t,{GG:function(){return ep},KN:function(){return A},aA:function(){return m}});var n=a(75271),i=a(74471),r=a(44962),s=a(29940),o=a(51484),c=a(47805);a(86763);var l=a(33966),p=a(14224);function d(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===a&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}d("/** Namespacing with magiclink__ **/\n.magiclink__wrapper {\n  text-align: center;\n  background-color: #ffffff;\n  font-weight: 400;\n}\n.magiclink__wrapper.special-offers {\n  background-color: transparent;\n}\n.magiclink__wrapper p, .magiclink__wrapper h1 {\n  padding: 0;\n}\n.magiclink__wrapper h1.font--headline {\n  font-size: 24px;\n}\n.magiclink__wrapper a {\n  color: inherit;\n  text-decoration: underline;\n}\n.magiclink__wrapper .magiclink__container {\n  padding: 48px;\n}\n.magiclink__wrapper .magiclink__container.magiclink__bad-password, .magiclink__wrapper .magiclink__container.magiclink__finish-setting-your-acct {\n  padding-top: 24px;\n}\n@media screen and (max-width: 655px) {\n  .magiclink__wrapper .magiclink__container {\n    padding-left: 24px;\n    padding-right: 24px;\n  }\n}\n.magiclink__wrapper .magiclink__container.magiclink__logmein {\n  position: relative;\n  min-height: 300px;\n  padding: 0;\n}\n.magiclink__wrapper .inner-content {\n  background-color: #ffffff;\n  padding: 16px 24px;\n}\n.magiclink__wrapper .icon-inbox {\n  height: 60px;\n}\n.magiclink__wrapper .icon-inbox > div {\n  background-color: #fff;\n}\n.magiclink__wrapper .resending {\n  color: #00b16a;\n}\n.magiclink__wrapper .resending.error {\n  color: #d9202c;\n}\n.magiclink__wrapper .header {\n  background-color: #e1e1e1;\n  height: 48px;\n  color: #888;\n  font-size: 14px;\n  border-radius: 2px 2px 0 0;\n  font-weight: 400;\n  border: 1px solid rgb(241, 241, 241);\n  display: flex;\n}\n.magiclink__wrapper .header .header-content {\n  display: flex;\n  margin-left: 16px;\n  width: 100%;\n}\n.magiclink__wrapper .header .header-content a {\n  font-size: 16px;\n  color: #888888;\n  text-decoration: none;\n  display: flex;\n  align-items: center;\n}\n.magiclink__wrapper .header .header-content a:hover {\n  text-decoration: underline;\n}\n.magiclink__wrapper .header .header-content a span {\n  margin-left: 2px;\n}\n.magiclink__wrapper .magiclink__footer {\n  margin-top: 36px;\n}\n.magiclink__wrapper .magiclink__footer .resending {\n  color: #00b16a;\n}\n.magiclink__wrapper .magiclink__footer .resending.error {\n  color: #d9202c;\n}"),n.Fragment,n.Fragment;let m={AMAZON:"amazon",FACEBOOK:"facebook",GOOGLE:"google",TWP:"washington post",APPLE:"apple",SSO:"sso"};async function u(e,t={method:"GET"}){let a=`${o.ENDPOINTS.base}${e}`,n={...t};n.headers={...o.DEFAULT_HEADERS,...n.headers};let i=await fetch(a,n);return i.status>=500?(function(e,t){let a=document.createEvent("CustomEvent");a.initCustomEvent(e,!0,!0,t),dispatchEvent(a)}("fetchData:error",i),Promise.reject("A network error occurred.")):await i.json()}let g=(e,t)=>{let a={key:"",value:""};if("undefined"!=typeof window&&(t||(t=window.location.search),t)){let n=t.substr(1,t.length).split("&").reduce((e,t)=>{let a=t.split("="),n={key:a[0],value:a[1]};return a&&e.push(n),e},[]);return e?n.find(t=>t.key===e)||a:n}return a},E=(e,t)=>{let a=g(void 0,decodeURIComponent(decodeURIComponent(e)));if(a instanceof Array){let e=a.find(e=>"redirectUri"===e.key||"redirect_uri"===e.key),t=a.find(e=>"state"===e.key),n=a.find(e=>"scope"===e.key),i=a.find(e=>"clientId"===e.key||"client_id"===e.key);if(e?.value&&t?.value&&n?.value&&i?.value){let a=e?.value||"";return`${decodeURIComponent(a)}?state=${t?.value}&client_id=${i?.value}&scope=${n?.value}&buy=&account_created=false`}}if(t){let{redirectUri:e,state:a,scope:n,clientId:i}=t;if(e&&a&&n&&i)return`${e}?state=${a}&client_id=${i}&scope=${n}&buy=&account_created=false`}},S=e=>!!decodeURIComponent(e.redirectUri||e.redirect_uri).startsWith("https://podcasts.apple.com/oauth"),_={NATIVE_APP:"native-app",BROWSER:"browser",APPLE_PODCASTS:"apple-podcasts"},R={NOA:"noa",SOCIAL:"social"},f=()=>{let e=(0,o.getQueryParams)(),{NOA:t}=R;return e.case===t?{queryParams:e,type:_.NATIVE_APP}:e.redirect_uri&&S({redirectUri:e.redirect_uri})?{queryParams:e,type:_.APPLE_PODCASTS}:{nextUrl:e.next_url||null,type:_.BROWSER}},O=o.STORAGE.USER_REQUEST_ID,I=()=>{if("undefined"==typeof window)return{appRequestHeaders:{requestId:""},requestId:""};let e="";if("function"==typeof window.crypto?.randomUUID)try{e=window.crypto.randomUUID()}catch{e="crypto-error-"+Date.now().toString()}else e="crypto-missing-"+Date.now().toString();let t=f(),a=(0,o.getLocalStorageItem)(O)||(0,o.getCookie)(O)||e,n={appRequestHeaders:{requestId:a},requestId:a};switch((0,o.getLocalStorageItem)(O)||(0,o.getCookie)(O)||(0,o.setLocalStorageItem)(O,a),t.type){case _.NATIVE_APP:case _.APPLE_PODCASTS:if("queryParams"in t){let{queryParams:e}=t;n={appRequestHeaders:{clientApp:e.client_app,clientAppVersion:e.client_appversion,deviceId:e.device_id,deviceType:e.devicetype,requestId:e.request_id||a},clientId:e.client_id,redirectUri:e.redirect_uri,requestId:e.request_id||a,scope:e.scope,state:e.state},e.request_id&&a!==e.request_id&&(0,o.setLocalStorageItem)(O,e.request_id)}}return n};i.f.colors.$gray80,i.f.colors.$gray400;let P="profile",h={CATEGORY:P,EVENTS:{PAGE_VIEW:"classicPageView",SIGN_IN:{START:`${P}-signin-start`,SELECT:`${P}-signin-select`,COMPLETE:`${P}-signin-complete`},SIGN_UP:{START:`${P}-signin-registration-start`,SELECT:`${P}-signin-registration-select`,COMPLETE:`${P}-signin-registration-complete`},PASSWORD:{SIGN_IN:`${P}-signin-password`,SIGN_UP:`${P}-signin-registration-password`},ERROR:`${P}-signin-error`},PROVIDERS:{AMAZON:"amazon",WAPO:"wapo",FACEBOOK:"facebook",GOOGLE:"google",APPLE:"apple",APPLEPODCAST:"applepodcast",PML:"pml",SSO:"sso"}};h.EVENTS.SIGN_IN.START,h.EVENTS.SIGN_IN.START,h.CATEGORY;let y=e=>Object.freeze({event:h.EVENTS.SIGN_IN.SELECT,action:h.EVENTS.SIGN_IN.SELECT,category:h.CATEGORY,label:e,loginTypeHit:e,loginTypeSession:e}),A={APPLE:y(h.PROVIDERS.APPLE),AMAZON:y(h.PROVIDERS.AMAZON),FACEBOOK:y(h.PROVIDERS.FACEBOOK),GOOGLE:y(h.PROVIDERS.GOOGLE),PML:y(h.PROVIDERS.PML),WAPO:y(h.PROVIDERS.WAPO),APPLEPODCAST:y(h.PROVIDERS.APPLEPODCAST),SSO:y(h.PROVIDERS.SSO)};h.PROVIDERS.APPLE,h.PROVIDERS.AMAZON,h.PROVIDERS.FACEBOOK,h.PROVIDERS.GOOGLE,h.PROVIDERS.PML,h.PROVIDERS.WAPO,h.PROVIDERS.SSO,h.EVENTS.SIGN_UP.START,h.EVENTS.SIGN_UP.START,h.CATEGORY,h.PROVIDERS.APPLE,h.PROVIDERS.AMAZON,h.PROVIDERS.FACEBOOK,h.PROVIDERS.GOOGLE,h.PROVIDERS.PML,h.PROVIDERS.WAPO,h.PROVIDERS.SSO,h.PROVIDERS.APPLE,h.PROVIDERS.AMAZON,h.PROVIDERS.FACEBOOK,h.PROVIDERS.GOOGLE,h.PROVIDERS.PML,h.PROVIDERS.WAPO,h.PROVIDERS.SSO;var w=Object.freeze(h);let T={local:"https://subscribe.digitalink.com",test:"https://subscribe.digitalink.com",dev:"https://subscribe.digitalink.com",development:"https://subscribe.digitalink.com",qa:"https://subscribe.digitalink.com",stg:"https://subs-stage.washingtonpost.com",stage:"https://subs-stage.washingtonpost.com",prod:"https://subscribe.washingtonpost.com"},N={...T};N.dev=`${T.dev.replace("subscribe","pb-dev")}/pb/homepage`,N.qa=`${N.dev}`,N.stage=T.stage.replace("subs-stage","pb-impact"),N.prod=T.prod.replace("subscribe","www"),c.Nu.VERIFY,c.Nu.VERIFY,c.Nu.SOAP,c.Nu.AUTOCONNECT;let v={[o.ResponseState.ACCOUNT_NOT_FOUND]:"Sorry, we don't recognize this account.",[o.ResponseState.LOOKUP_ACCNT_SYSTEM_ERROR]:"Sorry, something went wrong on our end. Please try refreshing this page and sign in again.",[o.ResponseState.USERNAME_MIMA_NOT_MATCH]:"Hmm. We don't recognize this email/password combination.",[o.ResponseState.INVALID_EMAIL_TLD_FAILED]:"Please enter a valid email.",[o.ResponseState.INVALID_DOMAIN]:"Please enter a valid email.",[o.ResponseState.INVALID_EMAIL_OR_MIMA]:"Please choose a stronger password.",[o.ResponseState.APPLE_NOT_FORWARDING_EMAIL_FAILURE]:"We were unable to sign you in with Apple. Please go to your device settings and enable email forwarding and try again."},C=["client_id","device_id","ostype","request_id","redirect_uri","scope","state"],b=(e,t)=>{let a=e=>e.replace(/_[A-z]{1}/,e=>e.substr(1,1).toUpperCase());-1!==C.indexOf(t.key)&&(e[t.key]||(e[a(t.key)]=t.value),e.appRequestHeaders&&!e.appRequestHeaders[t.key]&&(e.appRequestHeaders[a(t.key)]=t.value))},k=e=>{let t=g(),a=g("next_url");if(t instanceof Array&&t.forEach(t=>b(e,t)),"value"in a&&a.value){let t=g(void 0,decodeURIComponent(a.value));t instanceof Array&&t.forEach(t=>b(e,t))}return e},D={COMPLETE_SETUP:"COMPLETE_SETUP",VERIFIED:"STATUS_TWO",SOCIAL_PROVIDER:"SOCIAL_PROVIDER"},L=(e,t)=>{let a=t.match(/\?/)?"&":"?",n=t.split("&"),i=["redirect_uri","scope","state","client_id"],r=n.reduce((e,t)=>{let a=t.split("=");if(-1!==i.indexOf(a[0])){let t=a[0].indexOf("_");if(-1!==t){let e=a[0].charAt(t+1);a[0]=a[0].replace(`_${e}`,e.toUpperCase())}e[a[0]]=a[1]}return e},{});if(e){let{clientId:n,redirectUri:i,scope:s,state:o}=e,{clientId:c,redirectUri:l,scope:p,state:d}=r;c||l||p||d||(t=`${t}${a}client_id=${n}&redirect_uri=${i}&scope=${s}&state=${o}`)}return t},x={"Content-Type":"application/json",Accept:"application/json"},$=({appRequestHeaders:e,body:t})=>{if(e){t.appRequestHeaders=e;let a=t.appRequestHeaders.appRequestHeaders;if(a)for(let e in a)a.hasOwnProperty(e)&&(t.appRequestHeaders[e]=a[e]);delete t.appRequestHeaders.appRequestHeaders}},G=({deviceInfo:e,body:t})=>{if(e){t.appRequestHeaders=e.appRequestHeaders;let{clientId:a,redirectUri:n,scope:i,state:r}=e;a&&n&&i&&r&&(t.authflow=!0,t.clientId=a,t.redirectUri=n,t.scope=i,t.state=r,t.appRequestHeaders=e.appRequestHeaders),$({appRequestHeaders:e.appRequestHeaders,body:t})}},U=async(e,t)=>(await fetch(e,{headers:x,...t})).json(),V=(0,i.a)("div",{"&.isDisplayed > iframe":{marginTop:i.f.space["100"]}}),M=({isInteractiveMode:e,css:t,dataTestId:a})=>n.createElement(V,{id:c.oE,css:t,"data-test-id":a,className:`center${e?" isDisplayed":" "}`}),q={STATUSES:{FINISH_SETTING_UP_ACCT:"12",SOCIAL_PROVIDER_ONLY:"14",BAD_PASSWORD:"21"},FLOW:{PML:"pml",REGISTERING_ACCOUNT_EXISTS:"register_account_exists",RESET_PASSWORD:"reset_password"},NOT_YOU_CLICK:"magiclink/not-you"};I().requestId,w.CATEGORY,o.ENDPOINTS.wapoHomepage;let F={AUTOCONNECT:"autoconnect",BAD_PASSWORD:"bad-password",FORGOT_PASSWORD_EMAIL_SENT:"forgot-password-email-sent",PML_SEND:"pml-send",PML_SENT:"pml-sent",PML_SENT_ACCOUNT_EXISTS:"pml-sent-account-exists",SET_PASSWORD:"set-password",SHOW_EMAIL:"show-email",SHOW_PASSWORD:"show-password",SOAP:"soap",SOCIAL_PROVIDER_ONLY:"social-provider-only",VERIFY:"verify",REGISTERED:"registered"},W=({email:e,onChangeClick:t=()=>{},text:a="Change",dataQa:i,dataTestId:s,className:o="underline pointer ml-xxs gray-dark va-m dib",href:c,asLink:l=!1})=>{let p=e=>{e.preventDefault(),t()};return n.createElement("div",{className:"center change-email mb-md"},n.createElement("div",{"data-test-id":"current-email",className:"bold truncate mw-300 va-m dib gray-darkest","data-private":!0},e),l?n.createElement("a",{href:c,"data-qa":i,"data-test-id":s||i,className:o,onClick:p},a):n.createElement(r.a,{onClick:p,"data-qa":i,"data-test-id":s,className:o},a))};c.Nu.VERIFY,c.Nu.AUTOCONNECT,c.Nu.VERIFIED,c.Nu.SOAP,d('.social-btn {\n  width: 100%;\n  height: 40px;\n  text-shadow: none;\n  transition: opacity 0.2s ease;\n  opacity: 1;\n  -webkit-font-smoothing: antialiased;\n  font-family: "Franklin", "Helvetica Neue", Helvetica, Roboto, Arial, sans-serif;\n}\n.social-btn:hover {\n  background-color: #f0f0f0;\n  transition: all 0.2s ease;\n}\n.social-btn.app-ios {\n  border: 1px solid #000;\n}\n.social-btn .social-icon {\n  display: table;\n  margin: 0 auto;\n  background-color: transparent;\n}\n.social-btn .social-icon img {\n  transform: translate(-50%, 21%);\n  height: 17px;\n}\n.social-btn .social-txt {\n  line-height: 22px;\n  background-color: transparent;\n}');let H=({timeoutSeconds:e,appName:t})=>{(0,o.SplunkLogger)({appName:t}).logHandledError({location:"TimeoutCanary",message:`TimeoutCanary still on page for ${e}s`,url:"undefined"!=typeof window&&window.location.href||"",isLoggedIn:(0,o.isLoggedIn)()})},B=({className:e="timeout",timeoutSeconds:t=8,onTimeout:a=H,appName:i="Timeout"})=>((0,n.useEffect)(()=>{let e=window.setTimeout(()=>{try{a({timeoutSeconds:t,appName:i})}catch(e){console.debug(e)}},1e3*t);return()=>window.clearTimeout(e)},[]),n.createElement("div",{id:"timeout",className:e})),Q=({text:e="",className:t,size:a="40px",timeoutCanary:i=!0})=>n.createElement(Z,{className:t,"data-test-id":"spinner"},n.createElement(Y,{className:"spinner",style:{width:a,height:a}}),e&&n.createElement(j,null,e),i&&n.createElement(B,null)),z=(0,i.d)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),Z=(0,i.a)("div",{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}),Y=(0,i.a)("div",{border:"4px solid #f3f3f3",borderTop:"4px solid #555",borderRadius:"50%",animationName:z.toString(),animationDuration:"0.75s",animationTimingFunction:"linear",animationIterationCount:"infinite"}),j=(0,i.a)("div",{marginTop:"16px"});q.STATUSES.BAD_PASSWORD,n.Fragment,n.Fragment,n.Fragment,n.Fragment,(e,t)=>[n.createElement("div",{key:"container","data-test-id":"pml-sent-account-exists-container"},n.createElement("div",{className:"mt-sm",key:"email"},n.createElement(W,{dataQa:"pml-sent-account-exists-change-email",dataTestId:"pml-sent-account-exists-change-email",onChangeClick:t,email:e,text:"Not you?",asLink:!0})),n.createElement("p",{key:"description",className:"mt-sm"},"Follow the link to sign in securely, without a password."))];let{BAD_PASSWORD:K,FORGOT_PASSWORD_EMAIL_SENT:J,PML_SENT:X,PML_SENT_ACCOUNT_EXISTS:ee,SET_PASSWORD:et,SOCIAL_PROVIDER_ONLY:ea}=F;o.ResponseState.PASSWORD_STRENGTH_FAILURE_REQ_SIZE,o.ResponseState.PASSWORD_STRENGTH_MISSING_SPECIAL_CHARACTER,o.ResponseState.PASSWORD_STRENGTH_LEVEL1,o.ResponseState.PASSWORD_STRENGTH_LEVEL2,o.ResponseState.PASSWORD_STRENGTH_LEVEL3,o.ResponseState.PASSWORD_STRENGTH_LEVEL4;let en=[{variant:"default",label:n.createElement("b",null,"Set a password"),color:"#D5D5D5"},{variant:"weak",label:"Weak",color:"#EA0017"},{variant:"good",label:"Good",color:"#F29F18"},{variant:"strong",label:"Strong",color:"#61A125"},{variant:"vStrong",label:"Very Strong",color:"#61A125"}];en[0].variant,en[0].color,en[1].variant,en[1].color,en[2].variant,en[2].color,en[3].variant,en[3].color,en[4].variant,en[4].color;let ei="auth",er={SIGN_IN:{SUBMIT:`${ei}_submitted`,COMPLETE:`${ei}_authenticated`,REDIRECT:`${ei}_redirect`,REDIRECT_APP:`${ei}_redirect_app`}};er.SIGN_IN.SUBMIT,er.SIGN_IN.COMPLETE,er.SIGN_IN.REDIRECT,er.SIGN_IN.SUBMIT,er.SIGN_IN.REDIRECT_APP,er.SIGN_IN.SUBMIT,(0,o.getQueryParams)().performance_debug;let es=({captchaType:e,email:t,arcId:a,startMethod:n,subscriptionExperience:i,data:r,newsletterId:s,registrationType:c,startLocation:l,challengeToken:p,iframeOnboarding:d,bypassIneligibleOffer:m,nlSkipWelcomeEmail:u,recaptchaResponse:g,turnstileResponse:E})=>{let S=new URL(window?.wpMetaData?.canonical_url||`${window?.location?.origin}${window?.location?.pathname}`);(0,o.getQueryParams)().pwapi_token&&S.searchParams.append("pwapi_token",(0,o.getQueryParams)().pwapi_token);let _=new URL(o.ENDPOINTS.wapoSignin),R=document.referrer?new URL(document.referrer).hostname:"",f={},O=[{name:"nl_start_method",value:n||""},{name:"nl_start_location",value:l||""},{name:"nl_start_initiative",value:window?.location?.pathname},{name:"account_method",value:n||""},{name:"account_location",value:l||""},{name:"account_initiative",value:window?.location?.pathname},{name:"account_arcid",value:a||(0,o.getQueryParams)().arcId||""},{name:"account_experience",value:i||""},{name:"account_source_channel",value:R}].concat(u?[{name:"nl_skip_welcome_email",value:!0}]:[]);if("free-trial"===c&&r?.promoId){let e={tid:r?.regwallTid,ga_label:l,promo_id:r?.promoId||"",trial_type:r?.trialType||"",s_l:r?.subscriptionLocation,e:i,p:r?.subscriptionPricing,ob:d?1:0,bypass_io:m?1:0,arc_id:a||(0,o.getQueryParams)().arcId||"",utm_source:(0,o.getQueryParams)().utm_source,utm_medium:(0,o.getQueryParams)().utm_medium,utm_campaign:(0,o.getQueryParams)().utm_campaign,utm_content:(0,o.getQueryParams)().utm_content,next_url:S};Object.keys(e).forEach(t=>{_.searchParams.append(t,e[t])}),O.push({name:"next_url",value:encodeURIComponent(_.toString())})}else"free-trial"===c&&r?.enterpriseClientId&&(S.searchParams.append("tid",r?.regwallTid),S.searchParams.append("ga_label",l),S.searchParams.append("enterpriseClientID",r?.enterpriseClientId)),O.push({name:"next_url",value:S.toString()});let I={challengeToken:p,clientId:"site",email:t,entryPoint:l,metadata:O,newsletterIds:[s],trialPromotionId:r?.promoId,trialType:r?.trialType,...r?.enterpriseClientId&&{enterpriseClientID:r?.enterpriseClientId}};return"turnstile"===e?I.turnstileResponse=E||null:I.recaptchaResponse=g||null,"free-trial"===c&&(Object.keys(f={subscription_experience:i,subscription_location:r?.subscriptionLocation,subscription_pricing:r?.subscriptionPricing,subscription_arcid:a||(0,o.getQueryParams)().arcId||"",utm_source:(0,o.getQueryParams)().utm_source,utm_medium:(0,o.getQueryParams)().utm_medium,utm_campaign:(0,o.getQueryParams)().utm_campaign,utm_content:(0,o.getQueryParams)().utm_content}).forEach(e=>!f[e]&&delete f[e]),I.trialSubscriptionDimensions=f),JSON.stringify(I)},eo=()=>{let e=window?.wpMetaData?.canonical_url,t=document.createElement("a");return t.href=e,t.pathname||""},ec=["220","2002","2003"],el=async e=>{let t=e.enterpriseClientId?`${o.ENDPOINTS.base}/user/v2/registrations/enterprise`:`${o.ENDPOINTS.base}/user/register/regwall`;try{let a=await fetch(t,{method:"POST",body:e,headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}),n=await a.json(),i={state:n.state,status:n.status,registrationResultType:"Failure",email:JSON.parse(e).email};return ec.includes(n.state)?i={...i,registrationResultType:"New User"}:"250"===n.state?i={...i,registrationResultType:"Existing SSO User"}:"2001"===n.state?i={...i,registrationResultType:"Existing Subscriber"}:"210"===n.state&&(i={...i,registrationResultType:"Existing Non-Subscriber"}),i}catch(e){throw Error("There was a problem registering your email. Please try again.")}},ep=(0,n.memo)(({consumerId:e,arcId:t,newsletterId:a,startLocation:i,startMethod:d,subscriptionExperience:m,captchaType:u="recaptcha",ctaButtonText:g="Start reading",registrationType:E="auth-only",disableSubmitButtonOnLoad:S=!0,iframeOnboarding:_=!1,bypassIneligibleOffer:R=!1,nlSkipWelcomeEmail:f=!1,showTosOnLoad:O=!0,data:I,containerClassName:P,containerStyle:h,ctaStyleProps:y,ctaDensity:A="default",emailInputStyleProps:w,tosProps:T={},onRegistration:N,onInputFocus:v,ctaVariant:C="cta",ctaButtonTextRef:b,disableCtaButton:k=!1,showLoadingIconOnSubmit:D=!1,onTurnstileTestTriggered:L})=>{let[x,$]=(0,n.useState)(""),[G,U]=(0,n.useState)(O),[V,q]=(0,n.useState)(""),[F,W]=(0,n.useState)(!1),[H,B]=(0,n.useState)(!1),[z,Z]=(0,n.useState)(!1),[Y,j]=(0,n.useState)(!1),[K,J]=(0,n.useState)(!1),[X,ee]=(0,n.useState)(!1),[et,ea]=(0,n.useState)(null),en=new o.GoogleAnalytics,ei="regwall"===e?"regwall":"regform",er={account_experience:`${m}`,account_location:`${i}`,account_method:`${d}`,acqEntrancePage:eo(),arcId:`${t}`,category:"acquisition",contentTags:function(e=""){return e.split(",").map(e=>e.replace(/\/|^wp - /g,"").replace(/,/g,";").trim()).join(";").toLocaleLowerCase()}(window?.wpMetaData?.ct_tags),emailEnrollInitiative:eo(),emailEnrollLocation:`${i}`,emailEnrollMethod:`${d}`,label:`${i}`},ec=()=>{en.sendGAEvent({...er,event:`acquisition-${ei}-verification-error`,action:`acquisition-${ei}-verification-error`,label:u}),q("Something went wrong. Please try again."),j(!1)},ep="https://subscribe.washingtonpost.com"===o.ENDPOINTS.base,ed="recaptcha"===u?(0,c.Z1)({sitekey:p.env.CYPRESS_CI&&c.bw||c.iv,email:x.toLowerCase(),getRecaptchaStatus:o.getRecaptchaStatus,consumer:"registrationForm",handleCaptchaError:ec}):(0,c.D_)({sitekey:(p.env.CYPRESS_CI||!ep)&&c.F||c.Eb,email:x.toLowerCase(),getRecaptchaStatus:o.getRecaptchaStatus,handleCaptchaError:ec}),em=async t=>{try{let a=await el(t);if("SUCCESS"===a.status)"Existing Non-Subscriber"===a.registrationResultType?en.sendGAEvent({...er,event:`acquisition-${ei}-submit-preexisting`,action:`acquisition-${ei}-submit-preexisting`}):"New User"===a.registrationResultType&&(Z(!0),en.sendGAEvent({...er,event:`acquisition-${ei}-submit`,action:`acquisition-${ei}-submit`})),"New User"!==a.registrationResultType&&ee(!0);else throw(0,o.SplunkLogger)({appName:"auth-beta"}).logInfo({location:"AuthBeta:RegistrationForm:processRegistration",message:`Received status:${a.status} and state:${a.state} from registration api.Consumer is ${e}`}),Error("Something went wrong. Please try again.");ea(a)}catch(t){q(t.message),j(!1),(0,o.SplunkLogger)({appName:"auth-beta"}).logInfo({location:"AuthBeta:RegistrationForm:processRegistration",message:`Registration api failure.Consumer is ${e}`})}};(0,n.useEffect)(()=>{X&&et&&N(et)},[X,et]),(0,n.useEffect)(()=>{ed.state.isInteractiveMode&&(B(!0),L&&L())},[ed.state.isInteractiveMode]),(0,n.useEffect)(()=>{!F&&(ed.state?.getTurnstileResponse||ed.state?.getRecaptchaResponse)&&(W(!0),en.sendGAEvent({...er,event:`acquisition-${ei}-verification-start`,action:`acquisition-${ei}-verification-start`,label:u}))},[ed.state?.getTurnstileResponse,ed.state?.getRecaptchaResponse]),(0,n.useEffect)(()=>{if(ed.state.isFinished){F||en.sendGAEvent({...er,event:`acquisition-${ei}-verification-start`,action:`acquisition-${ei}-verification-start`,label:"bypass"});let e=ed.state?.recaptchaToken||ed.state?.challengeToken,n=null,r=null;"turnstile"===u?n=ed.state?.turnstileResponse:r=ed.state?.recaptchaResponse,en.sendGAEvent({...er,event:`acquisition-${ei}-verification-end`,action:`acquisition-${ei}-verification-end`,label:n||r?u:"bypass"}),em(es({captchaType:u,email:x,arcId:t,startMethod:d,subscriptionExperience:m,data:I,newsletterId:a,registrationType:E,startLocation:i,challengeToken:e,iframeOnboarding:_,bypassIneligibleOffer:R,nlSkipWelcomeEmail:f,recaptchaResponse:r,turnstileResponse:n}))}},[ed.state.isFinished]);let eu=(0,n.useMemo)(()=>{let e={...T};return delete e.tosConfigReady,e},[T]);return n.createElement("form",{onSubmit:e=>(e.preventDefault(),!Y&&(x&&!(x.length<8)&&x.match(/^[a-zA-Z0-9!#$%&'*+\/=\?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/g)?K?(q(""),j(!0),"turnstile"===u?ed.checkCaptchaStatus():ed.checkRecaptchaStatus(),!0):(q("Please accept the Terms of Service."),!1):(q("Please enter a valid email."),!1))),className:P,style:h,id:"registration-form","data-qa":`${e}-registration-form-container`,noValidate:!0},n.createElement(s.a,{label:"Enter email address",id:"registration-email-id",name:"registration-email","data-qa":`${e}-registration-form-email-input`,value:x,"data-private":!0,onChange:e=>{let t=e.target.value;V&&q(""),$(t)},type:"email",error:!!V,errorMessage:V,css:{...w},onFocus:()=>{G||U(!0),v&&v()}}),n.createElement("div",{className:G?"":"dn"},n.createElement(l.O,{onChange:e=>{J(e),e&&V&&q("")},email:x,isSubmitted:z,"data-qa":`${e}-registration-form-tos`,disabled:Y,tosConfigReady:e=>{T?.tosConfigReady==="function"&&T?.tosConfigReady(e),e?.isProcessed&&ee(!0)},...eu})),n.createElement(M,{dataTestId:"regform",isInteractiveMode:H}),n.createElement(r.a,{variant:C,density:A,"data-qa":`${e}-registration-form-cta-button`,disabled:Y||S&&(!K||!x)||k,type:"submit",className:O?"w-100":"w-100 mt-sm",css:{...y},icon:"left"},Y&&D&&n.createElement(Q,{size:"16px"}),n.createElement("span",{ref:b},g)))}),{STATUSES:ed}=q;i.f.fonts.headline,i.f.colors.primary,i.f.fontSizes[150],i.f.space[150],o.ResponseState.GOOGLE_SUCCESS,o.ResponseState.AMAZON_SUCCESS,o.ResponseState.FACEBOOK_SUCCESS,o.ResponseState.APPLE_SUCCESS,o.ResponseState.GOOGLE_SUCCESS,w.PROVIDERS.GOOGLE,o.ResponseState.AMAZON_SUCCESS,w.PROVIDERS.AMAZON,o.ResponseState.FACEBOOK_SUCCESS,w.PROVIDERS.FACEBOOK,o.ResponseState.APPLE_SUCCESS,w.PROVIDERS.APPLE,q.STATUSES.BAD_PASSWORD,q.STATUSES.FINISH_SETTING_UP_ACCT,q.FLOW.PML,F.SHOW_EMAIL,F.SHOW_EMAIL}}]);