(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8625],{63391:function(e,t,n){"use strict";let r,o,i;var l=Object.create,u=Object.defineProperty,a=Object.defineProperties,s=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyDescriptors,f=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,m=(e,t,n)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,w=(e,t)=>{for(var n in t||(t={}))p.call(t,n)&&m(e,n,t[n]);if(d)for(var n of d(t))v.call(t,n)&&m(e,n,t[n]);return e},g=(e,t)=>a(e,c(t)),y=(e,t)=>{var n={};for(var r in e)p.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&d)for(var r of d(e))0>t.indexOf(r)&&v.call(e,r)&&(n[r]=e[r]);return n},E=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of f(t))p.call(e,o)||o===n||u(e,o,{get:()=>t[o],enumerable:!(r=s(t,o))||r.enumerable});return e},b=(e,t,n)=>new Promise((r,o)=>{var i=e=>{try{u(n.next(e))}catch(e){o(e)}},l=e=>{try{u(n.throw(e))}catch(e){o(e)}},u=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,l);u((n=n.apply(e,t)).next())}),_={};((e,t)=>{for(var n in t)u(e,n,{get:t[n],enumerable:!0})})(_,{CartaNewslettersService:()=>T,NewsletterError:()=>C}),e.exports=E(u({},"__esModule",{value:!0}),_);var S=(i=null!=(r=n(12133))?l(h(r)):{},E(!o&&r&&r.__esModule?i:u(i,"default",{value:r,enumerable:!0}),r)),O={local:{apiHost:"http://127.0.0.1:3333/newsletters",recaptchaSiteKey:"6Lcu75IbAAAAACHuarBHOzSIkR-8yrPbK7NKGgYb"},sandbox:{apiHost:"https://carta-sandbox.washingtonpost.com/newsletters",recaptchaSiteKey:"6Lcu75IbAAAAACHuarBHOzSIkR-8yrPbK7NKGgYb"},prod:{apiHost:"https://newsletters.washingtonpost.com/newsletters",recaptchaSiteKey:"6Ldk9swZAAAAAM_dBbCU2eL4Bm0MtZXkgWiFpxtu"}},C=class extends Error{constructor(e=""){var t=(...e)=>{super(...e)};e instanceof Response?(t(e.statusText),this.response=e,this.statusCode=e.status):t(e),this.isNewsletterError=!0,this.name="NewsletterError"}};function A(e,t){return b(this,null,function*(){let n=yield fetch(e,t);if(!n.ok)throw new C(n);return yield n.json()})}function N(...e){let t=new Headers;return e.forEach(e=>{e&&new Headers(e).forEach((e,n)=>{t.set(n,e)})}),t}var j=class{constructor({url:e,headers:t}){this.BASE_URL=e,this.BASE_HEADERS=new Headers(t)}get(){return b(this,arguments,function*(e="/",t={},n={}){let r=n&&Object.values(n).some(Boolean)?`?${new URLSearchParams(n)}`:"";return A(this.BASE_URL+e+r,g(w({},t),{method:"GET",headers:N(this.BASE_HEADERS,t.headers)}))})}post(){return b(this,arguments,function*(e="/",t={},n={}){return A(this.BASE_URL+e,g(w({},t),{method:"POST",body:JSON.stringify(Object.fromEntries(Object.entries(n).filter(([e,t])=>void 0!==t))),headers:N(this.BASE_HEADERS,{"content-type":"application/json"},null==t?void 0:t.headers)}))})}};function x(e,t){let n="undefined"!=typeof window?document.cookie:t;if(!n)return null;let r=n.match(`(^|;) ?${e}=([^;]*)(;|$)`);return r?r[2]:null}function P(e){let t=function(e){if("string"==typeof e)return e;if("object"==typeof e){let t=new Headers(e.headers).get("cookie");if(t)return t}return"undefined"!=typeof window?document.cookie:""}(e),n=x("wapo_login_id",t),r=x("wapo_secure_login_id",t);return!!n&&!!r&&n}var L=class{constructor(e,t=6e5){if(this.lsKey=e,this.TTL=t,this.canUseLS=function(){try{localStorage.setItem("TEST","TEST");let e=localStorage.getItem("TEST");return localStorage.removeItem("TEST"),"TEST"===e}catch(e){return!1}}(),this.cache={},this.canUseLS)try{let e=localStorage.getItem(this.lsKey)||"";this.cache=JSON.parse(e)}catch(e){}}saveLS(){if(this.canUseLS)try{let e=JSON.stringify(this.cache);localStorage.setItem(this.lsKey,e)}catch(e){}}get(e){if(!(e in this.cache))return null;let{expires:t,value:n}=this.cache[e];return t<Date.now()?(this.delete(e),null):n}set(e,t){this.cache[e]={expires:Date.now()+this.TTL,value:t},this.saveLS()}update(e,t){var n;this.cache[e]={expires:(null==(n=this.cache[e])?void 0:n.expires)||0,value:t},this.saveLS()}delete(e){return e in this.cache&&(delete this.cache[e],this.saveLS(),!0)}clear(){this.cache={},this.saveLS()}clearAllBut(e){Object.keys(this.cache).forEach(t=>{t!==e&&delete this.cache[t]}),this.saveLS()}};globalThis.fetch||(globalThis.fetch=S.default,globalThis.Response=S.Response,globalThis.Headers=S.Headers,globalThis.Request=S.Request);var T=class{constructor(e){this.cache={enrollments:new L("carta-newsletters.api:enrollments",6e5),newsletters:new L("carta-newsletters.api:newsletters",36e5),nlQueries:new L("carta-newsletters.api:newsletterQueries",36e5),users:new L("carta-newsletters.api:user",6e5)};let{env:t,clientApp:n,serverSide:r,token:o,hostOverride:i=""}=e,{apiHost:l,recaptchaSiteKey:u}=function(e="sandbox"){if(!(e in O))throw new C(`getConfig: Unknown environment ${e}. Must be one of: ${Object.keys(O).join(", ")}`);return O[e]}(t);this.RECAPTCHA_SITE_KEY=u;let a=!0===r,s="string"==typeof o&&o.length>0,c="undefined"!=typeof window,f=l,d=new Headers({Accept:"application/json"});if(a||s){if(c)throw new C("window detected -- may not use `token` or `serverSide=true` in a browser environment");if(!a)throw new C("Must include valid server-side config for use outside of browser environment. See docs or contact Carta team for more information");if(!s)throw new C("Must include valid auth token for server-side service");f=i||f,d.set("Authorization",`Bearer ${o}`)}else n?d.set("Client-App",n):void 0!==location&&d.set("Client-App",`c-n:${location.href}`);this.api=new j({url:`${f}/api/v1`,headers:d}),this.cleanUpPrivateCaches()}getNewsletter(e,t){return b(this,null,function*(){if(!e)throw new C("Must pass newsletter id to `getNewsletter`");let n=this.cache.newsletters.get(e);if(n)return n;let r=yield this.api.get(`/newsletters/${e}/`,t).catch(e=>{if(e instanceof C&&404===e.statusCode)return null;throw e});return r&&this.cache.newsletters.set(e,r),r})}getNewsletters(e,t){return b(this,null,function*(){let n="";try{n=JSON.stringify(e)}catch(e){}let r=n&&this.cache.nlQueries.get(n);if(r)return r;let o=yield this.api.get("/newsletters/",t,w({operator:"equals"},e));return n&&this.cache.nlQueries.set(n,o),o.forEach(e=>{this.cache.newsletters.set(e.id,e)}),o})}getUser(e){return b(this,null,function*(){let t=this.getLoginId(e);if(t){let e=this.cache.users.get(t);if(e)return e}let n=yield this.api.get("/user/",g(w({},e),{credentials:"include"}));return t&&!n.isGuest&&this.cache.users.set(t,n),n})}getEnrollments(e,t){return b(this,null,function*(){if("undefined"!=typeof window&&e)throw new C("Cannot call getEnrollments with email address from a browser");let n=this.getLoginId(t);if(n){let e=this.cache.enrollments.get(n);if(e)return e}let r=yield this.api.get("/user/enrollments/",g(w({},t),{credentials:"include"}),e?{email:e}:void 0);return n&&this.cache.enrollments.set(n,r),r})}enroll(e,t){return b(this,null,function*(){let{email:n,newsletters:r,recaptchaToken:o,suppressConfirmation:i,doSynchronousVerification:l}=e,u=y(e,["email","newsletters","recaptchaToken","suppressConfirmation","doSynchronousVerification"]);if(!Array.isArray(r)||0===r.length)return console.warn("enroll: No newsletters included"),{success:!0};u.method&&u.location&&u.initiative||console.warn("all `enroll` requests should include `method`, `location`, and `initiative` values");let a=yield this.api.post("/user/enroll/",g(w({},t),{credentials:"include"}),{newsletters:r,profile:u,email:n,recaptchaToken:o,suppressConfirmation:i,doSynchronousVerification:l});return a.success&&(yield this.cacheEnrollmentsUpdate("enroll",e,t)),a})}unenroll(e,t){return b(this,null,function*(){let{email:n,newsletters:r}=e,o=y(e,["email","newsletters"]);if(!Array.isArray(r)||0===r.length)return console.warn("unenroll: No newsletter IDs included"),{success:!0};o.method&&o.location&&o.initiative||console.warn("all `unenroll` requests should include `method`, `location`, and `initiative` values");let i=yield this.api.post("/user/unenroll/",g(w({},t),{credentials:"include"}),{email:n,newsletters:r,profile:o});return i.success&&(yield this.cacheEnrollmentsUpdate("unenroll",e,t)),i})}cleanUpPrivateCaches(e=P()){let{enrollments:t,users:n}=this.cache;e?(t.clearAllBut(e),n.clearAllBut(e)):(t.clear(),n.clear())}getLoginId(e){let t=P(e);return this.cleanUpPrivateCaches(t),t}cacheEnrollmentsUpdate(e,t,n){return b(this,arguments,function*(e,{newsletters:t},n){let r=this.getLoginId(n);if(!r)return;let o=this.cache.enrollments.get(r);if(!o)return;let i=yield Promise.all(t.map(e=>b(this,null,function*(){var t;return"string"==typeof e?e:null==(t=(yield this.getNewsletters(e))[0])?void 0:t.id}))),l="enroll"===e?o.concat(i):o.filter(e=>!i.includes(e)),u=l.filter((e,t)=>!!e&&l.indexOf(e)===t);this.cache.enrollments.update(r,u)})}}},26372:function(e,t,n){"use strict";n.d(t,{a:function(){return o},c:function(){return l}});var r=n(75271),o={small:"small",medium:"medium",large:"large",xlarge:"xlarge",xxlarge:"xxlarge",unknown:"unknown"},i=()=>typeof window>"u"?"unknown":window.getComputedStyle(document.documentElement).getPropertyValue("--wpds--screenSize"),l=()=>{let[e,t]=(0,r.useState)(i());return(0,r.useEffect)(()=>{if(typeof window>"u")return;let e=()=>{t(i())};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),e}},91451:function(e,t,n){var r,o,i,l="__lodash_hash_undefined__",u=1/0,a=/^\[object .+?Constructor\]$/,s=/^(?:0|[1-9]\d*)$/,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,f="object"==typeof self&&self&&self.Object===Object&&self,d=c||f||Function("return this")();function h(e,t){return!!(e?e.length:0)&&function(e,t,n){if(t!=t)return function(e,t,n,r){for(var o=e.length,i=-1;++i<o;)if(t(e[i],i,e))return i;return -1}(e,v,0);for(var r=-1,o=e.length;++r<o;)if(e[r]===t)return r;return -1}(e,t,0)>-1}function p(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function v(e){return e!=e}function m(e,t){return e.has(t)}function w(e,t){return function(n){return e(t(n))}}var g=Array.prototype,y=Function.prototype,E=Object.prototype,b=d["__core-js_shared__"],_=(r=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",S=y.toString,O=E.hasOwnProperty,C=E.toString,A=RegExp("^"+S.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),N=d.Symbol,j=w(Object.getPrototypeOf,Object),x=E.propertyIsEnumerable,P=g.splice,L=N?N.isConcatSpreadable:void 0,T=Object.getOwnPropertySymbols,R=Math.max,U=B(d,"Map"),k=B(Object,"create");function I(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function D(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function H(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function M(e){var t=-1,n=e?e.length:0;for(this.__data__=new H;++t<n;)this.add(e[t])}function G(e,t){for(var n,r=e.length;r--;)if((n=e[r][0])===t||n!=n&&t!=t)return r;return -1}function $(e,t){var n,r=e.__data__;return("string"==(n=typeof t)||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?r["string"==typeof t?"string":"hash"]:r.map}function B(e,t){var n=null==e?void 0:e[t];return!(!J(n)||_&&_ in n)&&(W(n)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(n)?A:a).test(function(e){if(null!=e){try{return S.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(n))?n:void 0}I.prototype.clear=function(){this.__data__=k?k(null):{}},I.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},I.prototype.get=function(e){var t=this.__data__;if(k){var n=t[e];return n===l?void 0:n}return O.call(t,e)?t[e]:void 0},I.prototype.has=function(e){var t=this.__data__;return k?void 0!==t[e]:O.call(t,e)},I.prototype.set=function(e,t){return this.__data__[e]=k&&void 0===t?l:t,this},D.prototype.clear=function(){this.__data__=[]},D.prototype.delete=function(e){var t=this.__data__,n=G(t,e);return!(n<0)&&(n==t.length-1?t.pop():P.call(t,n,1),!0)},D.prototype.get=function(e){var t=this.__data__,n=G(t,e);return n<0?void 0:t[n][1]},D.prototype.has=function(e){return G(this.__data__,e)>-1},D.prototype.set=function(e,t){var n=this.__data__,r=G(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},H.prototype.clear=function(){this.__data__={hash:new I,map:new(U||D),string:new I}},H.prototype.delete=function(e){return $(this,e).delete(e)},H.prototype.get=function(e){return $(this,e).get(e)},H.prototype.has=function(e){return $(this,e).has(e)},H.prototype.set=function(e,t){return $(this,e).set(e,t),this},M.prototype.add=M.prototype.push=function(e){return this.__data__.set(e,l),this},M.prototype.has=function(e){return this.__data__.has(e)};var K=T?w(T,Object):ee,q=T?function(e){for(var t=[];e;)p(t,K(e)),e=j(e);return t}:ee;function F(e){return Y(e)||X(e)||!!(L&&e&&e[L])}function V(e){if("string"==typeof e||"symbol"==typeof(t=e)||Q(t)&&"[object Symbol]"==C.call(t))return e;var t,n=e+"";return"0"==n&&1/e==-u?"-0":n}function X(e){return Q(e)&&z(e)&&O.call(e,"callee")&&(!x.call(e,"callee")||"[object Arguments]"==C.call(e))}var Y=Array.isArray;function z(e){var t;return null!=e&&"number"==typeof(t=e.length)&&t>-1&&t%1==0&&t<=9007199254740991&&!W(e)}function W(e){var t=J(e)?C.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function J(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Q(e){return!!e&&"object"==typeof e}var Z=(o=function(e,t){var n,r,o,i;return null==e?{}:(t=function(e,t){for(var n=-1,r=e?e.length:0,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}(function e(t,n,r,o,i){var l=-1,u=t.length;for(r||(r=F),i||(i=[]);++l<u;){var a=t[l];n>0&&r(a)?n>1?e(a,n-1,r,o,i):p(i,a):o||(i[i.length]=a)}return i}(t,1),V),r=e,o=function(e,t,n,r){var o=-1,i=h,l=!0,u=e.length,a=[],s=t.length;if(!u)return a;t.length>=200&&(i=m,l=!1,t=new M(t));e:for(;++o<u;){var c=e[o],f=c;if(c=0!==c?c:0,l&&f==f){for(var d=s;d--;)if(t[d]===f)continue e;a.push(c)}else i(t,f,void 0)||a.push(c)}return a}((n=z(i=e)?function(e,t){var n,r=Y(e)||X(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],o=r.length,i=!!o;for(var l in e)(t||O.call(e,l))&&!(i&&("length"==l||(n=null==(n=o)?9007199254740991:n)&&("number"==typeof l||s.test(l))&&l>-1&&l%1==0&&l<n))&&r.push(l);return r}(i,!0):function(e){if(!J(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t,n=(t=e&&e.constructor,e===("function"==typeof t&&t.prototype||E)),r=[];for(var o in e)"constructor"==o&&(n||!O.call(e,o))||r.push(o);return r}(i),Y(e)?n:p(n,q(e))),t),function(e,t,n){for(var r=-1,o=t.length,i={};++r<o;){var l=t[r],u=e[l];n(u,l)&&(i[l]=u)}return i}(r=Object(r),o,function(e,t){return t in r}))},i=R(void 0===i?o.length-1:i,0),function(){for(var e=arguments,t=-1,n=R(e.length-i,0),r=Array(n);++t<n;)r[t]=e[i+t];t=-1;for(var l=Array(i+1);++t<i;)l[t]=e[t];return l[i]=r,function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(o,this,l)});function ee(){return[]}e.exports=Z},42615:function(e,t,n){var r,o,i=1/0,l="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,u="object"==typeof self&&self&&self.Object===Object&&self,a=l||u||Function("return this")(),s=Object.prototype,c=s.hasOwnProperty,f=s.toString,d=a.Symbol,h=s.propertyIsEnumerable,p=d?d.isConcatSpreadable:void 0,v=Math.max;function m(e){var t,n,r,o,i,l;return g(e)||y(e)&&null!=(t=e)&&"number"==typeof(n=t.length)&&n>-1&&n%1==0&&n<=9007199254740991&&!("[object Function]"==(i=typeof(o=r=t),l=o&&("object"==i||"function"==i)?f.call(r):"")||"[object GeneratorFunction]"==l)&&c.call(e,"callee")&&(!h.call(e,"callee")||"[object Arguments]"==f.call(e))||!!(p&&e&&e[p])}function w(e){if("string"==typeof e||"symbol"==typeof(t=e)||y(t)&&"[object Symbol]"==f.call(t))return e;var t,n=e+"";return"0"==n&&1/e==-i?"-0":n}var g=Array.isArray;function y(e){return!!e&&"object"==typeof e}var E=(r=function(e,t){var n,r;return null==e?{}:(n=e,r=function(e,t){for(var n=-1,r=e?e.length:0,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}(function e(t,n,r,o,i){var l=-1,u=t.length;for(r||(r=m),i||(i=[]);++l<u;){var a=t[l];n>0&&r(a)?n>1?e(a,n-1,r,o,i):function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(i,a):o||(i[i.length]=a)}return i}(t,1),w),function(e,t,n){for(var r=-1,o=t.length,i={};++r<o;){var l=t[r],u=e[l];n(u,l)&&(i[l]=u)}return i}(n=Object(n),r,function(e,t){return t in n}))},o=v(void 0===o?r.length-1:o,0),function(){for(var e=arguments,t=-1,n=v(e.length-o,0),i=Array(n);++t<n;)i[t]=e[o+t];t=-1;for(var l=Array(o+1);++t<o;)l[t]=e[t];return l[o]=i,function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(r,this,l)});e.exports=E},91678:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42226),o=n(5093),i=n(82271),l=n(26393),u=Object.create,a=Object.defineProperty,s=Object.defineProperties,c=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,p=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,w=function(e,t,n){return t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},g=function(e,t){for(var n in t||(t={}))v.call(t,n)&&w(e,n,t[n]);var r=!0,o=!1,i=void 0;if(h)try{for(var l,u=h(t)[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var n=l.value;m.call(t,n)&&w(e,n,t[n])}}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return e},y=function(e,t){return s(e,f(t))},E=function(e,t){var n={};for(var r in e)v.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);var o=!0,i=!1,l=void 0;if(null!=e&&h)try{for(var u,a=h(e)[Symbol.iterator]();!(o=(u=a.next()).done);o=!0){var r=u.value;0>t.indexOf(r)&&m.call(e,r)&&(n[r]=e[r])}}catch(e){i=!0,l=e}finally{try{o||null==a.return||a.return()}finally{if(i)throw l}}return n},b=function(e,t,n,r){var o=!0,i=!1,l=void 0;if(t&&"object"==typeof t||"function"==typeof t)try{for(var u,s=d(t)[Symbol.iterator]();!(o=(u=s.next()).done);o=!0)!function(){var o=u.value;v.call(e,o)||o===n||a(e,o,{get:function(){return t[o]},enumerable:!(r=c(t,o))||r.enumerable})}()}catch(e){i=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw l}}return e},_=function(e,t,n){return b(e,t,"default"),n&&b(n,t,"default")},S=function(e,t,n){return n=null!=e?u(p(e)):{},b(!t&&e&&e.__esModule?n:a(n,"default",{value:e,enumerable:!0}),e)},O=function(e,t,n){return new Promise(function(r,o){var i=function(e){try{u(n.next(e))}catch(e){o(e)}},l=function(e){try{u(n.throw(e))}catch(e){o(e)}},u=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(i,l)};u((n=n.apply(e,t)).next())})},C={};!function(e,t){for(var n in t)a(e,n,{get:t[n],enumerable:!0})}(C,{GlobalContextProvider:function(){return eS},NewsletterSignUp:function(){return eF},NewsletterSignUpProvider:function(){return eK},NewsletterSignUpSiteComponent:function(){return N.NewsletterSignUp},SingleNewsletterProvider:function(){return eM},useApiService:function(){return G},useEnrollmentActions:function(){return ei},useEnrollmentStatus:function(){return ef},useEnrollments:function(){return ec},useEnrollmentsContext:function(){return es},useIsEnrolled:function(){return eT},useNewsletter:function(){return eL},useNewsletterActions:function(){return eD},useRequestRecaptchaToken:function(){return eE},useSetUserEmail:function(){return en},useUser:function(){return et}}),e.exports=b(a({},"__esModule",{value:!0}),C);var A={};_(A,n(63391)),_(C,A,e.exports);var N=n(36904),j=S(n(75271)),x=S(n(91451)),P=S(n(42615)),L=n(36904),T=S(n(75271)),R=S(n(75271)),U=S(n(42615)),k=S(n(75271)),I=S(n(75271)),D=n(63391),H=(0,I.createContext)(null);function M(e){var t=e.apiConfig,n=t.env,r=t.clientApp,o=e.children,i=(0,I.useMemo)(function(){if(!n||!r)throw Error("ApiServiceProvider: `env` and `clientApp` are required");return new D.CartaNewslettersService({env:n,clientApp:r})},[n,r]);return I.default.createElement(H.Provider,{value:i},o)}function G(){var e=(0,I.useContext)(H);if(!e)throw Error("Tried to access useApiService outside ApiServiceProvider");return e}H.displayName="ApiServiceContext";var $=S(n(75271)),B=S(n(42615));function K(e,t){var n=window.document.cookie;if(!n)return null;var r=n.match("(^|;) ?".concat(e,"=([^;]*)(;|$)"));return r?r[2]:null}function q(e){var t=e.method,n=e.location,r=e.initiative,o=e.newsletter,i="(not set)",l=window.navigator.userAgent;return{category:"email",label:o.name,emailEnrollMethod:t||i,emailEnrollLocation:n||"Unknown",emailEnrollInitiative:r||i,loginTypeHit:K("wapo_provider")||i,userAgentHit:l||i,userAgentSession:l||i}}function F(e){var t=window.dataLayer||[];window.dataLayer=t,t.push(e)}var V=n(75271);function X(e){var t=(0,V.useMemo)(function(){var e=function(e){var n,r=null!=(n=t[e])?n:new Set;return t[e]=r,r},t={};return{addListener:function(t,n){e(t).add(n)},removeListener:function(t,n){e(t).delete(n)},trigger:function(t,n){e(t).forEach(function(e){return"function"==typeof e&&e(n)})}}},[]);return(0,V.useEffect)(function(){if(e){var n=Object.entries(e).filter(function(e){var t=o._(e,2);return void 0!==(t[0],t[1])});return n.forEach(function(e){var n=o._(e,2),r=n[0],i=n[1];i&&t.addListener(r,i)}),function(){return n.forEach(function(e){var n=o._(e,2),r=n[0],i=n[1];i&&t.removeListener(r,i)})}}},[e]),t}var Y=S(n(75271)),z=S(n(42615)),W=(0,Y.createContext)(null);W.displayName="UserContext";var J=["onUserChange","onUserError"],Q=i._(J);function Z(e){var t=this,n=e.children,r=E(e,["children"]),i=o._((0,Y.useState)(r.user||{isGuest:!0,isAdFree:!1,email:"",profile:{}}),2),u=i[0],a=i[1],s=o._((0,Y.useState)(!0),2),c=s[0],f=s[1],d=o._((0,Y.useState)(!1),2),h=d[0],p=d[1],v=X((0,z.default)(r,J)).trigger,m=G();(0,Y.useEffect)(function(){f(!0),O(t,null,function(){var e,t,n;return l._(this,function(o){switch(o.label){case 0:if(e="undefined"!=typeof document&&/\b(wp|wapo)_/g.test(document.cookie),!r.user)return[3,1];return a(function(e){return g(g({},e),r.user)}),p(!1),[3,5];case 1:if(!e)return[3,2];return t=!(K("wapo_login_id")&&K("wapo_secure_login_id")),a(function(e){return y(g({},e),{isGuest:t})}),[3,5];case 2:return o.trys.push([2,4,,5]),[4,m.getUser()];case 3:return n=o.sent(),a(function(e){return g(g({},e),n)}),[3,5];case 4:return p(o.sent()),[3,5];case 5:return f(!1),[2]}})})},[r.user]);var w=(0,Y.useCallback)(function(e){a(function(t){return y(g({},t),{email:e})})},[]),b=(0,Y.useMemo)(function(){return[u,c,w]},[u,c]);return(0,Y.useEffect)(function(){c||v("onUserChange",u)},[c,u,v]),(0,Y.useEffect)(function(){h&&v("onUserError",h)},[h,v]),Y.default.createElement(W.Provider,{value:b},n)}function ee(){var e=(0,Y.useContext)(W);if(!e)throw Error("Tried to access UserContext outside GlobalContext");return e}function et(){var e=o._(ee(),1)[0],t=e.isGuest,n=e.email;return(0,Y.useDebugValue)(t?"Guest".concat(n?" (".concat(n,")"):""):"Logged in"),e}function en(){return o._(ee(),3)[2]}var er=n(75271),eo=(0,er.createContext)(null);function ei(){var e=(0,er.useContext)(eo);if(!e)throw Error("Tried to access Enrollment Actions outside EnrollmentsProvider");return e}eo.displayName="EnrollmentActionsContext";var el=n(75271),eu=S(n(42615)),ea=(0,el.createContext)(null);function es(){var e=(0,el.useContext)(ea);if(!e)throw Error("Tried to access Enrollments Data outside EnrollmentsProvider");return(0,el.useEffect)(function(){return e.triggerGetEnrollments()},[]),(0,el.useMemo)(function(){return(0,eu.default)(e,["enrollments","isLoading"])},[e])}function ec(){return es().enrollments}function ef(e){var t=ec()[e]||{enrolled:!1};return(0,el.useDebugValue)(t.enrolled?"Enrolled":"Not Enrolled"),t}ea.displayName="EnrollmentsDataContext";var ed=n(75271),eh=function(e,t){if("RESET"===t.type)return ev(t.ids||[]);if(!ep.includes(t.type)||!t.id)throw Error("Invalid enrollmentsReducer action");var n,r=g({},e),o=(null==(n=e[t.id])?void 0:n.enrolled)||!1;return r[t.id]=({PENDING:{isPending:!0,enrolled:o},ERROR:{enrolled:o},ENROLLED:{enrolled:!0},UNENROLLED:{enrolled:!1}})[t.type],r},ep=["PENDING","ERROR","ENROLLED","UNENROLLED"];function ev(e){return Object.fromEntries(e.map(function(e){return[e,{enrolled:!0}]}))}var em=["onEnrollSubmit","onEnrollSuccess","onEnrollError","onUnenrollSubmit","onUnenrollSuccess","onUnenrollError","onEnrollmentsChange","onEnrollmentsLoaded"],ew=["initialEnrollments"].concat(i._(em));function eg(e){var t,n,r,i,u,a,s,c,f,d,h,p,v=e.initialEnrollments,m=e.children,w=E(e,["initialEnrollments","children"]),b=G(),_=en(),S=o._((0,$.useState)(!1),2),C=S[0],A=S[1],N=o._((t=v||[],n=G(),i=(r=o._(ee(),2))[0],u=r[1],s=(a=o._((0,ed.useReducer)(eh,t,ev),2))[0],c=a[1],d=(f=o._((0,ed.useState)(!0),2))[0],h=f[1],p=C&&!!n&&!u,(0,ed.useEffect)(function(){if(p){if(i.isGuest){h(!1);return}var e=!1;return n.getEnrollments().then(function(t){return!e&&c({type:"RESET",ids:t})}).catch(function(e){console.error(e)}).finally(function(){return h(!1)}),function(){e=!0}}},[p,i.isGuest,n,c]),[s,d,c]),3),j=N[0],x=N[1],P=N[2],L=X((0,B.default)(w,em)).trigger,T=(0,$.useMemo)(function(){return{enroll:function(e,t){return O(this,null,function(){var n,r,o;return l._(this,function(i){switch(i.label){case 0:var l;n=e.id,L("onEnrollSubmit",r=y(g({},t),{newsletters:[n]})),l=g({newsletter:e},t),F(y(g({},q(l)),{event:"email-enroll",action:"email-enroll"})),P({type:"PENDING",id:n}),t.email&&_(t.email),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,b.enroll(r)];case 2:return[2,(i.sent(),P({type:"ENROLLED",id:n}),L("onEnrollSuccess",r),!0)];case 3:return o=i.sent(),[2,(P({type:"ERROR",id:n}),L("onEnrollError",o),!1)];case 4:return[2]}})})},unenroll:function(e,t){return O(this,null,function(){var n,r,o;return l._(this,function(i){switch(i.label){case 0:var l;n=e.id,L("onUnenrollSubmit",r=y(g({},t),{newsletters:[n]})),l=g({newsletter:e},t),F(y(g({},q(l)),{event:"email-unenroll",action:"email-unenroll"})),P({type:"PENDING",id:n}),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,b.unenroll(r)];case 2:return[2,(i.sent(),P({type:"UNENROLLED",id:n}),L("onUnenrollSuccess",r),!0)];case 3:return o=i.sent(),[2,(P({type:"ERROR",id:n}),L("onUnenrollError",o),!1)];case 4:return[2]}})})}}},[b,P,L]),R=Object.keys(j).filter(function(e){return j[e].enrolled}).join("|");(0,$.useEffect)(function(){L("onEnrollmentsChange",j)},[R]),(0,$.useEffect)(function(){x||L("onEnrollmentsLoaded",j)},[x]);var U=(0,$.useMemo)(function(){return{enrollments:j,isLoading:x,triggerGetEnrollments:function(){return A(!0)}}},[j,x,A]);return $.default.createElement(eo.Provider,{value:T},$.default.createElement(ea.Provider,{value:U},m))}var ey=n(75271);function eE(){var e,t,n,r=this,o=(e=G(),t=(0,ey.useRef)(),n=(0,ey.useCallback)(function(){return O(this,null,function(){return l._(this,function(n){return[2,(t.current=t.current||function(e){return O(this,null,function(){return l._(this,function(t){switch(t.label){case 0:if(window.grecaptcha)return[3,2];return[4,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15e3;return O(this,null,function(){return l._(this,function(r){return[2,new Promise(function(r){var o=document.querySelector("script#".concat(e,",script[src='").concat(t,"']"));o||((o=document.createElement("script")).id=eb,o.src=t,o.defer=!0,document.getElementsByTagName("head")[0].appendChild(o)),o.addEventListener("load",function(){return r()}),setTimeout(function(){return r()},n)})]})})}(eb,"https://www.google.com/recaptcha/api.js?render=".concat(e))];case 1:t.sent(),t.label=2;case 2:return[2,new Promise(function(e){return window.grecaptcha.ready(function(){return e(window.grecaptcha)})})]}})})}(e.RECAPTCHA_SITE_KEY),t.current)]})})},[e.RECAPTCHA_SITE_KEY]),(0,ey.useEffect)(function(){n()},[n]),(0,ey.useCallback)(function(){return O(this,null,function(){var t;return l._(this,function(r){switch(r.label){case 0:return[4,n()];case 1:return t=r.sent(),[2,new Promise(function(n){return t.execute(e.RECAPTCHA_SITE_KEY,{action:""}).then(function(e){return n(e)})})]}})})},[n,e.RECAPTCHA_SITE_KEY])),i=(0,ey.useRef)(),u=(0,ey.useCallback)(function(){return O(this,null,function(){var e;return l._(this,function(t){return e=o(),[2,(i.current=e,setTimeout(function(){i.current===e&&(i.current=void 0)},9e4),e)]})})},[o]);return(0,ey.useCallback)(function(){return O(r,null,function(){var e;return l._(this,function(t){return[2,null!=(e=i.current)?e:u()]})})},[])}var eb="carta-newsletters-recaptcha",e_=i._(["apiConfig"]).concat(i._(ew),i._(Q));function eS(e){var t=e.children,n=E(e,["children"]);return k.default.createElement(M,g({},n),k.default.createElement(Z,g({},n),k.default.createElement(eg,g({},n),t)))}var eO=S(n(75271)),eC=S(n(42615)),eA=["id","bundleShortName","post_newsletter","customUrl","list","bundleID","rgattrId","followAuthorId"],eN=["onNewsletterLoad","onNewsletterError"],ej=["newsletter"].concat(i._(eA),i._(eN)),ex=(0,eO.createContext)(null);function eP(e){var t=o._((0,eO.useState)(e.newsletter),2),n=t[0],i=t[1],l=o._((0,eO.useState)(!1),2),u=l[0],a=l[1],s=o._((0,eO.useState)(!1),2),c=s[0],f=s[1],d=G(),h=X((0,eC.default)(e,eN)).trigger,p=!1;if(e.newsletter)p="newsletter:".concat(e.newsletter.id);else{var v=eA.find(function(t){return!!e[t]}),m=v&&e[v];m&&(p="".concat(v,":").concat(m))}(0,eO.useEffect)(function(){if(!1!==p){var t=o._(p.split(":"),2),n=t[0],l=t[1];if(e.newsletter){var u=e.newsletter;h("onNewsletterLoad",u),f(!1),i(u),a(!1);return}var s=!1;return a(!0),("id"===n?d.getNewsletter(l):d.getNewsletters(r._({},n,l)).then(function(e){return e[0]})).then(function(e){if(!s){if(!e)throw Error("No Newsletter Found");h("onNewsletterLoad",e),f(!1),i(e)}}).catch(function(e){s||(h("onNewsletterError",e),f(e),i(void 0))}).finally(function(){return!s&&a(!1)}),function(){s=!0}}},[!!e.newsletter,p,h]);var w=(0,eO.useMemo)(function(){return[n,u,c]},[n,u,c]);return eO.default.createElement(ex.Provider,{value:w},e.children)}function eL(){var e=o._(function(){var e=(0,eO.useContext)(ex);if(!e)throw Error("Must be used inside NewsletterDataContext");return e}(),1)[0];return(0,eO.useDebugValue)((null==e?void 0:e.name)||"[none]"),e}function eT(){var e=(eL()||{}).id,t=ef(void 0===e?"":e).enrolled;return(0,eO.useDebugValue)(t?"Enrolled":"Not Enrolled"),t}ex.displayName="NewsletterDataContext";var eR=(0,R.createContext)(null);eR.displayName="NewsletterActionsContext";var eU=["method","location","initiative"],ek=i._(eU);function eI(e){var t=this,n=ei(),r=n.enroll,o=n.unenroll,i=eL(),u=(0,R.useMemo)(function(){return(0,U.default)(e,eU)},eU.map(function(t){return e[t]})),a=eE(),s=(0,R.useMemo)(function(){if(!i){var e=function(){return Promise.resolve(!1)};return{enrollWithEmail:e,enroll:e,unenroll:e}}return{enrollWithEmail:function(e){return O(t,null,function(){var t,n,o;return l._(this,function(l){switch(l.label){case 0:return t=[i],n=[g({},u)],o={email:e},[4,a()];case 1:return[2,r.apply(void 0,t.concat([y.apply(void 0,n.concat([(o.recaptchaToken=l.sent(),o)]))]))]}})})},enroll:function(){return r(i,u)},unenroll:function(){return o(i,u)}}},[i,u,a,r,o]);return R.default.createElement(eR.Provider,{value:s},e.children)}function eD(){var e=(0,R.useContext)(eR);if(!e)throw Error("Must be used inside NewsletterActionsContext");return e}var eH=i._(ek).concat(i._(ej));function eM(e){var t=e.children,n=E(e,["children"]);return T.default.createElement(eP,g({},n),T.default.createElement(eI,g({},n),t))}var eG=S(n(75271)),e$=S(n(42615)),eB=i._(e_).concat(i._(eH));function eK(e){var t,n,r,o=e.children,i=E(e,["children"]),l=(t=null!==(0,I.useContext)(H),n=null!==(0,Y.useContext)(W),r=null!==(0,$.useContext)(ea)&&(0,$.useContext)(eo),t&&n&&r),u="apiConfig"in i&&"env"in i.apiConfig&&!!i.apiConfig.env,a=(0,e$.default)(i,eH),s=eG.default.createElement(eM,g({},a),o);if(!l){if(!u)throw Error("NewsletterSignUpProvider: `apiConfig` is required when used outside GlobalContextProvider");var c=(0,e$.default)(i,e_);return eG.default.createElement(eS,g({},c),s)}return s}function eq(e){var t=o._((0,L.useNewsletterSignUpFlow)(),2),n=t[0],r=t[1],i=eL(),l=eD(),u=l.enroll,a=l.enrollWithEmail,s=et(),c=s.email,f=void 0===c?"":c,d=s.isGuest,h=en(),p=eE(),v=(0,j.useCallback)(function(e){var t=e.emailAddress,o=e.isValid;d||(r("NEXT"),u(),r("NEXT")),"sign-up"===n&&r("NEXT"),"success"===n&&r("NEXT"),o&&"form"===n?(h(t),p(),r("NEXT")):r("ERROR"),"form-failure"===n&&r("NEXT")},[d,r,u,n,h,p]);(0,j.useEffect)(function(){"form-submitting"===n&&(a(f),r("NEXT"))},[n,a,r,f]);var m=i||{},w=m.image,E=m.name,b=void 0===E?"":E,_=m.frequency,S=m.sitewideDescription,O=m.description;return j.default.createElement(L.NewsletterSignUp,y(g(g({},{imageUrl:void 0===w?"":w,imageHeight:99,imageWidth:176,headline:b,promoLabel:void 0===_?"":_,body:(void 0===S?"":S)||(void 0===O?"":O),discoverMoreLink:"https://washingtonpost.com/newsletters/"}),e),{newsletter:b,state:n,onEmailAddressChange:v}))}function eF(e){if(e.newsletter&&"string"==typeof e.newsletter)throw Error("`newsletter` must be a Newsletter object, not a string");var t=(0,P.default)(e,eB),n=(0,x.default)(e,eB);return j.default.createElement(eK,g({},t),j.default.createElement(eq,g({},n)))}},12133:function(e,t,n){"use strict";var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw Error("unable to locate global object")}();e.exports=t=r.fetch,r.fetch&&(t.default=r.fetch.bind(r)),t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response}}]);