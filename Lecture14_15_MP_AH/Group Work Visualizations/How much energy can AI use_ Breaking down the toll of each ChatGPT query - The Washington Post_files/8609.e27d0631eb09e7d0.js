"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8609],{48609:function(e,n,t){t.r(n),t.d(n,{BOOKMARK_ACTION_PREFIX:function(){return O.I_},BookmarkButton:function(){return em},CTA_RECIPE_IMAGE_URL:function(){return O.P7},SubscribeCTAContent:function(){return eC},SubscribeCtaEvents:function(){return O.CE},SubscribeCtaPages:function(){return O.rw},getContentSubheader:function(){return O.fC},getTrackingLabel:function(){return eI},trackSubscribeCTAEvent:function(){return O.Do}});var o=t(94213),r=t(5093),i=t(52676),s=t(72567),a=t(9024),c=t(51484),l=t(38994),d=t(19478),u=t(74471),f=t(44962),g=t(61185),p=t(75271),h=t(66142),S=t(46178),m=t(1539),v=t(60830),b=t(42226),y=t(32586),x=t(11660),w=t(9153),I=t(92974),C="wapo_saved_stories",k=null,E=null,j=function(e){if(null===k){var n=(0,c.getLoginDetails)();k=(0,I.X)("".concat(e,"/").concat(n.wapoLoginID,"?preference=saved-stories"))}return null!=k?k:null},D=function(e,n){return null===E&&(E=(0,I.X)("".concat(e,"?uri=").concat(n),{credentials:"include"})),null!=E?E:null},_=function(e,n){var t=(0,w.M)(),r=(0,c.getLoginDetails)();try{var i=!1,s={},a=t?sessionStorage.getItem(C):null;if(a){var l=JSON.parse(localStorage.getItem("wapo_identity")||"{}");if((s=JSON.parse(a))[n]&&l.wapo_login_id===s[n].loginId)return s[n];if(s[n]&&(sessionStorage.removeItem(C),i=!0),!(null==s?void 0:s[n])){var d,u=Object.values(s);l.wapo_login_id!==(null==u?void 0:null===(d=u[0])||void 0===d?void 0:d.loginId)&&(sessionStorage.removeItem(C),i=!0)}}var f=D(e,n).then(function(e){return e});if(t&&"SUCCESS"===f.status&&"192"===f.state&&f.uri){if(i||!s){var g=(0,y._)((0,o._)({},f),{loginId:r.wapoLoginID});sessionStorage.setItem(C,JSON.stringify((0,b._)({},n,g)))}else sessionStorage.setItem(C,JSON.stringify((0,o._)((0,b._)({},n,f),s)))}return f}catch(e){return sessionStorage.removeItem(C),D()}},T=function(e,n,t){var o=[{location:n,userUpdated:new Date().toISOString(),archived:!1,status:t?"DELETED":"SAVED"}];return(0,I.X)(e,{method:"POST",credentials:"include",body:JSON.stringify({uris:o})})},A=function(e,n){if((0,w.M)())try{var t=sessionStorage.getItem(C)||"",o=JSON.parse(t)||{};(null==o?void 0:o[e])&&("DELETED"===n?sessionStorage.removeItem(C):(o[e]=n,sessionStorage.setItem(C,JSON.stringify(o))))}catch(e){}},R=function(e){var n=e.preferencesUrl,t=e.articleUrl,o=e.isRecipePage;return void 0!==o&&o||(0,x.Nf)("add-to-list","onpage","article-add-to-list",{}),T("".concat(n,"/save"),t,!1).then(function(e){return!!e.uris&&(A(t,e.uris[0].status),e.uris[0].status)}).catch(function(e){return console.error("there is an error in button api response",e),e})},$=function(e){var n=e.preferencesUrl,t=e.articleUrl;return T("".concat(n,"/delete"),t,!0).then(function(e){return!!e.uris&&(A(t,e.uris[0].status),e.uris[0].status)}).catch(function(e){return console.error("there is an error in button api response",e),e})},O=t(32591),N=t(84750),B=t(99938),P=t(81253),L=t(86671),U=t(91554),z=(0,u.a)("div",{diplay:"flex",flexDirection:"column",justifyContent:"center",maxWidth:"311px",margin:"0 auto",paddingTop:u.f.space["100"]}),G=(0,u.a)("h2",{color:u.f.colors.primary,fontFamily:u.f.fonts.headline,fontSize:u.f.fontSizes["150"],textAlign:"center"}),F=(0,u.a)("p",{color:u.f.colors.primary,fontSize:u.f.fontSizes["100"],textAlign:"center",margin:"0"}),M=(0,u.a)("button",{textDecoration:"underline",color:u.f.colors["onBackground-subtle"],fontFamily:u.f.fonts.meta,fontSize:u.f.fontSizes["087"],textAlign:"center",marginTop:u.f.space["100"],marginBottom:0,padding:"0",border:"none",backgroundColor:"transparent",display:"block",marginInline:"auto",cursor:"pointer"}),J=(0,u.a)(F,{paddingInline:u.f.space["075"],paddingBlock:u.f.space["100"],flexShrink:"0"}),V=(0,u.a)("div",{display:"flex",justifyContent:"center",alignItems:"center"}),W=(0,u.a)("span",{height:"1px",backgroundColor:u.f.colors.gray300,display:"inline-block",flexGrow:"1"}),X=(0,u.a)(f.a,{textDecoration:"none",color:u.f.colors.secondary,"&.overrideStyles":{textDecoration:"none",color:u.f.colors.secondary}}),K=function(e){var n,t,o=e.setShowAlreadyRegistered,r="".concat(c.ENDPOINTS.wapoSignin,"?next_url=").concat(encodeURIComponent(null===(t=window)||void 0===t?void 0:null===(n=t.location)||void 0===n?void 0:n.href));return(0,i.jsxs)(z,{"data-test-id":"saved-stories-already-registered",children:[(0,i.jsx)(G,{children:"It looks like you already have an account"}),(0,i.jsx)(F,{children:"Check your email for a link to sign in securely, without a password"}),(0,i.jsxs)(V,{children:[(0,i.jsx)(W,{}),(0,i.jsx)(J,{children:"or"}),(0,i.jsx)(W,{})]}),(0,i.jsx)(X,{className:"overrideStyles",variant:"cta",as:"a",href:r,"data-test-id":"tf-signin-button",children:"Sign in"}),(0,i.jsx)(M,{onClick:function(){return o(!1)},"data-test-id":"tf-back-link",children:"Back"})]})},Y=(0,u.a)("div",{diplay:"flex",flexDirection:"column",justifyContent:"center",maxWidth:"311px",margin:"0 auto",paddingBlockStart:u.f.space["075"],paddingBlockEnd:u.f.space["075"]}),H=(0,u.a)("h2",{color:u.f.colors.primary,fontFamily:u.f.fonts.headline,fontSize:u.f.fontSizes["150"],textAlign:"center"}),q=(0,u.a)("button",{textDecoration:"underline",color:u.f.colors.accessible,fontFamily:u.f.fonts.meta,fontSize:u.f.fontSizes["087"],textAlign:"center",marginTop:u.f.space["100"],padding:"0",border:"none",backgroundColor:"transparent",display:"block",marginInline:"auto",cursor:"pointer"}),Q=(0,u.a)(P.a,{textAlign:"center"}),Z=(0,u.a)(f.a,{textDecoration:"none",color:u.f.colors.secondary,marginTop:u.f.space["125"],display:"inline-block","&.overrideStyles":{textDecoration:"none",color:u.f.colors.secondary}}),ee=function(e){var n=e.setShowAlreadyRegisteredSSO,t={nextUrl:window.location.href,socialProvider:L.aA.SSO,thirdPartyAuth:!0},r="".concat(c.ENDPOINTS.base,"/user/auth/sso/login?state=").concat(window.btoa(JSON.stringify(t)));return(0,i.jsxs)(Y,{"data-test-id":"saved-stories-already-registered-sso",children:[(0,i.jsx)(H,{children:"It looks like you already have an account"}),(0,i.jsx)(Q,{children:(0,i.jsx)(Z,{className:"overrideStyles",variant:"cta",as:"button",onClick:function(e){e.preventDefault(),new c.GoogleAnalytics().sendGAEvent((0,o._)({},L.KN.SSO)),setTimeout(function(){window.location.href=r},100)},"data-test-id":"saved-stories-sso-button",children:"Continue with single sign-on"})}),(0,i.jsx)(q,{onClick:function(){return n(!1)},"data-test-id":"saved-stories-back-link",children:"Back"})]})},en=(0,u.a)(P.a,{backgroundColor:"$secondary",height:"100%",justifyContent:"flex-start",padding:"$150",paddingInline:"$200",paddingTop:"$125",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center"}),et=(0,u.a)("img",{height:68,width:68}),eo=(0,u.a)("p",{fontFamily:"$headline",fontSize:"$150",fontWeight:"$bold",marginBottom:"$075"}),er=(0,u.a)("p",{fontFamily:"$subhead",fontSize:"$100",paddingLeft:"$050",paddingRight:"$050",paddingBottom:"0",marginBottom:"$0",marginTop:"$075",width:"100%"}),ei=(0,u.a)("a",{color:u.f.colors["onBackground-subtle"],textDecoration:"underline",textDecorationColor:u.f.colors["onBackground-subtle"]}),es=function(e){var n,t=e.isSub,s=e.isTerminatedSub,a=e.pageType,c=e.subscribeUrl,l=e.userId,d=e.onRegistration,f=(0,r._)((0,p.useState)(!1),2),g=f[0],h=f[1],S=(0,r._)((0,p.useState)(!1),2),m=S[0],v=S[1],b=(0,r._)((0,p.useState)("".concat(c,"/signin")),2),y=b[0],x=b[1],w=(0,U.bp)().globalContent;(0,p.useEffect)(function(){x("".concat(y,"?next_url=").concat(encodeURIComponent(window.location.href)))},[]);var I=function(){(0,O.Do)(O.CE.SignIn,a,{isSub:t,isTerminatedSub:s,userId:l}),window.location.assign(y)},C=(n=(0,N._)(function(e){return(0,B.Jh)(this,function(n){return"Existing Subscriber"===e.registrationResultType||"Existing Non-Subscriber"===e.registrationResultType?h(!0):"Existing SSO User"===e.registrationResultType?v(!0):"New User"===e.registrationResultType&&d(),[2]})}),function(e){return n.apply(this,arguments)}),k={arcId:(null==w?void 0:w._id)||"unknown",captchaType:"turnstile",consumerId:"spectrumLuf",containerStyle:{minWidth:"auto",width:"100%"},ctaButtonText:"Continue",ctaVariant:"cta",onRegistration:C,showTosOnLoad:!1,startLocation:"REGFORM",startMethod:"REGFORM",subscriptionExperience:"SAVED_STORIES",tosProps:{type:"spectrumLuf"}};return(0,i.jsx)(en,{children:g?(0,i.jsx)(K,{setShowAlreadyRegistered:h}):m?(0,i.jsx)(ee,{setShowAlreadyRegisteredSSO:v}):(0,i.jsxs)(i.Fragment,{children:[a!==O.rw.ARTICLE_PAGE&&(0,i.jsx)(et,{src:O.P7}),(0,i.jsxs)("div",{children:[a!==O.rw.ARTICLE_PAGE&&(0,i.jsx)(eo,{children:"Not hungry yet?"}),(0,i.jsxs)(eo,{children:["Create a free account to",(0,i.jsx)("br",{})," save"," ",a!==O.rw.ARTICLE_PAGE?"recipes.":"this story"]})]}),(0,i.jsx)(L.GG,(0,o._)({},k)),(0,i.jsxs)(er,{css:{color:u.f.colors["onBackground-subtle"]},children:["Already have an account?"," ",(0,i.jsx)(ei,{href:y,onClick:function(e){e.preventDefault(),I()},children:"Sign in"})]})]})})},ea=t(27499),ec=(0,u.a)("div",{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",margin:"0 auto",paddingTop:u.f.space["200"],paddingBottom:u.f.space["125"],paddingInline:u.f.space["125"]}),el=(0,u.a)("h2",{color:u.f.colors.primary,fontFamily:u.f.fonts.headline,fontSize:u.f.fontSizes["150"],textAlign:"center",marginBlock:u.f.space["125"]}),ed=(0,u.a)("p",{color:u.f.colors["onBackground-subtle"],fontSize:u.f.fontSizes["112"],textAlign:"center",margin:"0",marginBottom:u.f.space["125"]}),eu=(0,u.a)(f.a,{textDecoration:"none",color:u.f.colors.secondary,width:"167px"}),ef=(0,u.a)("a",{color:u.f.colors["onBackground-subtle"],textDecoration:"underline"}),eg=function(e){var n=e.onDoneClick;return(0,i.jsxs)(ec,{"data-test-id":"saved-stories-already-registered",children:[(0,i.jsx)(g.a,{fill:u.f.colors.green200,label:"",size:200,children:(0,i.jsx)(ea.a,{})}),(0,i.jsx)(el,{children:"All set! Story saved."}),(0,i.jsxs)(ed,{children:["You can view all your saved stories in ",(0,i.jsx)("br",{}),(0,i.jsx)(ef,{href:"".concat(c.ENDPOINTS.mypost,"/saved-stories/?itid=saved-story-registration"),children:"My Post"}),"."]}),(0,i.jsx)(eu,{variant:"cta",onClick:n,"data-test-id":"registered-done-button",children:"Done"})]})},ep={dev:"https://checkpref-dev.washingtonpost.com/user",sandbox:"https://checkpref-stage.washingtonpost.com/user",prod:"https://checkpref.washingtonpost.com/user"},eh=(0,u.a)(f.a,{"&.overrideStyles":{border:"none"}}),eS=(0,u.a)(g.a,{display:"block",position:"relative"}),em=p.memo(function(e){var n,t=e.pageType,u=void 0===t?O.rw.ARTICLE_PAGE:t,f=(0,m.Gt)(),g=(0,S.S)(),b=g.isSub,y=g.isLoggedIn,x=g.isTerminatedSub,w=(null===(n=(0,c.getLoginDetails)())||void 0===n?void 0:n.wapoLoginID)||"",I=(0,h.$Y)().fullUrl,C=(0,a.d)(),k=ep[C],E=(0,s.h2)(C).subscribeUrl,D=void 0===E?"":E,T="".concat(D,"/preferenceapi"),A="".concat(T,"/v1/saved/story"),N=(0,r._)((0,p.useState)(!1),2),B=N[0],P=N[1],L=(0,r._)((0,p.useState)(!1),2),U=L[0],z=L[1],G=(0,r._)((0,p.useState)(!1),2),F=G[0],M=G[1];(0,p.useEffect)(function(){z(y)},[z,y]);var J=(0,r._)((0,p.useState)(!1),2),V=J[0],W=J[1],X=u===O.rw.RECIPE_FINDER?{padding:"$025",position:"absolute",bottom:0,right:0}:{},K=function(){R({preferencesUrl:A,articleUrl:I}).then(function(e){W("SAVED"===e)}).catch(function(e){console.error("error adding article to saved stories: ",e)})},Y=function(){V?$({preferencesUrl:A,articleUrl:I}).then(function(e){W("DELETED"!==e)}).catch(function(e){console.error("error removing article from saved stories: ",e)}):K()};(0,p.useEffect)(function(){if(U){var e,n,t=null===(n=window)||void 0===n?void 0:null===(e=n.wpMetaData)||void 0===e?void 0:e.published_date;j(k).then(function(e){var n=e.lastUpdated;return!n||n>t}).catch(function(){return!0}).then(function(e){e&&_(A,I).then(function(e){W(!!(null==e?void 0:e.uri))}).catch(function(e){console.error("error getting article's saved stories status: ",e)})}).finally(function(){})}},[U]);var H=(0,p.useMemo)(function(){return(0,i.jsx)(eS,{"data-bookmark-status":V?"saved":"notsaved",label:"",children:V?(0,i.jsx)(l.a,{}):(0,i.jsx)(d.a,{})})},[V]);return U?(0,i.jsx)(eh,{"aria-label":"Save","aria-pressed":V?"true":"false",className:"overrideStyles",density:"compact",icon:"center",isOutline:!0,onClick:function(e){e.preventDefault(),Y()},variant:"primary",children:H}):(0,i.jsxs)(v.P,{id:"subscribe-cta-drawer",hasCustomDrawerHeight:!0,triggerLabel:"Save this article",lockScrimScroll:!0,open:B,onOpenChange:function(e){e?(0,O.Do)(O.CE.Impression,u,{isSub:b,isTerminatedSub:x,userId:w}):((0,O.Do)(O.CE.Dismiss,u,{isSub:b,isTerminatedSub:x,userId:w}),F&&z(!0)),P(e)},showPopover:!f,closeBtnStyles:{border:"none",position:"absolute","@notSm":{top:"0",right:"0"},"@sm":{top:"0",right:"0"}},drawerStyles:{triggerStyles:{"&.overrideStyles":(0,o._)({border:"none"},X)},contentStyles:{"> div":{padding:0,"& p":{color:"$onBackground"}}}},popoverStyles:{contentStyles:{width:375,zIndex:"$shell",padding:0},triggerStyles:(0,o._)({border:"none"},X)},children:[(0,i.jsx)(v.P.Trigger,{children:H}),(0,i.jsx)(v.P.Content,{children:F?(0,i.jsx)(eg,{onDoneClick:function(){P(!1),z(!0)}}):(0,i.jsx)(es,{isSub:b,isTerminatedSub:x,pageType:u,subscribeUrl:D,userId:w,onRegistration:function(){K(),M(!0)}})})]})});em.displayName="BookmarkButton";var ev=(0,u.a)(P.a,{backgroundColor:"$secondary",height:"100%",justifyContent:"center",padding:"$050",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",rowGap:"$075",marginBlock:"$100"}),eb=(0,u.a)("img",{height:68,width:68}),ey=(0,u.a)("p",{fontFamily:"$headline",fontSize:"$150",fontWeight:"$bold"}),ex=(0,u.a)("p",{fontFamily:"$subhead",fontSize:"$087",paddingLeft:"$050",paddingRight:"$050"}),ew=(0,u.a)("a",{color:"$accessible",textDecoration:"underline",textDecorationColor:"$accessible"}),eI=function(e){var n=e.isSub,t=e.isTerminatedSub,o=e.userId;return void 0!==n&&n&&o?"registered-users":void 0!==t&&t?"terminated-subscribers":"anonymous-users"},eC=function(e){var n=e.isSub,t=e.isTerminatedSub,o=e.pageType,s=e.subscribeUrl,a=e.userId,c=(0,r._)((0,p.useState)("".concat(s,"/signin")),2),l=c[0],d=c[1],u=(0,p.useMemo)(function(){var e="ONSITE_SAVE_".concat(o.replace("-","_").toUpperCase());return"".concat(s,"/?s_l=").concat(e)},[s,o]);(0,p.useEffect)(function(){d("".concat(l,"?next_url=").concat(encodeURIComponent(window.location.href)))},[]);var g=function(){(0,O.Do)(O.CE.SignIn,o,{isSub:n,isTerminatedSub:t,userId:a}),window.location.assign(l)};return(0,i.jsxs)(ev,{children:[o!==O.rw.ARTICLE_PAGE&&(0,i.jsx)(eb,{src:O.P7}),(0,i.jsxs)("div",{children:[o!==O.rw.ARTICLE_PAGE&&(0,i.jsx)(ey,{children:"Not hungry yet?"}),(0,i.jsxs)(ey,{children:[t?"Resubscribe":"Subscribe"," to save"," ",o!==O.rw.ARTICLE_PAGE?"recipes.":"story"]})]}),(0,i.jsx)(ex,{children:(0,O.fC)(o,t)}),(0,i.jsx)(f.a,{density:"compact",variant:"cta",onClick:function(){(0,O.Do)(O.CE.ViewOffer,o,{isSub:n,isTerminatedSub:t,userId:a}),window.location.assign(u)},children:"View offers"}),(0,i.jsxs)(ex,{css:{color:"$accessible"},children:["Already a subscriber?"," ",(0,i.jsx)(ew,{href:l,onClick:function(e){e.preventDefault(),g()},children:"Sign in"})]})]})}},9153:function(e,n,t){t.d(n,{M:function(){return o}});var o=function(){try{var e=new Date().toString();window.sessionStorage.setItem(e,e);var n=window.sessionStorage.getItem(e)===e;return window.sessionStorage.removeItem(e),n}catch(e){return!1}}}}]);