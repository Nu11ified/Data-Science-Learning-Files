"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{869:function(e,t,n){n.d(t,{Z:function(){return ew}});var i,s,o,r,a,c,l,d,u,m=n(94213),g=n(32586),p=n(25659),f=n(5093),h=n(52676),v=n(75271),b=n(91678),x=n(94780),y=n(95148),C=n(74471),w=n(32814),S=n(83505),_=n(92319),k=n(90605),j=n(53138),N={id:"post_newsletter1"},T=n(40507),E=n.n(T),I=n(90223),P=n(49695),O=n(10104),A=n(8468),L=n(67434),R="SCReactError",q=function(e){(0,O._)(n,e);var t=(0,L._)(n);function n(e,i){var s;return(0,I._)(this,n),(s=t.call(this)).name=i,s.message=e,s}return n}((0,A._)(Error)),M=function(e){(0,O._)(n,e);var t=(0,L._)(n);function n(e){var i;return(0,I._)(this,n),(i=t.call(this,e)).state={hasError:!1},i}return(0,P._)(n,[{key:"componentDidCatch",value:function(e,t){window.Sentry&&window.Sentry.withScope(function(n){var i;n.setExtras(t),window.Sentry.captureException((i="Component",new q("".concat(R," ").concat(e.message),"".concat(R).concat(i,":"))))}),this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?null:this.props.children}}]),n}(v.Component);M.propTypes={children:E().node};var H=(0,v.createContext)({}),F=(0,v.createContext)({isSlim:!1}),U=n(42226),Y=n(47068),z=function(e,t){var n;return(0,x.k)("items-center uppercase gray-darkest font-sans-serif font-xxxxs nowrap bg-white",(n={},(0,U._)(n,e,1),(0,U._)(n,"border-box h-20 flex pl-xs pr-xs pb-0",1),(0,U._)(n,"bc-gray-darkest bw b-solid bw-sibling bw-l-sibling",1),(0,U._)(n,t,t),n))},W=function(e){var t=e.children,n=e.fontWeight,i=e.useWPMark,s=e.className;return(0,h.jsxs)("span",{className:z(void 0===n?"bold":n,s),children:[void 0!==i&&i&&(0,h.jsx)(Y.a,{width:"14",height:"14",className:"db mr-xs"}),t]})};W.propTypes={children:E().node.isRequired,fontWeight:E().oneOf(["light","bold"]),useWPMark:E().bool,className:E().string};var V=function(e){var t=e.children,n=e.useWPMark,i=void 0!==n&&n,s=e.className,o=v.Children.toArray(t);return o.length>=2&&(o.length=2),(0,h.jsx)("span",{className:(0,x.k)("flex",(0,U._)({},s,s)),children:o.map(function(e,t){var n=1===o.length;return v.isValidElement(e)?(0,h.jsxs)("span",{className:z(n?e.props.fontWeight:0===t?"bold":"light"),style:{paddingTop:"1px"},children:[i&&0===t&&(0,h.jsx)(Y.a,{width:"14",height:"14",className:"db mr-xs"}),e.props.children]},t):e})})};V.propTypes={children:E().node.isRequired,useWPMark:E().bool,className:E().string};var D=(0,C.d)({from:{opacity:0},to:{opacity:1}}),J=(0,C.a)({color:C.f.colors.accessible,fontSize:C.f.fontSizes["075"],transition:C.f.transitions.allFast,opacity:0,pointerEvents:"none",visibility:"hidden",animation:"".concat(D," ").concat(C.f.transitions.allFast," ease-in-out"),variants:{show:{true:{opacity:1,pointerEvents:"auto",visibility:"visible",transitionDelay:C.f.transitions.allFast},false:{opacity:0,pointerEvents:"none",visibility:"hidden",transitionDelay:"0s"}}}}),Z=(0,C.a)("a",{color:C.f.colors.accessible,textDecoration:"underline","@hover":{"&:hover":{color:C.f.colors.accessible}}}),G=function(e){var t=e.className,n=(0,v.useContext)(H),i=n.state,s=void 0===i?"sign-up":i,o=n.terms,r=(0,v.useContext)(F).isSlim;return(0,h.jsx)(J,{className:t,"aria-hidden":!1===s.includes("form"),isSlim:r,show:s.includes("form"),children:(0,h.jsx)("span",{children:o||(0,h.jsxs)(h.Fragment,{children:["By submitting your email, you agree to our"," ",(0,h.jsx)(Z,{href:"/terms-of-service/2011/11/18/gIQAldiYiN_story.html",children:"Terms of Service"})," ","and ",(0,h.jsx)(Z,{href:"/privacy-policy/",children:"Privacy Policy"}),". You may also receive promotional emails from The Washington Post. You can You can opt out at any time."]})})})};G.propTypes={};var $=n(29940),B=n(44962),X="@container (width <= 400px)",Q="@container (width > 400px)",K=(0,C.a)("form",(i={display:"flex",flexWrap:"wrap",transition:"all 0.2s ease-in-out",gap:"$100",rowGap:"$050"},(0,U._)(i,"".concat(Q),{".ns-signup-email-address":{order:0,flex:1},".ns-signup-button":{order:0,flex:0,alignSelf:"center"},".ns-signup-terms":{order:1,flex:"0 0 100%",display:"flex",justifyContent:"flex-start"}}),(0,U._)(i,"".concat(X),{flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",".ns-signup-email-address":{order:1},".ns-signup-button":{order:3},".ns-signup-terms":{order:2}}),(0,U._)(i,"variants",{isSlim:{true:{},false:(0,U._)({alignItems:"flex-start"},"".concat(X),{alignItems:"center"})}}),i)),ee=(0,C.a)("div",{transition:"all 0.2s ease-in-out",variants:{isSlim:{true:{width:300},false:(s={height:"auto",opacity:1,width:"100%",display:"flex"},(0,U._)(s,"".concat(X),{textAlign:"center"}),(0,U._)(s,"".concat(Q),{}),s)}}}),et=(0,C.a)("div",{variants:{size:{1:{flex:1}}}}),en=function(e){var t=e.onSubmit,n=(0,v.useContext)(H),i=n.state,s=void 0===i?"sign-up":i,o=n.discoverMoreLink,r=n.disableSubmit,a=(0,v.useContext)(F).isSlim,c=(0,f._)((0,v.useState)(""),2),l=c[0],d=c[1],u=(0,f._)((0,v.useState)(!0),2),m=u[0],g=u[1],p=(0,x.k)("transition-all duration-200 ease-in-out"),b=r&&s.includes("form");return(0,h.jsxs)(K,{onSubmit:function(e){e.preventDefault(),b||t({emailAddress:l,isValid:m})},isSlim:a,children:[s.includes("form")&&(0,h.jsx)(ee,{isSlim:a,className:"ns-signup-email-address",children:(0,h.jsx)(et,{size:"1",children:(0,h.jsx)($.a,{"data-qa":"sc-newsletter-signup-email-address-input",id:"newsletter-signup-emailaddress",name:"email-address",type:"email",label:"Enter your email",error:!m||"form-failure"===s,errorMessage:"form-failure"===s?"Sorry, we had a problem submitting your email. Please wait a moment and try again.":!1===m?"Please enter a valid email address.":"",onChange:function(e){var t=e.target.value;t.length>5&&g(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(t).toLowerCase())),d(t)}})})}),s.includes("form")&&(0,h.jsx)(G,{className:"ns-signup-terms"}),s.includes("form")&&(0,h.jsx)(B.a,{className:"".concat(p," ns-signup-button"),disabled:b,type:"submit","data-qa":"sc-newsletter-signup-button",variant:"primary",density:"default",children:"Submit"}),"sign-up"===s&&(0,h.jsx)("div",{className:p,children:(0,h.jsx)(B.a,{type:"submit","data-qa":"sc-newsletter-signup-button",variant:"primary",density:"default",children:"Sign up"})}),"success"===s&&(0,h.jsx)("div",{className:p,children:(0,h.jsx)(B.a,{as:"a",href:o,type:"submit","data-qa":"sc-newsletter-signup-button",children:"Discover newsletters"})})]})};en.propTypes={onSubmit:E().func};var ei=(0,C.a)("div",(o={display:"flex",transition:"all 0.4s ease-in-out"},(0,U._)(o,"".concat(X),{flexDirection:"column",alignItems:"center"}),(0,U._)(o,"".concat(Q),{}),(0,U._)(o,"variants",{isSlim:{true:{textAlign:null}}}),o)),es=(0,C.a)("img",(r={},(0,U._)(r,"".concat(X),{display:"none"}),(0,U._)(r,"".concat(Q),{}),r)),eo=(0,C.a)("div",(a={width:"100%",display:"flex",alignItems:"center",flexWrap:"wrap",rowGap:"$050",columnGap:"$100",height:"fit-content"},(0,U._)(a,"".concat(X),{flexDirection:"column",textAlign:"center"}),(0,U._)(a,"".concat(Q),{flexDirection:"column",alignItems:"flex-start"}),(0,U._)(a,"variants",{isSlim:{},includesForm:{}}),(0,U._)(a,"compoundVariants",[{isSlim:!0,includesForm:!0,css:{flexDirection:"column"}},{isSlim:!0,includesForm:!1,css:(0,U._)({alignItems:"center"},"".concat(Q),{flexDirection:"row",justifyContent:"center"})}]),a)),er=(0,C.a)("div",{display:"inline-block"}),ea=(0,C.a)("img",(c={},(0,U._)(c,"".concat(X),{}),(0,U._)(c,"".concat(Q),{display:"none"}),(0,U._)(c,"variants",{show:{false:{display:"none"}}}),c)),ec=(0,C.a)("div",(l={},(0,U._)(l,"".concat(X),{}),(0,U._)(l,"".concat(Q),{}),l)),el=(0,C.a)("img",(d={},(0,U._)(d,"".concat(X),{}),(0,U._)(d,"".concat(Q),{display:"none"}),d)),ed=(0,C.a)("div",(u={transition:"all 0.4s ease-in-out","&:empty":{display:"none"}},(0,U._)(u,"".concat(X),{justifyContent:"center",textAlign:"center"}),(0,U._)(u,"".concat(Q),{}),(0,U._)(u,"variants",{isSlim:{true:(0,U._)({},"".concat(X),{textAlign:"center"}),false:{}}}),u)),eu=(0,v.forwardRef)(function(e,t){var n=e.className,i=e.as,s=(0,p._)(e,["className","as"]),o=(0,v.useContext)(H),r=o.imageUrl,a=o.imageHeight,c=o.imageWidth,l=o.imageAlt,d=o.newsletter,u=o.state,b=void 0===u?"sign-up":u,y=o.body,C=o.headline,w=o.onEmailAddressChange,S=o.promoLabel,_=o.hidePromoLabel,k=(0,v.useContext)(F).isSlim,j=(0,v.useRef)(),N=(0,f._)((0,v.useState)(),2),T=N[0],E=N[1],I=(0,f._)((0,v.useState)(C),2),P=I[0],O=I[1],A=(0,v.useRef)(null);(0,v.useImperativeHandle)(t,function(){return A.current}),(0,v.useEffect)(function(){"sign-up"===b&&O(C),("form"===b||"form-failure"===b||"form-submitting"===b)&&O(C),"success"===b&&j.current&&(j.current.focus(),O("Youâ€™re all set."))},[b,C,P]),s.isSlim;var L=(0,p._)(s,["isSlim"]);return(0,h.jsxs)(ei,(0,g._)((0,m._)({as:i,ref:A,className:n,isSlim:k},L),{children:[r&&(0,h.jsx)(es,{"data-chromatic":"ignore",src:r,alt:l,width:c,height:a,loading:"lazy"}),(0,h.jsxs)(eo,{isSlim:k,includesForm:b.includes("form"),children:[!k&&S&&(0,h.jsx)(er,{children:(0,h.jsxs)(V,{children:[(0,h.jsx)(W,{children:"Newsletter"}),(0,h.jsx)(W,{children:S})]})}),k&&(r&&(0,h.jsx)(ea,{show:"sign-up"===b||!1===b.includes("form")||"success"===b,"data-chromatic":"ignore",src:r,alt:l,width:c,height:a,loading:"lazy"})||!_&&(0,h.jsx)(ec,{children:(0,h.jsxs)(V,{children:[(0,h.jsx)(W,{children:"Newsletter"}),S&&(0,h.jsx)(W,{children:S})]})})),!k&&r&&(0,h.jsx)(el,{"data-chromatic":"ignore",src:r,alt:l,width:c,height:a,loading:"lazy"}),!k&&P&&(0,h.jsx)("div",{"data-qa":"sc-newsletter-signup-headline",ref:j,className:"bold font-xs gray-darkest mb-xxs empty-dn",children:P}),!1===b.includes("form")&&(0,h.jsxs)(ed,{"data-qa":"sc-newsletter-signup-body","aria-hidden":b.includes("form"),isSlim:k,className:(0,x.k)("",{"font-xxxs gray-dark mb-xxs":!k,"font-xs lh-md font-sans-serif offblack":k,"dib h-auto o-1":!1===b.includes("form"),"dn h-0 o-0":b.includes("form")}),children:["success"!==b&&y,"success"===b&&(0,h.jsxs)("span",{children:[k&&(0,h.jsx)("span",{children:"All set! "}),"You are now signed up for"," ",(0,h.jsx)("span",{className:"bold",children:d}),T&&(0,h.jsxs)("span",{children:[" at ",T]}),(0,h.jsx)("span",{children:"."})]})]}),(0,h.jsx)(en,{onSubmit:function(e){var t=e.emailAddress,n=e.isValid;"function"==typeof w&&w({emailAddress:t,isValid:n}),E(t)}})]})]}))});eu.propTypes={className:E().string,as:E().elementType},eu.displayName="NewsletterSignUpModule",eu.propTypes={className:E().string,as:E().elementType};var em=n(97916),eg=n(9235),ep=function(e){var t=e.condition,n=e.wrapper,i=e.children;return i?t?n(i):i:null};ep.propTypes={condition:E().any,wrapper:E().any,children:E().any};var ef=(0,C.a)("div",{display:"flex",width:"100%","container-type":"inline-size",height:"100%",".ns-container":{display:"flex",columnGap:"$100",width:"100%","container-type":"inline-size",height:"100%"}}),eh=(0,C.a)("div",{display:"flex",width:"100%","container-type":"inline-size",height:"100%",float:"left",".ns-container":{display:"flex",width:"100%","container-type":"inline-size",height:"100%"}}),ev=function(e){var t=e.as,n=e.imageAlt,i=e.buttonColor,s=e.discoverMoreLink,o=e.isSlim,r=void 0!==o&&o,a=e.imageUrl,c=e.imageWidth,l=e.imageHeight,d=e.promoLabel,u=e.hidePromoLabel,g=e.headline,f=e.body,b=e.state,y=e.onEmailAddressChange,C=e.newsletter,w=e.className,S=e.disableSubmit,_=e.terms,k=(0,p._)(e,["as","imageAlt","buttonColor","discoverMoreLink","isSlim","imageUrl","imageWidth","imageHeight","promoLabel","hidePromoLabel","headline","body","state","onEmailAddressChange","newsletter","className","disableSubmit","terms"]),j=(0,v.useRef)();return(0,h.jsx)(M,{children:(0,h.jsx)(F.Provider,{value:{isSlim:r},children:(0,h.jsx)(H.Provider,{value:{imageUrl:a,imageWidth:c,imageHeight:l,imageAlt:void 0===n?"":n,promoLabel:d,hidePromoLabel:u,headline:g,body:f,state:b,onEmailAddressChange:y,newsletter:C,isSlim:r,buttonColor:void 0===i?"offblack":i,discoverMoreLink:void 0===s?"https://www.washingtonpost.com/newsletters/":s,disableSubmit:void 0!==S&&S,terms:_},children:(0,h.jsx)(ef,{ref:j,children:(0,h.jsx)(ep,{condition:r,wrapper:function(e){return(0,h.jsx)(eh,{children:e})},children:(0,h.jsx)(em.Z,{mode:"in-out",children:(0,h.jsx)(eg.Z,{unmountOnExit:!0,timeout:400,classNames:{enter:"o-0",enterDone:"o-100",exit:"o-0",exitActive:"o-0"},children:(0,h.jsx)(eu,(0,m._)({as:void 0===t?"div":t,"data-qa":"sc-newsletter-signup",className:(0,x.k)("ns-container",w)},k))},"module")})})})})})})};ev.propTypes={as:E().elementType,className:E().string,imageUrl:E().string,imageWidth:E().number,imageHeight:E().number,imageAlt:E().string,promoLabel:E().string,hidePromoLabel:E().bool,headline:E().string,body:E().string,buttonColor:E().oneOf(["blue","red","green","white","offblack","subs-blue","subs-pink","subs-green","subs-navy"]),state:E().oneOf(["sign-up","form","form-submitting","form-failure","success"]),onEmailAddressChange:E().func,newsletter:E().string,discoverMoreLink:E().string,isSlim:E().bool,disableSubmit:E().bool,terms:E().element};var eb=function(e){var t=e.newsletterArgs,n=e.onEmailAddressChange,i=e.signupFlowState;return(0,h.jsx)(ev,(0,m._)({"aria-label":"",className:"",onEmailAddressChange:n,state:i},t))};eb.propTypes={newsletterArgs:E().object,signupFlowState:E().string,onEmailAddressChange:E().func};var ex=function(e){var t=e.pageLocation,n=(0,p._)(e,["pageLocation"]),i=(0,b.useNewsletter)(),s=(0,b.useIsEnrolled)(),o=(0,b.useUser)().email,r=(0,f._)((0,v.useState)(!1),2),a=r[0],c=r[1],l=(0,h.jsx)(y.O,{onChange:function(e){return c(e)},type:"account",pageLocation:t,email:o,isSubmitted:s,labelSizeSm:!1});return(0,h.jsx)(b.NewsletterSignUp,(0,g._)((0,m._)({},n),{terms:l,disableSubmit:!a,newsletter:i}))},ey=function(e){var t=(0,w.GW)().contextPath,n=(0,w.bp)().globalContent,i=(0,b.useEnrollmentsContext)(),s=i.isLoading,o=i.enrollments,r=void 0===o?null:o,a=v.useMemo(function(){return Object.keys(r).filter(function(e){return r[e].enrolled})},[r]),c=(0,f._)((0,v.useState)(""),2),l=c[0],d=c[1],u=!s&&!l;return(0,v.useEffect)(function(){var e=!1;return u&&(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=(0,j.I)("foryouFlex.newsletters"),i=(0,k.YH)(e);return(0,_.Z)(n,{method:"POST",body:JSON.stringify({section_path:i,referrer:"https://www.washingtonpost.com/",enrollments:t})}).then(function(e){return e.newsletter})})(n,a).then(function(t){e||d(t.id)}).catch(function(){e||d(N.id)}),function(){e=!0}},[u,n,a]),l?(0,h.jsx)(b.SingleNewsletterProvider,(0,g._)((0,m._)({post_newsletter:l},e.trackingArgs),{children:e.children})):(0,h.jsx)(eb,{signupFlowState:"sign-up",newsletterArgs:(0,m._)({imageUrl:"".concat(t,"/resources/images/generic-newsletter-signup.png"),imageHeight:110,imageWidth:166,discoverMoreLink:"https://washingtonpost.com/newsletters/"},e.uiArgs)})},eC=(0,C.a)("div",{variants:{hasImage:{false:{minHeight:"149px"}}}});function ew(e){var t=e.hasImage,n=void 0===t||t,i=e.newsletterID,s=e.rightRail,o="spectrum-newsletter-signup".concat(s?"-rr":""),r=(0,m._)({},n?{}:{imageUrl:""}),a={method:"EI",location:s?"RR":"ART_ISB"};return(0,h.jsx)(S.Z,{children:(0,h.jsx)(eC,{"data-qa":"newsletter",className:(0,x.k)("hide-for-print relative",{"dn db-l":s}),hasImage:n,children:i?(0,h.jsx)(b.SingleNewsletterProvider,(0,g._)((0,m._)({post_newsletter:i},a),{children:(0,h.jsx)(ex,(0,g._)((0,m._)({},r),{pageLocation:o}))})):(0,h.jsx)(ey,{uiArgs:r,trackingArgs:a,children:(0,h.jsx)(ex,(0,g._)((0,m._)({},r),{pageLocation:o}))})})})}},92319:function(e,t,n){var i=n(94213),s=function(e){return new Promise(function(t){return e.json().then(function(n){return t({status:e.status,ok:e.ok,json:n})})})},o=function(e){if(!e.ok)throw e.json||e;return e.json},r={Accept:"application/json","Content-Type":"application/json"};t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{method:"GET"};return t.headers=(0,i._)({},t.headers,r),fetch(e,t).then(s).then(o)}},95148:function(e,t,n){n.d(t,{O:function(){return U}});var i=n(94213),s=n(32586),o=n(5093),r=n(52676),a=n(75271),c=n(40507),l=n.n(c),d=n(48479),u=n(29462),m="wapo_identity",g={consentCountry:"",tos:""},p=function(){var e,t=(null===(e=window.location)||void 0===e?void 0:e.hostname)||"",n="prod";return/(pb-impact\.|subs-stage\.|sandbox\.|.preview.now.washingtonpost.com|localhost.washingtonpost.com)/.test(t)?n="sandbox":/dev\.washpost|localhost|digitalink\.com/.test(t)&&(n="dev"),n},f=function(){var e,t=(null===(e=window.location)||void 0===e?void 0:e.hostname)||"";return/(subscribe\.|subscription\.|subs-stage\.|local.digitalink\.)/.test(t)},h={configUrl:{dev:"https://subscribe.digitalink.com",sandbox:"https://subs-stage.washingtonpost.com",prod:"https://www.washingtonpost.com/subscribe"},subsUrl:{dev:"https://subscribe.digitalink.com",sandbox:"https://subs-stage.washingtonpost.com",prod:"https://subscribe.washingtonpost.com"}},v=function(){try{var e=new Date().toString();window.localStorage.setItem(e,e);var t=window.localStorage.getItem(e)===e;return window.localStorage.removeItem(e),t}catch(e){return!1}},b=function(e){return h[e][p()]||h[e].prod},x=function(){var e=p(),t=(0,d.e)("wp_geo")||"";return(null==t?void 0:t.split("|")[0])?t.split("|")[0].toLowerCase():t||"prod"===e?null:"us"},y=function(){var e=b(f()?"subsUrl":"configUrl");return Promise.race([fetch("".concat(e,"/static/config/tos/tos.json"),{method:"GET"}),new Promise(function(e,t){return setTimeout(function(){return t(Error("timeout"))},8e3)})])},C=function(){var e=(0,d.e)("wapo_actmgmt");return!!(e&&"undefined"!==e)},w=function(){var e;return(v()&&(e=C()?JSON.parse(localStorage.getItem(m)):{}),e)?e.privacySetting||g:{}},S=function(e){var t;if(v()&&(t=JSON.parse(localStorage.getItem(m))),t){var n={privacySetting:(0,i._)({},t.privacySetting,e)},s=(0,i._)({},t,n);localStorage.setItem(m,JSON.stringify(s))}},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=b("subsUrl"),s={appName:"SC",locationId:"SC:TermsOfService",message:"no message",state:{}};s=(0,i._)({},s,t);var o=(0,d.e)("wapo_login_id")||"";return o&&(s.state.wapo_login_id=o),s.state.error instanceof Error?s.state.error=s.state.error.toString():s.state.error instanceof Object&&(s.state.error=JSON.stringify(s.state.error)),(0,u.X)("".concat(n,"/logging/").concat(e),{method:"POST",credentials:"include",body:JSON.stringify(s)})},k=function(e){if(v()){var t=localStorage.getItem("wapo_identity"),n=Object.assign(t=t&&JSON.parse(t)||{},e),i=Date.now()+864e5;n.e=i,localStorage.setItem("wapo_identity",JSON.stringify(n))}},j=function(e,t){var n=b("subsUrl"),i=null;return(0,u.X)("".concat(n,"/user/auth-status?_v=").concat(new Date().getTime()),{method:"GET",credentials:"include"}).then(function(e){e&&"SUCCESS"===e.status&&!f()&&k(e.userState),i=e}).catch(function(e){return console.error(e)}).finally(function(){return f()||S(e),null==t||t(),i})},N=function(){var e=w();return 0===Object.keys(e).length&&C()&&f()?j().then(function(e){var t;return(null==e?void 0:null===(t=e.userState)||void 0===t?void 0:t.privacySetting)||g}):Promise.resolve(e)},T=function(e){var t=!1,n=!1;return N().then(function(i){var s=i.marketingConsent,o=void 0===s?{}:s,r=i.tos,a=void 0===r?{}:r;return t="Y"!==a.consent,(void 0===o.consent||0!==o.consent)&&(n=!0),{tos:a,marketingConsent:o,isConfigNeeded:e||t||n,isToSNeeded:t,isMcNeeded:n,userConfigReady:!0}})},E=function(e,t,n){t&&(e.email=t);var i=b("subsUrl"),s=JSON.stringify(e);(0,u.X)("".concat(i,"/user/save-identity-preferences"),{method:"POST",credentials:"include",body:s}).then(function(t){if("SUCCESS"===t.status&&C()){var i=JSON.parse(localStorage.getItem(m));i&&i.signedIn?(f()||S(e.privacySetting),n()):j(e.privacySetting,n)}else"SUCCESS"===t.status&&n()}).catch(function(e){console.error(e),_("logFailure",{message:"SIP failed",locationId:"SC:TermsOfService:api:/user/save-identity-preferences",state:{status:"failure",request:s,error:e,url:"".concat(window.location.origin).concat(window.location.pathname)}}),n("failed")})},I=function(e){return Object.keys(e).reduce(function(t,n){return t[n.toLowerCase()]=e[n],t},{})},P=function(e,t){var n=RegExp(Object.keys(t).join("|"),"gi");return null==e?void 0:e.replace(n,function(e){return t[e]})},O=function(e){var t=e.s3Config,n=e.country,o=e.propTosConfig,r=e.propMcConfig,a=e.isToSNeeded,c=e.type,l=e.overrideTosHidden,d=e.s3MapObj,u=t._||{},m=(0,i._)({},null==u?void 0:u.tos._,null==u?void 0:u.tos[c]),g=(0,i._)({},null==u?void 0:u.marketingConsent._,null==u?void 0:u.marketingConsent[c]),p={},f={},h=Object.keys(t).find(function(e){return e.toLowerCase().indexOf(n)>-1});if(h){var v,b,x,y,C=I(void 0===o?{}:o),w=(0,i._)({},C._,C[h]),S=I(void 0===r?{}:r),_=(0,i._)({},S._,S[h]);p=(0,i._)({},null===(v=t[h])||void 0===v?void 0:v.tos._,null===(b=t[h])||void 0===b?void 0:b.tos[c],w),f=(0,i._)({},null===(x=t[h])||void 0===x?void 0:x.marketingConsent._,null===(y=t[h])||void 0===y?void 0:y.marketingConsent[c],_)}var k=!l&&(!a||p.prechecked);return p=(0,s._)((0,i._)({},m,p),{isChecked:!!k}),f=(0,s._)((0,i._)({},g,f),{isChecked:!!f.prechecked}),d&&(p.text=P(p.text,d),f.text=P(f.text,d)),{tos:p,mc:f}},A=n(62004),L=function(e){var t=e.onChange,n=e.isChecked,o=e.id,a=e.children,c=e.disabled,l=e.checkboxLabelClass,d=e.checkboxLabelStyle,u=e.labelSizeSm?"16px":"18px";return(0,r.jsx)("div",{className:"db gray-dark relative flex pt-xxs pb-xxs items-start ".concat(l),children:(0,r.jsx)(A.a,{checked:n,disabled:c,id:o,"data-testid":o,onCheckedChange:t,css:{height:u,width:u,marginTop:"16px"===u?"3px":0},children:(0,r.jsx)("span",{className:"relative db ".concat(l||""),style:(0,s._)((0,i._)({},d),{paddingTop:"2px"}),children:a})})})};L.propTypes={onChange:l().func,isChecked:l().bool,checkboxLabelStyle:l().object,checkboxLabelClass:l().string,id:l().string,children:l().node,disabled:l().bool,labelSizeSm:l().bool};var R=JSON.parse('{"tosConfig":{"_":{"tos":{"_":{"text":"I agree to The Washington Post&#39;s {{TERMS_OF_SERVICE}} and {{PRIVACY_POLICY}}.","required":true,"implicit":false,"prechecked":false},"checkout":{"text":"By creating your account, you agree to The Washington Post&#39;s {{TERMS_OF_SERVICE}} and {{PRIVACY_POLICY}}.","required":false,"implicit":true},"freeTrial":{"text":"By signing up for this free trial, you agree to the {{TERMS_OF_SERVICE}} and {{PRIVACY_POLICY}}.","implicit":false}},"marketingConsent":{"_":{"text":null,"implicit":true,"prechecked":false}}},"us":{"tos":{},"marketingConsent":{}},"ca":{"tos":{},"marketingConsent":{"_":{"text":"The Washington Post may use my email address to provide me occasional special offers via email and through other platforms. I can opt out at any time.","implicit":false},"checkout":{"required":false}}},"gb|at|be|bg|hr|cy|cz|dk|ee|fi|fr|de|gr|hu|ie|it|lv|lt|lu|mt|nl|pl|pt|ro|sk|si|es|se|is|no|ch|li":{"tos":{"freeTrial":{"text":"By signing up for this free trial of our <span id=\'ftSubType\'></span>, you agree to our {{TERMS_OF_SERVICE}} and understand we process data as set forth in our {{PRIVACY_POLICY}}.","implicit":false}},"marketingConsent":{"_":{"text":"The Washington Post may use my email address to provide me occasional special offers via email and through other platforms. I can opt out at any time.","implicit":false},"checkout":{"required":false}}}},"tosMapObj":{"{{TERMS_OF_SERVICE}}":"<a target=\'_blank\' style=\'color:inherit;\' class=\'underline\' href=\'https://www.washingtonpost.com/terms-of-service/2011/11/18/gIQAldiYiN_story.html\'>Terms of Service</a>","{{PRIVACY_POLICY}}":"<a target=\'_blank\' style=\'color:inherit;\' class=\'underline\' href=\'https://www.washingtonpost.com/privacy-policy/\'>Privacy Policy</a>","{{THIRD_PARTY_PARTNERS}}":"<a target=\'_blank\' style=\'color:inherit;\' class=\'underline\' href=\'https://www.washingtonpost.com/third-party-partners/\'>third-party partners</a>"}}'),q=function(e){var t=e.propTosConfig,n=e.propMcConfig,i=e.isToSNeeded,s=e.type,r=e.isConfigNeeded,c=e.overrideTosHidden,l=e.userConfigReady,d=(0,o._)((0,a.useState)(!1),2),u=d[0],m=d[1],g=(0,o._)((0,a.useState)({isChecked:!1}),2),p=g[0],f=g[1],h=(0,o._)((0,a.useState)({isChecked:!1}),2),v=h[0],b=h[1],C=(0,o._)((0,a.useState)(null),2),w=C[0],S=C[1],_=x(),k=function(e){var o=null==e?void 0:e.tosConfig,r=null==e?void 0:e.tosMapObj;o||(o=R.tosConfig,r=R.tosMapObj);var a=O({s3Config:o,country:_,propTosConfig:t,propMcConfig:n,isToSNeeded:i,type:s,overrideTosHidden:c,s3MapObj:r}),l=a.tos,d=a.mc;f(l),b(d),m(!0)};return(0,a.useEffect)(function(){l&&(r||t||n?w?k(w):y().then(function(e){return e.json()}).then(function(e){S(e),k(e)}).catch(function(e){console.error(e),k(R)}):m(!0))},[l,r,i,s]),{tosConfig:p,mcConfig:v,ready:u,country:_,updateConfigValue:function(e,t){"tos"===e?f(t):"mc"===e&&b(t)}}},M=n(74471),H=n(22892),F=function(e){var t=e||{},n=t.type,i=t.tosConfig,s=t.mcConfig,r=t.overrideTosHidden,c=void 0!==r&&r,l=t.refreshKey,d=(0,o._)((0,a.useState)({}),2),u=d[0],m=d[1],g=(0,o._)((0,a.useState)({isHidden:!1,isRequired:!1}),2),p=g[0],f=g[1];(0,a.useEffect)(function(){var e={},t=function(){T(c).then(function(t){e=t,m(t)})},n=function(e){e&&t()},i=C();window.registerPwapiConsumer&&i?window.registerAuthConsumer?window.registerAuthConsumer(n):window.registerAuthConsumer||(window.authConsumers=window.authConsumers||[],window.authConsumers.push(n)):t(),setTimeout(function(){i&&!e.userConfigReady&&t()},3e3)},[c,void 0===l?0:l]);var h=u.isConfigNeeded,v=u.isToSNeeded,b=u.isMcNeeded,x=q({propTosConfig:i,propMcConfig:s,isToSNeeded:v,type:void 0===n?"account":n,isConfigNeeded:h,overrideTosHidden:c,userConfigReady:u.userConfigReady}),y=x.tosConfig,w=x.mcConfig,S=x.ready,_=x.country,k=x.updateConfigValue;return(0,a.useEffect)(function(){S&&f({isHidden:(!v||y.implicit)&&!c&&(!b||w.implicit),isRequired:!!(v&&y.required)||!!(b&&w.required)})},[S,u]),{ready:S,isHidden:p.isHidden,isRequired:p.isRequired,storedUserConfig:u,tosConfig:y,mcConfig:w,country:_,updateConfigValue:k}},U=function(e){var t=e.isSubmitted,n=void 0!==t&&t,o=e.email,c=e.className,l=e.checkboxLabelClass,d=void 0===l?"":l,u=e.checkboxLabelStyle,m=void 0===u?{}:u,g=e.labelSizeSm,p=void 0===g||g,f=e.asteriskColor,h=void 0===f?"red":f,v=e.onChange,b=void 0===v?function(){console.error("onChange function missing"),_("logFailure",{message:"onChange function missing"})}:v,x=e.tosConfigReady,y=void 0===x?function(){}:x,C=e.overrideTosHidden,w=void 0!==C&&C,S=e.disabled,k=void 0!==S&&S,j=e.pageLocation,N=void 0===j?"":j,T=e.accountSource,I=F(e),P=I.storedUserConfig,O=I.tosConfig,A=I.mcConfig,R=I.ready,q=I.country,U=I.updateConfigValue,Y=P.tos,z=void 0===Y?{}:Y,W=P.marketingConsent,V=void 0===W?{}:W,D=P.isConfigNeeded,J=P.isToSNeeded,Z=P.isMcNeeded,G=(!J||O.implicit)&&!w&&(!Z||A.implicit);(0,a.useEffect)(function(){R&&((O.required||A.required)&&D||b(!0),y({isHidden:G,tosConfig:O,mcConfig:A}))},[R]),(0,a.useEffect)(function(){O.required&&A.required?b(O.isChecked&&A.isChecked):O.required?b(O.isChecked):A.required&&b(A.isChecked)},[O.isChecked,A.isChecked]);var $=function(){if(!q){console.error("SIP failed - wp_geo missing"),_("logFailure",{message:"wp_geo missing"}),y({isHidden:G,isProcessed:!0,isSIPFailed:!0});return}var e=z.consent,t=z.consentCountry,n=V.consent,i=V.consentCountry,s=A.isChecked?0:1,r=A.implicit?-1:s,a=q,c=O.isChecked||!J||O.implicit?"Y":"N";10===n?(r=r<0?1:r,a=q):(void 0!==n&&!Z||n>-1&&r<0||n===r)&&(r=n,a=i);var l={privacySetting:{tos:{consent:"".concat(c),consentCountry:"Y"!==e||J||w?q:t},marketingConsent:{consent:"".concat(r),consentCountry:a}}};T&&(l.accountSource=T),E(l,o,function(e){"failed"===e?y({isHidden:G,isProcessed:!0,isSIPFailed:!0}):y({isHidden:G,isProcessed:!0})})};(0,a.useEffect)(function(){n&&$()},[n]);var B=J||w,X=N?"".concat(N,"TosCheckbox"):"tosCheckbox",Q=N?"".concat(N,"McCheckbox"):"mcCheckbox",K=p?"font-xxxxs":"font-xxxs",ee=O.implicit?"".concat(K," ").concat(d," pt-xxs pb-xxs gray-dark"):K,et=A.implicit?"gray-dark ".concat(K," ").concat(d):K,en=(0,M.a)("span",{color:M.f.colors.error}),ei=(0,r.jsxs)("span",{style:(0,s._)((0,i._)({},m),{paddingTop:"1px"}),className:"db ".concat(ee||""),children:[(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:O.text}}),O.required&&(0,r.jsx)(en,{css:(0,s._)((0,i._)({},m),{color:h}),children:"*"})]}),es=(0,r.jsxs)("span",{style:(0,s._)((0,i._)({},m),{paddingTop:"1px"}),className:"relative db ".concat(et||""),children:[(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:A.text}}),A.required&&(0,r.jsx)(en,{css:(0,s._)((0,i._)({},m),{color:h}),children:"*"})]});return(0,r.jsxs)("div",{className:"db mt-xs mb-xs ".concat(void 0===c?"":c),children:[B&&O.text&&!O.implicit&&(0,r.jsx)(L,{onChange:function(){return U("tos",(0,s._)((0,i._)({},O),{isChecked:!O.isChecked}))},isChecked:O.isChecked,id:X,disabled:k,checkboxLabelClass:d,checkboxLabelStyle:m,labelSizeSm:p,children:ei}),B&&O.text&&O.implicit&&(0,r.jsx)(H.a,{required:O.required,children:ei}),Z&&A.text&&!A.implicit&&(0,r.jsx)(L,{htmlText:A.text,onChange:function(){return U("mc",(0,s._)((0,i._)({},A),{isChecked:!A.isChecked}))},isChecked:A.isChecked,id:Q,disabled:k,checkboxLabelClass:d,checkboxLabelStyle:m,labelSizeSm:p,children:es}),Z&&A.text&&A.implicit&&(0,r.jsx)(H.a,{required:A.required,children:es})]})},Y=l().objectOf(l().shape({text:l().string,required:l().bool,implicit:l().bool,prechecked:l().bool}));U.propTypes={onChange:l().func.isRequired,isSubmitted:l().oneOfType([l().string,l().bool]).isRequired,email:l().string,type:l().oneOfType([l().string]),className:l().string,checkboxLabelClass:l().string,checkboxLabelStyle:l().object,tosConfig:Y,mcConfig:Y,tosConfigReady:l().func,overrideTosHidden:l().bool,labelSizeSm:l().bool,disabled:l().bool,asteriskColor:l().string,pageLocation:l().string,accountSource:l().string}},53138:function(e,t,n){n.d(t,{I:function(){return a}});var i=n(35554),s=n.n(i),o=n(70354),r=n(78376),a=function(e){var t=(0,o.Z)();return s()(r,e)[t]||""}}}]);