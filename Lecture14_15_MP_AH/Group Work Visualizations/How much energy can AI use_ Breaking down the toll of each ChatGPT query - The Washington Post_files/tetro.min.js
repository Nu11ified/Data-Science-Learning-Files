!function(){"use strict";function t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function e(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){l(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function n(){n=function(){return e};var t,e={},o=Object.prototype,a=o.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function p(t,e,n,o){var a=e&&e.prototype instanceof v?e:v,r=Object.create(a.prototype),s=new P(o||[]);return i(r,"_invoke",{value:C(t,n,s)}),r}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var w="suspendedStart",g="suspendedYield",f="executing",m="completed",h={};function v(){}function y(){}function b(){}var S={};u(S,s,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(L([])));E&&E!==o&&a.call(E,s)&&(S=E);var O=b.prototype=v.prototype=Object.create(S);function T(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,i,r,s){var c=d(t[o],t,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==typeof u&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,r,s)}),(function(t){n("throw",t,r,s)})):e.resolve(u).then((function(t){l.value=t,r(l)}),(function(t){return n("throw",t,r,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(t,a){function i(){return new e((function(e,o){n(t,a,e,o)}))}return o=o?o.then(i,i):i()}})}function C(e,n,o){var a=w;return function(i,r){if(a===f)throw new Error("Generator is already running");if(a===m){if("throw"===i)throw r;return{value:t,done:!0}}for(o.method=i,o.arg=r;;){var s=o.delegate;if(s){var c=R(s,o);if(c){if(c===h)continue;return c}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(a===w)throw a=m,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);a=f;var l=d(e,n,o);if("normal"===l.type){if(a=o.done?m:g,l.arg===h)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(a=m,o.method="throw",o.arg=l.arg)}}}function R(e,n){var o=n.method,a=e.iterator[o];if(a===t)return n.delegate=null,"throw"===o&&e.iterator.return&&(n.method="return",n.arg=t,R(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),h;var i=d(a,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var r=i.arg;return r?r.done?(n[e.resultName]=r.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function L(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(a.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(typeof e+" is not iterable")}return y.prototype=b,i(O,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=u(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,l,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},T(k.prototype),u(k.prototype,c,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,o,a,i){void 0===i&&(i=Promise);var r=new k(p(t,n,o,a),i);return e.isGeneratorFunction(n)?r:r.next().then((function(t){return t.done?t.value:r.next()}))},T(O),u(O,l,"Generator"),u(O,s,(function(){return this})),u(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var o in e)n.push(o);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},e.values=L,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(o,a){return s.type="throw",s.arg=e,n.next=o,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var c=a.call(r,"catchLoc"),l=a.call(r,"finallyLoc");if(c&&l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&a.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var r=i?i.completion:{};return r.type=t,r.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var a=o.arg;I(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:L(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),h}},e}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function a(t,e,n,o,a,i,r){try{var s=t[i](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(o,a)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){a(r,o,i,s,c,"next",t)}function c(t){a(r,o,i,s,c,"throw",t)}s(void 0)}))}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,f(o.key),o)}}function c(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e,n){return(e=f(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e){if(null==t)return{};var n,o,a=function(t,e){if(null==t)return{};var n,o,a={},i=Object.keys(t);for(o=0;o<i.length;o++)n=i[o],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,a,i,r,s=[],c=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=i.call(n)).done)&&(s.push(o.value),s.length!==e);c=!0);}catch(t){l=!0,a=t}finally{try{if(!c&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(l)throw a}}return s}}(t,e)||w(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t){return function(t){if(Array.isArray(t))return g(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||w(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){if(t){if("string"==typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(t,e):void 0}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function f(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}var m,h=[],v=["www.washingtonpost.com","pb-impact.washingtonpost.com",".*-sandbox.washingtonpost.com","pb-dev.digitalink.com","pb-staging.digitalink.com","subs-stage.washingtonpost.com","localhost.digitalink.com","localhost.washingtonpost.com","subscribe.digitalink.com",".*.preview.now.washingtonpost.com",".*carta.digitalink.com","^localhost$"],y={prod:{anon:{default:864e5,optedOut:63072e6},signed:{default:864e5,optedOut:864e5}},fStage:{anon:{default:3e5,optedOut:63072e6},signed:{default:3e5,optedOut:3e5}},fqa:{anon:{default:3e5,optedOut:18e5},signed:{default:3e5,optedOut:3e5}},stage:{anon:{default:864e5,optedOut:63072e6},signed:{default:864e5,optedOut:864e5}},qa:{anon:{default:3e5,optedOut:18e5},signed:{default:3e5,optedOut:3e5}}};function b(t){for(var e=!1,n=0;n<v.length;n+=1){var o=new RegExp(v[n]);if(t.match(o)){e=!0;break}}return e}function S(){if(void 0!==m)return m;try{var t=(new Date).toString();window.localStorage.setItem(t,t);var e=window.localStorage.getItem(t)===t;return window.localStorage.removeItem(t),m=e,e}catch(t){return m=!1,!1}}function _(t){if(!t)return null;if(!document.cookie)return null;for(var e=null,n=document.cookie.split(";"),o=0;o<n.length;o++)if(n[o].indexOf("=")>0){var a=n[o].split("="),i=a[0],r=a[1];i&&(i=i.trim()),i===t&&(r||(r=""),e=r.trim()),r.trim()}return e}function E(t,e,n,o,a,i){var r,s="",c="",l=".washingtonpost.com",u=!1===a?"":";secure";n<0?s=";expires=".concat(new Date(1e3).toUTCString):n>0&&(s=";expires=".concat(new Date(n).toUTCString())),"qa"===i&&(l=".digitalink.com"),null!=l&&(c=";domain=".concat(l)),e||(e=""),r=o?e:encodeURIComponent(e);var p="".concat(t,"=").concat(r,";path=/").concat(s).concat(c).concat(u);document.cookie=p}function O(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function T(t,e,n){S()&&!O(e)&&(b(window.location.hostname)&&(e.e=Date.now()+(n||0),localStorage.setItem(t,JSON.stringify(e))))}var k=/^2\d\d$/,C={};function R(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=o.timeout||3e3;if(e=e||"GET",n=n&&JSON.stringify(n)||null,"GET"===e&&C[t])return C[t];var i=new Promise((function(i,r){var s=new XMLHttpRequest;s.open(e,t,!0),s.timeout=a,o.contentType&&s.setRequestHeader("Content-Type",o.contentType),o.hasOwnProperty("withCredentials")&&!o.withCredentials||(s.withCredentials=!0),s.onload=function(e){if(4===(e=e.target||{}).readyState&&k.test(e.status)){var n={};try{(n=JSON.parse(e.response)).statusCode=e.status,i(n),delete C[t]}catch(e){r(new Error("Failed to parse response")),delete C[t]}}else e.status>=400&&(r({message:e.status}),delete C[t])},s.onerror=function(){r({error:"XHR"}),delete C[t]},s.ontimeout=function(){r({timeout:a}),delete C[t]},s.send(n)}));return"GET"===e&&(C[t]=i),i}function A(t,e){e||(e=window.location.href),t=t.replace(/[[\]]/g,"\\$&");var n=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function I(){if(void 0===window.crypto)return null;var t=window.crypto||window.msCrypto;return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^t.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}function P(){var t=document.cookie.match(/wapo_login_id=([^;]*)/),e=document.cookie.match(/wapo_secure_login_id=([^;]*)/);return null!=t&&null!=t[1]&&""!==t[1]&&null!=e&&null!=e[1]&&""!==e[1]}var L="wapo_identity",j="wapo_secure_login_id",N="wp_usp",D="privacy_banner",U="wall-ui",x=["US|CA"],M={iabSpec:1,explicitNotice:"Y",optOut:"N",lspa:"Y"},G={prod:{env:"prod",feLoggingApi:"https://www.washingtonpost.com/subscribe/logging/",tetroApi:"https://www.washingtonpost.com/tetro/metering/evaluate",osnApi:"https://www.washingtonpost.com/tetro/osn/v1/engine/evaluate",getMAPConfigAPI:"https://www.washingtonpost.com/tetro/wall/v1/engine/get-map-config",offerApi:"https://subscribe.washingtonpost.com/offers/service/v2/offers/mapped/",offerMappedApi:"https://subscribe.washingtonpost.com/offers/service/get-mapped-adot-offer",cookieDomain:".washingtonpost.com",LSDomain:"www.washingtonpost.com",authStatusUrl:"https://www.washingtonpost.com/subscribe/user/auth-status",sipUrl:"https://www.washingtonpost.com/subscribe/user/save-identity-preferences",checkEntitlementUrl:"https://subscribe.washingtonpost.com/swg/check-entitlement",checkRrmeTokenUrl:"https://subscribe.washingtonpost.com/partnership/rrme/v1/entitlement/check",activateRrmeTokenUrl:"https://subscribe.washingtonpost.com/partnership/rrme/v1/entitlement/activate",validateRrmeSubsTokenUrl:"https://subscribe.washingtonpost.com/partnership/rrme/v1/entitlement/validate",privacyFooterUrl:"https://www.washingtonpost.com/subscribe/data-privacy/data-privacy-footer.min.js",privacyApiWrapperUrl:"https://www.washingtonpost.com/subscribe/privacy-fe-api/privacy-fe-api.min.js",signin:"https://www.washingtonpost.com/subscribe/signin",registerShowcase:"https://www.washingtonpost.com/subscribe/user/google-register/",subscribe:"https://subscribe.washingtonpost.com/"},fStage:{env:"stage",feLoggingApi:"https://subs-stage.washingtonpost.com/logging/",tetroApi:"https://subs-stage.washingtonpost.com/tetro/metering/evaluate",osnApi:"https://subs-stage.washingtonpost.com/tetro/osn/v1/engine/evaluate",getMAPConfigAPI:"https://subs-stage.washingtonpost.com/tetro/wall/v1/engine/get-map-config",offerApi:"https://subs-stage.washingtonpost.com/offers/service/v2/offers/mapped/",offerMappedApi:"https://subs-stage.washingtonpost.com/offers/service/get-mapped-adot-offer",cookieDomain:".washingtonpost.com",LSDomain:"www.wapostage.com",authStatusUrl:"https://subs-stage.washingtonpost.com/user/auth-status",sipUrl:"https://subs-stage.washingtonpost.com/user/save-identity-preferences",checkEntitlementUrl:"https://subs-stage.washingtonpost.com/swg/check-entitlement",checkRrmeTokenUrl:"https://subs-stage.washingtonpost.com/partnership/rrme/v1/entitlement/check",activateRrmeTokenUrl:"https://subs-stage.washingtonpost.com/partnership/rrme/v1/entitlement/activate",validateRrmeSubsTokenUrl:"https://subs-stage.washingtonpost.com/partnership/rrme/v1/entitlement/validate",privacyFooterUrl:"https://subs-stage.washingtonpost.com/data-privacy/data-privacy-footer.min.js",privacyApiWrapperUrl:"https://subs-stage.washingtonpost.com/privacy-fe-api/privacy-fe-api.min.js",signin:"https://subs-stage.washingtonpost.com/signin/",registerShowcase:"https://subs-stage.washingtonpost.com/user/google-register/",subscribe:"https://subs-stage.washingtonpost.com/acquisition/"},stage:{env:"stage",feLoggingApi:"https://subs-stage.washingtonpost.com/logging/",tetroApi:"https://subs-stage.washingtonpost.com/tetro/metering/evaluate",osnApi:"https://subs-stage.washingtonpost.com/tetro/osn/v1/engine/evaluate",getMAPConfigAPI:"https://subs-stage.washingtonpost.com/tetro/wall/v1/engine/get-map-config",offerApi:"https://subs-stage.washingtonpost.com/offers/service/v2/offers/mapped/",offerMappedApi:"https://subs-stage.washingtonpost.com/offers/service/get-mapped-adot-offer",cookieDomain:".washingtonpost.com",LSDomain:"www.washingtonpost.com",authStatusUrl:"https://subs-stage.washingtonpost.com/user/auth-status",sipUrl:"https://subs-stage.washingtonpost.com/user/save-identity-preferences",checkEntitlementUrl:"https://subs-stage.washingtonpost.com/swg/check-entitlement",checkRrmeTokenUrl:"https://subs-stage.washingtonpost.com/partnership/rrme/v1/entitlement/check",activateRrmeTokenUrl:"https://subs-stage.washingtonpost.com/partnership/rrme/v1/entitlement/activate",validateRrmeSubsTokenUrl:"https://subs-stage.washingtonpost.com/partnership/rrme/v1/entitlement/validate",privacyFooterUrl:"https://subs-stage.washingtonpost.com/data-privacy/data-privacy-footer.min.js",privacyApiWrapperUrl:"https://subs-stage.washingtonpost.com/privacy-fe-api/privacy-fe-api.min.js",signin:"https://subs-stage.washingtonpost.com/signin/",registerShowcase:"https://subs-stage.washingtonpost.com/user/google-register/",subscribe:"https://subs-stage.washingtonpost.com/acquisition/"},fQa:{env:"qa",feLoggingApi:"https://subscribe.digitalink.com/logging/",tetroApi:"https://tetro.digitalink.com/metering/evaluate",osnApi:"https://tetro.digitalink.com/osn/v1/engine/evaluate",getMAPConfigAPI:"https://tetro.digitalink.com/wall/v1/engine/get-map-config",offerApi:"https://www.digitalink.com/offers/service/v2/offers/mapped/",offerMappedApi:"https://www.digitalink.com/offers/service/get-mapped-adot-offer",cookieDomain:".digitalink.com",LSDomain:"www.wapodev.com",authStatusUrl:"https://subscribe.digitalink.com/user/auth-status",sipUrl:"https://subscribe.digitalink.com/user/save-identity-preferences",checkEntitlementUrl:"https://subscribe.digitalink.com/swg/check-entitlement",checkRrmeTokenUrl:"https://subscribe.digitalink.com/partnership/rrme/v1/entitlement/check",activateRrmeTokenUrl:"https://subscribe.digitalink.com/partnership/rrme/v1/entitlement/activate",validateRrmeSubsTokenUrl:"https://subscribe.digitalink.com/partnership/rrme/v1/entitlement/validate",privacyFooterUrl:"https://subscribe.digitalink.com/data-privacy/data-privacy-footer.min.js",privacyApiWrapperUrl:"https://subscribe.digitalink.com/privacy-fe-api/privacy-fe-api.min.js",signin:"https://subscribe.digitalink.com/signin/",registerShowcase:"https://subscribe.digitalink.com/user/google-register/",subscribe:"https://subscribe.digitalink.com/"},qa:{env:"qa",feLoggingApi:"https://subscribe.digitalink.com/logging/",tetroApi:"https://tetro.digitalink.com/metering/evaluate",osnApi:"https://tetro.digitalink.com/osn/v1/engine/evaluate",getMAPConfigAPI:"https://tetro.digitalink.com/wall/v1/engine/get-map-config",offerApi:"https://www.digitalink.com/offers/service/v2/offers/mapped/",offerMappedApi:"https://www.digitalink.com/offers/service/get-mapped-adot-offer",cookieDomain:".digitalink.com",LSDomain:"pb-dev.digitalink.com",authStatusUrl:"https://subscribe.digitalink.com/user/auth-status",sipUrl:"https://subscribe.digitalink.com/user/save-identity-preferences",checkEntitlementUrl:"https://subscribe.digitalink.com/swg/check-entitlement",checkRrmeTokenUrl:"https://subscribe.digitalink.com/partnership/rrme/v1/entitlement/check",activateRrmeTokenUrl:"https://subscribe.digitalink.com/partnership/rrme/v1/entitlement/activate",validateRrmeSubsTokenUrl:"https://subscribe.digitalink.com/partnership/rrme/v1/entitlement/validate",privacyFooterUrl:"https://subscribe.digitalink.com/data-privacy/data-privacy-footer.min.js",privacyApiWrapperUrl:"https://subscribe.digitalink.com/privacy-fe-api/privacy-fe-api.min.js",signin:"https://subscribe.digitalink.com/signin/",registerShowcase:"https://subscribe.digitalink.com/user/google-register/",subscribe:"https://subscribe.digitalink.com/"}};function F(){var t="prod";return-1!==window.location.hostname.indexOf("localhost.wash")&&-1!==window.location.href.indexOf("/pb/")||-1!==window.location.hostname.indexOf("pb-impact")||-1!==window.location.hostname.indexOf("impact.wash")||-1!==window.location.hostname.indexOf("subs-stage")||-1!==window.location.hostname.indexOf("vforum-stage.")?t="stage":-1!==window.location.hostname.indexOf("localhost.wash")&&-1!==window.location.href.indexOf("/pf/")||-1!==window.location.hostname.indexOf("localhost.wash")||-1!==window.location.hostname.indexOf("sandbox.wash")||-1!==window.location.hostname.indexOf("subs-stage")||-1!==window.location.hostname.indexOf("preview.now.washingtonpost.com")?t="fStage":-1!==window.location.hostname.indexOf("localhost.digitalink")&&-1!==window.location.href.indexOf("/pf/")||-1!==window.location.hostname.indexOf("localhost.digitalink")&&-1!==window.location.href.indexOf(":3000")||-1!==window.location.hostname.indexOf("www.digitalink.com")||-1!==window.location.hostname.indexOf("dev.wash")&&-1!==window.location.href.indexOf("/pf/")?t="fQa":-1===window.location.hostname.indexOf("digitalink.com")&&-1===window.location.hostname.indexOf("dev.wash")&&-1===window.location.hostname.indexOf("localhost")||(t="qa"),t}function W(){return G[F()]}var J={},Q=window.performance&&window.performance.timing||{},q=(new Date).getTime(),B={};function Y(t){Object.assign(B,t),window.pwapiPaywallResponse=B;for(var e=0;e<window.extConsumers.length;e++)window.extConsumers[e](B);for(var n=0;n<window.consumers.length;n++)window.consumers[n](B)}function V(t,e){for(var n=e.split("."),o=0,a=n.length;null!=t&&o<a;){t=t[n[o++]]}return o&&o===a?t:void 0}var H=(new Date).getTime();function K(t){var e,n=t.appName,o=void 0===n?"site-paywall":n,a=t.locationId,i=void 0===a?"pwapi-proxy":a,r=t.logType,s=t.message,c=t.state,l=t.innerFunction,u=W();switch(c=c||{},s=s||"no message",r){case"info":default:e="logInfo";break;case"success":e="logSuccess";break;case"error":e="logHandledError";break;case"expectedError":e="logExpectedError"}var p=u.feLoggingApi;try{var d=new XMLHttpRequest;d.open("POST",p+e,!0),d.setRequestHeader("Content-Type","application/json"),c.processId=H,c.path=window.location.pathname;var w={appName:o,locationId:"".concat(i,":").concat(l,":").concat(r),message:s,state:c};d.withCredentials=!0,d.send(JSON.stringify(w)),d.onload=function(){},d.onerror=function(){}}catch(t){console.error("LOGGING ERROR")}}function z(t){var e;(t=t||{}).referrer=document.referrer,Object.assign(t,(e={},window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,n,o){h.indexOf(n)>=0&&(e[n]=o)})),e));var n="";for(var o in t)if(t.hasOwnProperty(o)){var a=t[o];"string"==typeof a&&""!==a&&(n+="".concat(o,"=").concat(encodeURIComponent(a.trim()),"&"))}return n}function X(t){var e=W()||{};return new Promise((function(n,o){var a={entitlements:t};if(P())return n({status:"NOT_CHECKED",systemMessages:"User logged in"});R(e.checkEntitlementUrl,"POST",a,{contentType:"application/json"}).then((function(t){n(t)})).catch((function(t){var e={status:"ERROR",systemMessages:"Check Entitlement failed with ".concat(t.message)};n(e)}))}))}function $(){return P()&&null!==_("wapo_actmgmt")&&_("wapo_actmgmt").includes("isub:1")}function Z(t){var e=[];return Object.entries(t).forEach((function(t){var n=p(t,2),o=n[0],a=n[1];Array.isArray(a)?a&&a.length>0&&e.push.apply(e,d(a)):"boolean"==typeof a?!0===a&&e.push("subs_".concat(o).toLowerCase()):""!==a&&null!==a&&e.push("subs_".concat(o,"_").concat(a).toLowerCase())})),e.join(",")}function tt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(e&&""!==e){var o,a=e.split(","),i=[],r={fusion:{metadata:"wpMetaData",content_type:"content_type",ct_tags:"ct_tags",sct_tags:"sct_tags"},classic:{metadata:"wp_meta_data",content_type:"contentType",ct_tags:"tags_for_paywall",sct_tags:"tags_for_paywall_subs"}}[n||J.name],s=window[r.metadata]||{},c=r[t];o=s[c]&&s[c].split(",")||[],i=[].concat(d(o),d(a)),s[c]=i.join(","),window[r.metadata]=s}}function et(t){var e=null==t?void 0:t.actionCodes;(function(t){var e=!1,n=_("wp_dbg_ent");return((null==t?void 0:t.toString().indexOf("23"))>=0||null!=n)&&(e=!0),e}(e)&&tt("sct_tags","subs_enterprise"),(null==t?void 0:t.action)>0&&null!=t&&t.userAttributes)&&tt("sct_tags",Z(null==t?void 0:t.userAttributes));(null==t?void 0:t.action)>=0&&null!=t&&t.targetingAttributes&&tt("ct_tags",Z(null==t?void 0:t.targetingAttributes));((null==t?void 0:t.action)>0&&function(t){var e;return t&&((null==t?void 0:t.isSignedIn)||(null==t?void 0:t.userAttributes)&&(null==t||null===(e=t.userAttributes)||void 0===e?void 0:e.isSignedIn))||!1}(t)&&tt("sct_tags","subs_signedin"),(null==t?void 0:t.action)>0&&function(t){var e;return t&&((null==t?void 0:t.isSubscriber)||(null==t?void 0:t.userAttributes)&&(null==t||null===(e=t.userAttributes)||void 0===e?void 0:e.isSubscriber))||!1}(t)&&tt("sct_tags","subs_subscriber"),(null==t?void 0:t.action)>0)&&tt("ct_tags",e.filter((function(t){return t.indexOf("w_")>-1})).join(","));(null==t?void 0:t.action)>0&&tt("ct_tags","subs_".concat(null==t?void 0:t.meterCount))}function nt(t){var e={utm_medium:A("utm_medium"),utm_source:A("utm_source"),utm_campaign:A("utm_campaign"),utm_content:A("utm_content")};Object.keys(e).forEach((function(n){""!==e[n]&&null!==e[n]&&(t[n]=e[n])}))}function ot(t){return nt(t),function(t){if(!S())return null;var e=JSON.parse(localStorage.getItem("wapo_identity"));void 0!==(null==e?void 0:e.dob_source)&&(t.tetro_dob_source=e.dob_source)}(t),function(t){var e={gaa_at:A("gaa_at"),gaa_ts:A("gaa_ts"),gaa_n:A("gaa_n"),gaa_sig:A("gaa_sig")};Object.keys(e).every((function(t){return""!==e[t]&&null!==e[t]}))&&(Object.keys(e).forEach((function(n){t[n]=e[n]})),t.full_url=encodeURIComponent(window.location.href))}(t),t}function at(t,e){window.zeus=window.zeus||{},window.zeus.cmd=window.zeus.cmd||[],window.zeus.cmd.push((function(n){n.emit(t,e)}))}function it(){var t=_("wp_geo");return x.some((function(e){return null==t?void 0:t.includes(e)}))}var rt=36e5,st=[{name:"wapo_login_id",expireOffsetMillis:rt,cookiesToLocalStorage:!1,localStorageToCookies:!0,useDelimiter:!1},{name:"wapo_secure_login_id",expireOffsetMillis:rt,cookiesToLocalStorage:!1,localStorageToCookies:!0,useDelimiter:!1},{name:"wp_ak_v_mab",expireOffsetMillis:5184e6,cookiesToLocalStorage:!0,localStorageToCookies:!0,useDelimiter:!0,delimiterValue:"|",notEncoded:!0},{name:"wp_ak_subs",expireOffsetMillis:18144e5,cookiesToLocalStorage:!0,localStorageToCookies:!0,useDelimiter:!0,delimiterValue:"|",notEncoded:!0,resyncRequired:!0}];function ct(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={},o={};if(S()){for(var a=0;a<st.length;a++){var i=st[a];if(!e||i.resyncRequired)try{var r=i.name,s=_(r),c=localStorage.getItem(r),l={};if(c)try{(l=JSON.parse(c)).e<(new Date).getTime()&&(l={},localStorage.removeItem(r))}catch(t){l={},localStorage.removeItem(r)}var u=null!=s,p=null!=l.v;if(p&&!u&&i.localStorageToCookies&&(E(r,l.v,l.e,i.notEncoded,!0,t),o[r]=l.v),!p&&u&&i.cookiesToLocalStorage&&T(r,{v:s},i.expireOffsetMillis),u&&p&&i.useDelimiter){var d=i.delimiterValue||"|",w=new RegExp("(.*)\\"+d+"([^"+d+"]*)$"),g=s.match(w),f=g&&g[2]||"",m=l.v.match(w),h=m&&m[2]||"";i.cookiesToLocalStorage&&g&&m&&f!==h?T(r,{v:s},i.expireOffsetMillis):i.localStorageToCookies&&g&&m&&g[1]!==m[1]&&(!f||f===h)&&E(r,l.v,l.e||Date.now()+i.expireOffsetMillis,i.notEncoded,!0,t)}}catch(t){console.error("Unable to synchCookiesAndLocalStorage for synchCookie item: ".concat(JSON.stringify(i)),t)}}try{(Object.keys(o).length>0||Object.keys(n).length>0)&&K({logType:"info",message:"User storage Synced",state:{process:"storage-sync","cookie-sync":JSON.stringify(n),"ls-sync":JSON.stringify(o)}})}catch(t){}}}function lt(t,e){return e.numEntitlements=t.entitlements.length,e.raw_entitlements=JSON.stringify(t.entitlements),t.entitlements.forEach((function(t,n){if(t.source.indexOf("washingtonpost.com")>=0)e.postSWGPurchase=!0,t.subscriptionToken?e["entitlement_".concat(n)]="entitlementType=post|subscriptionToken=".concat(t.subscriptionToken):e["entitlement_".concat(n)]="entitlementType=post|subscriptionToken=".concat(t.signedEntitlements);else if(t.subscriptionToken){e.gglSWGPurchase=!0;var o=JSON.parse(t.subscriptionToken);e["entitlement_".concat(n)]="entitlementType=google|orderId=".concat(o.orderId,"|packageName=").concat(o.packageName,"|productId=").concat(o.productId,"|purchaseTime").concat(o.purchaseTime)}})),e}var ut=1704085200,pt={1:"IMPRESSION_PAYWALL",21:"IMPRESSION_METER_TOAST",22:"IMPRESSION_REGWALL",23:"IMPRESSION_SHOWCASE_REGWALL",1024:"ACTION_GET_ENTITLEMENTS",1025:"ACTION_METER_TOAST_SUBSCRIBE_CLICK",1027:"ACTION_METER_TOAST_CLOSED_BY_ARTICLE_INTERACTION",1028:"ACTION_METER_TOAST_CLOSED_BY_SWIPE_DOWN",1029:"ACTION_METER_TOAST_CLOSED_BY_X_CLICKED",1035:"ACTION_SHOWCASE_REGWALL_GSI_CLICK",1036:"ACTION_SHOWCASE_REGWALL_EXISTING_ACCOUNT_CLICK",1060:"ACTION_SHOWCASE_REGWALL_SIWG_CLICK",3007:"EVENT_UNLOCKED_BY_SUSCRIPTION",3008:"EVENT_UNLOCKED_BY_METER",3009:"EVENT_NO_ENTITLEMENTS",3010:"EVENT_HAS_METERING_ENTITLEMENTS",3011:"EVENT_OFFERED_METER",3012:"EVENT_UNLOCKED_FREE_PAGE",3025:"EVENT_SHOWCASE_METERING_INIT"},dt=!1;function wt(){(self.SWG=self.SWG||[]).push((function(t){t.getEventManager().then((function(t){t.registerEventListener((function(t){var e,n=null!==(e=pt[t.eventType])&&void 0!==e?e:"UNKNOWN_EVENT",o={event:"SHOWCASE_".concat(n),googleEventID:t.eventType,googleFullEvent:t};window.dataLayer.push(o),"EVENT_OFFERED_METER"===n&&(dt=!0),"IMPRESSION_SHOWCASE_REGWALL"===n&&(document.documentElement.style.overflow="hidden",window.scrollTo(0,0)),"IMPRESSION_SHOWCASE_REGWALL"!==n&&"IMPRESSION_METER_TOAST"!==n||at("GLOBAL_AD_REFRESH_STOP")}))}))}))}function gt(){document.documentElement.style.overflow=""}function ft(t){Y({action:3,data:{action:3,userAttributes:e(e({},t.data&&t.data.userAttributes?t.data.userAttributes:{}),{},{isFromShowcase:!0,isNewsShowcaseGranted:!1})},filterWallSvcParams:function(t){var e;return t.ct_tags=(null!==(e=t.ct_tags)&&void 0!==e?e:"").split(",").concat(["gns_experience","gns_not_granted"]).join(","),t},sideLoad:!0,sideLoadImmediately:!0})}function mt(t){return t.data.userAttributes.isSignedIn||t.granted?t.data.userAttributes.isSignedIn?!t.data.userAttributes.isSubscriber&&t.granted?{granted:!0,grantReason:"METERING",id:t.data.wapoLoginId,registrationTimestamp:t.data.userAttributes.eaRT?t.data.userAttributes.eaRT:ut}:t.data.userAttributes.isSubscriber||t.granted?{granted:!0,grantReason:"SUBSCRIBER",id:t.data.wapoLoginId,registrationTimestamp:t.data.userAttributes.eaRT?t.data.userAttributes.eaRT:ut,subscriptionTimestamp:t.data.userAttributes.eaST?Math.round(t.data.userAttributes.eaST/1e3):ut}:{granted:!1,id:t.data.wapoLoginId,registrationTimestamp:t.data.userAttributes.eaRT?t.data.userAttributes.eaRT:ut}:{granted:!0,grantReason:"METERING"}:{granted:!1}}function ht(){window.dataLayer.push({event:"newsShowcaseUnlockArticle"}),K({logType:"info",message:"News Showcase Article Unlocked"}),at("GLOBAL_AD_REFRESH_RESUME")}var vt=function(){return new Promise((function(){window.GaaMetering.getLoginPromise().then((function(){window.dataLayer.push({event:"newsShowcaseHandleLoginPromise"}),K({logType:"info",message:"News Showcase Login Redirect"});var t=new URL(W().signin),e=encodeURIComponent(window.location.href);t.searchParams.append("next_url",e),t.searchParams.append("account_location","ONSITE_GOOGLE_SHOWCASE"),window.location=t}))}))},yt=function(t,e,o){return new Promise((function(a){window.GaaMetering.getGaaUserPromise().then((function(t){if(window.dataLayer.push({event:"newsShowcaseRegisterUserPromiseStart"}),!t||!t.credential)throw new Error("GaaUser or GaaUser.credential not found");return fetch(W().registerShowcase,{body:JSON.stringify({token:t.credential,nextUrl:window.location.href}),credentials:"include",headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST"})})).then((function(t){return t.json()})).then(function(){var r=i(n().mark((function i(r){var s,c,l,u;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r&&r.userData&&r.userData.entry){n.next=2;break}throw new Error("Registration response or userData not found");case 2:return s=r.userData.entry.find((function(t){return"isNewUser"===t.key})),window.dataLayer.push({event:"newsShowcaseRegisterUserPromiseEnd",showcaseNewRegistration:s?"true"===s.value:null}),window.registerDisplay&&window.registerDisplay({participant:"registration",info:{state:"registered"}}),e.pwapi_ct_tags=e.pwapi_ct_tags?"".concat(e.pwapi_ct_tags,",gns_registered"):"gns_registered",n.next=8,o(t,e,!0);case 8:c=n.sent,l=mt(c),(u=r.userData.entry.find((function(t){return"dateCreated"===t.key})))&&(l.registrationTimestamp=u.value?Number(u.value):ut),l.granted&&window.dataLayer.push({event:"newsShowcaseRegisterUserGranted",showcaseGrantReason:l.grantReason}),K({logType:"info",message:"News Showcase Sign In",state:{showcaseNewRegistration:s?"true"===s.value:null,updatedUserState:JSON.stringify(l)}}),gt(),a(l);case 16:case"end":return n.stop()}}),i)})));return function(t){return r.apply(this,arguments)}}()).catch((function(t){window.dataLayer.push({event:"newsShowcaseError",showcaseFunction:"registerUserPromise",showcaseError:t.message}),K({innerFunction:"registerUserPromise",logType:"error",message:t.message}),gt()}))}))};function bt(t,e,n,o){var a,i;Promise.race([(i=[{src:"https://accounts.google.com/gsi/client"},{src:"https://news.google.com/swg/js/v1/swg.js",attributes:{"subscriptions-control":"manual"}},{src:"https://news.google.com/swg/js/v1/swg-gaa.js"}].map((function(t){return new Promise((function(e,n){var o=document.createElement("script");o.type="text/javascript",o.src=t.src,o.onload=e,o.onerror=n,t.attributes&&Object.keys(t.attributes).forEach((function(e){o.setAttribute(e,t.attributes[e])})),document.head.appendChild(o)}))})),Promise.all(i)),(a=1e4,new Promise((function(t,e){setTimeout((function(){e(new Error("Timeout: Scripts took longer than expected to load"))}),a)})))]).then((function(){if(!window.GaaMetering)throw new Error("GaaMetering not found");var a=mt(t);window.dataLayer.push({event:"newsShowcaseInit",showcaseInitialUserState:a,showcaseExperience:!0,showcaseOriginalAction:t.action}),K({logType:"info",message:"News Showcase Initialized",state:{initialUserState:JSON.stringify(a)}}),Y({action:0,data:{action:0},status:"final"}),window.GaaMetering.init({allowedReferrers:["subscribe.washingtonpost.com","www.washingtonpost.com"],googleApiClientId:"1020418281798-4h6ogv7vudul9unr9huhg3fpsjf2tg95.apps.googleusercontent.com",handleLoginPromise:vt(),handleSwGEntitlement:function(e){return function(t,e){window.dataLayer.push({event:"newsShowcaseHandleSwGEntitlement"}),K({logType:"info",message:"News Showcase SwG Entitlement"});var n={process:"swg-entitlement"};if(e&&e.entitlements&&e.entitlements.length>0){if(e&&e.entitlements&&e.entitlements.some((function(t){return"google:subscriber"===t.source})))return K({logType:"info",message:"News Showcase SwG Entitlement RRME User"}),gt(),void window.dataLayer.push({event:"newsShowcaseHandleSwGEntitlementValidated"});(n=lt(e,n)).pwresp_action=t.action,n.pwresp_action_final=0,n.pwresp_mtrct=t.data.meterCount,X(e.entitlements).then((function(t){var e=[];e.push("isEntitled=".concat(t.status)),t.createAccount&&e.push("isLinked=".concat(!t.createAccount)),t.systemMessages&&e.push("messages=".concat(t.systemMessages)),n.entitlement_status=e.join("|"),K({logType:"info",message:"News Showcase SwG Entitlement Validated",state:n}),gt(),window.dataLayer.push({event:"newsShowcaseHandleSwGEntitlementValidated"})})).catch((function(){K({logType:"error",message:"News Showcase SwG Entitlement Validation Failed",state:n}),window.dataLayer.push({event:"newsShowcaseHandleSwGEntitlementValidationFailed"}),ft()}))}else n.raw_entitlements=JSON.stringify(e.entitlements),K({logType:"error",message:"News Showcase SwG Entitlement Missing",state:n}),window.dataLayer.push({event:"newsShowcaseHandleSwGEntitlementMissing"}),ft()}(t,e)},publisherEntitlementPromise:Promise.resolve(a),registerUserPromise:yt(e,n,o),showPaywall:function(){return function(t){if(window.dataLayer.push({event:"newsShowcaseShowPaywall",showcaseOfferedGaaMeter:dt}),K({logType:"info",message:"News Showcase Show Paywall",state:{showcaseOfferedGaaMeter:dt}}),at("GLOBAL_AD_REFRESH_STOP"),dt){var e=new URL(W().subscribe);e.searchParams.append("s_l","news_showcase");var n=encodeURIComponent(window.location.href);e.searchParams.append("destination",n),window.location=e}else ft(t)}(t)},unlockArticle:ht,userState:a}),wt()})).catch((function(t){window.dataLayer.push({event:"newsShowcaseError",showcaseFunction:"checkNewsShowcase",showcaseError:t.message}),K({innerFunction:"checkNewsShowcase",logType:"error",message:t.message}),Y({status:"final"})}))}function St(t,e){return new Promise((function(n){var o={token:t,readerId:e};R(W().checkRrmeTokenUrl,"POST",o,{contentType:"application/json"},{timeout:5e3}).then((function(t){n(Boolean(t.ready))})).catch((function(t){K({logType:"error",innerFunction:"swg",message:"rrmeCheckIfAccountForTokenIsReadyError",state:{error:t instanceof Error?t.message:JSON.stringify(t),readerId:e}}),n(!1)}))}))}var _t="wp_rrme_signup_token",Et="hasBeenOfferedRRMESignOnThisSession";function Ot(){E(_t,"")}function Tt(t,e){return new Promise((function(n){var o={token:t,readerId:e};R(W().activateRrmeTokenUrl,"POST",o,{contentType:"application/json"},{timeout:5e3}).then((function(t){var o=Boolean(t.accountActivated);K({logType:"info",innerFunction:"swg",message:"rrmeActivateAccountForToken",state:{readerId:e,accountActivated:o}}),o&&(window.registerDisplay&&window.registerDisplay({participant:"registration",info:{state:"registered"}}),Ot(),window.sessionStorage&&"function"==typeof window.sessionStorage.removeItem&&window.sessionStorage.removeItem(Et)),n(o)})).catch((function(t){K({logType:"error",innerFunction:"swg",message:"rrmeActivateAccountForTokenError",state:{error:t instanceof Error?t.message:JSON.stringify(t),readerId:e,accountActivated:!1}}),n(!1)}))}))}function kt(t){return new Promise((function(e){var n={token:t};R(W().validateRrmeSubsTokenUrl,"POST",n,{contentType:"application/json"},{timeout:5e3}).then((function(t){var n=Boolean(t.valid);n||Ot(),K({logType:"info",innerFunction:"swg",message:"rrmeValidateRrmeSubsToken",state:{readerId:t.readerId,isTokenValid:n}}),e({isTokenValid:n,readerId:t.readerId})})).catch((function(t){K({logType:"error",innerFunction:"swg",message:"rrmeValidateRrmeSubsTokenError",state:{error:t instanceof Error?t.message:JSON.stringify(t),isTokenValid:!1}}),e({isTokenValid:!1})}))}))}function Ct(t,a,r){!function(){var t=document.createElement("script");t.type="text/javascript",t.setAttribute("subscriptions-control","manual"),t.src="https://news.google.com/swg/js/v1/swg.js",t.onerror=function(){},document.head.appendChild(t)}(),function(t,a,r){(window.SUBSCRIPTIONS=window.SUBSCRIPTIONS||[]).push((function(s){var c=!1,l=!1,u={process:"swg-entitlement"};if(-1===window.location.href.indexOf("localhost.")&&-1===window.location.href.indexOf("local.")){var p=F();try{var d="prod"===p?"washingtonpost.com":"stg.washingtonpost.com";s.init("".concat(d,":basic")),s.getEntitlements().then((function(n){var o;return n&&n.entitlements&&n.entitlements.length>0&&(Y(e(e({},r||{}),{},{action:0,data:e(e({},(null==r?void 0:r.data)||{}),{},{action:0,userAttributes:e(e({},(null==r||null===(o=r.data)||void 0===o?void 0:o.userAttributes)||{}),{},{hasSWGEntitlement:!0})}),status:"final"})),c=!0,(u=lt(n,u)).pwresp_action=t,u.pwresp_action_final=0,u.pwresp_mtrct=a),n})).then(function(){var t=i(n().mark((function t(e){var a,i,r,p,d,w,g;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c){t.next=2;break}return t.abrupt("return",e);case 2:if(0!==(i=e.entitlements.find((function(t){return"google:subscriber"===t.source}))).length){t.next=5;break}return t.abrupt("return",e);case 5:if(l=!0,r=null!==(a=i.readerId)&&void 0!==a?a:"not set",u.readerId=r,p=e.raw,u.hasJwtToken=Boolean(p),p){t.next=13;break}return K({logType:"error",innerFunction:"swg",message:"rrmeJwtTokenNotFound",state:{readerId:r}}),t.abrupt("return",e);case 13:if(d=!1,w=!1,null!==window.sessionStorage&&"object"===o(window.sessionStorage)&&"function"==typeof window.sessionStorage.getItem&&"function"==typeof window.sessionStorage.setItem&&(w=!0,d=Boolean(window.sessionStorage.getItem(Et))),u.hasSessionStorage=w,u.hasBeenOfferedRRMESignOnThisSession=d,!d){t.next=20;break}return t.abrupt("return",e);case 20:return t.next=22,St(p,r);case 22:if(g=t.sent,u.isAccountForTokenReady=g,g){t.next=26;break}return t.abrupt("return",e);case 26:if(!P()){t.next=31;break}if(!$()){t.next=31;break}return K({logType:"info",innerFunction:"swg",message:"rrmeSubscriberCaughtWithActMgmtRefresh",state:u}),t.abrupt("return",e);case 31:return u.showingLoginPrompt=!0,s.showLoginPrompt().then((function(){s.showLoginNotification().then((function(){return Tt(p,r)}))}),(function(t){var e,n;w&&window.sessionStorage.setItem(Et,"1");var o=null!==(e=null==t||null===(n=t.activityResult)||void 0===n?void 0:n.code)&&void 0!==e?e:"unknown";K({logType:"info",innerFunction:"swg",message:"rrmeLoginPromptError",state:{error:"Error code: ".concat(o),readerId:r}})})),t.abrupt("return",e);case 34:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).then(function(){var o=i(n().mark((function o(i){var s,p,d,w,g,f;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!c){n.next=2;break}return n.abrupt("return",i);case 2:if(p=_(_t)){n.next=6;break}return Y({status:"final"}),n.abrupt("return",i);case 6:return n.next=8,kt(p);case 8:if(d=n.sent,w=d.isTokenValid,g=d.readerId,w){n.next=15;break}return K({logType:"error",innerFunction:"swg",message:"rrmeTokenNotValid",state:{rrmeSignupToken:p,readerId:g}}),Y({status:"final"}),n.abrupt("return",i);case 15:return l=!0,c=!0,Y(e(e({},r||{}),{},{action:0,data:e(e({},(null==r?void 0:r.data)||{}),{},{action:0,userAttributes:e(e({},(null==r||null===(s=r.data)||void 0===s?void 0:s.userAttributes)||{}),{},{hasSWGEntitlement:!0})}),status:"final"})),u.rrmeSignupToken=p,u.readerId=g,u.cachedEntitlement=!0,u.pwresp_action=t,u.pwresp_action_final=0,u.pwresp_mtrct=a,n.next=26,St(p,g);case 26:if(f=n.sent,u.isAccountForTokenReady=f,f){n.next=30;break}return n.abrupt("return",i);case 30:if(!P()){n.next=35;break}if(!$()){n.next=35;break}return K({logType:"info",innerFunction:"swg",message:"rrmeSubscriberCaughtWithActMgmtRefresh",state:u}),n.abrupt("return",i);case 35:return window.activateAccountForToken||(window.activateAccountForToken=function(){return Tt(p,g)}),window.registerWallConsumer({action:200,data:{action:200,userAttributes:e(e({},r.data&&r.data.userAttributes?r.data.userAttributes:{}),{},{isFromSWG:!0,isSWGGranted:!0,hasSWGEntitlement:!0})},sideLoad:!0,filterWallSvcParams:function(t){var e;return t.ct_tags=(null!==(e=t.ct_tags)&&void 0!==e?e:"").split(",").concat(["rrme_experience","rrme_granted"]).join(","),t},sideLoadImmediately:!0}),n.abrupt("return",i);case 38:case"end":return n.stop()}}),o)})));return function(t){return o.apply(this,arguments)}}()).then((function(t){c&&!l?X(t.entitlements).then((function(t){var e=[];e.push("isEntitled=".concat(t.status)),t.createAccount&&e.push("isLinked=".concat(!t.createAccount)),t.systemMessages&&e.push("messages=".concat(t.systemMessages)),u.entitlement_status=e.join("|"),K({logType:"info",innerFunction:"swg",message:"swg entitlements",state:u})})):l&&K({logType:"info",innerFunction:"swg",message:"swg entitlements",state:u})})).catch((function(){Y({status:"final"})}))}catch(t){Y({status:"final"})}}else Y({status:"final"})}))}(t,a,r),setTimeout((function(){"final"!==B.status&&Y({status:"final"})}),5e3)}function Rt(){var t,n=window.zeusKeyvalues,o=function(){var t,e=_("wp_geo"),n=e&&e.match(/^US\|/g),o=/..[^Y]./;if("function"==typeof __uspapi&&S()&&e&&n)try{window.__uspapi("getUSPData",1,(function(e,n){if(n&&e.uspString.match(o)){var a=localStorage.getItem("_pdfps");a&&(t=JSON.parse(a))}}))}catch(t){}return t}(),a=window.zeusAdUnitPath;return(n||o)&&(t=e(e({},n),{permutive:o})),{adKeyValues:t,adUnitPath:a}}function At(t,e,n){var o,a,i,r,s,c,l,u,p,d=t;null===(o=d.data)||void 0===o||o.action,null===(a=d.data)||void 0===a||null===(a=a.actionCodes)||void 0===a||a.join(","),null===(i=d.data)||void 0===i||i.meterCount,d.status="processing",window.pwapiPaywallStatus=200,d.data&&et(d.data);var w=null===(r=d.data)||void 0===r?void 0:r.meterCount,g={3:"paywall",6:"softwall",9:"regwall"}[null===(s=d.data)||void 0===s?void 0:s.action],f=null===(c=d.data)||void 0===c?void 0:c.wallMeterType,m="";switch(g){case"paywall":m="".concat(f||"meter","_").concat(g),2===(null===(l=d.data)||void 0===l?void 0:l.articleWeight)&&(m="double_meter_".concat(g)),d.data.meterCount=m;break;case"softwall":case"regwall":f&&(d.data.meterCount="".concat(f,"_").concat(g))}if(!0===(null===(u=t.data)||void 0===u||null===(u=u.userAttributes)||void 0===u?void 0:u.isFromShowcase))bt(d,e,n,Pt);else if(function(){if(!S())return!1;var t=localStorage.getItem("wp_sponsored");if(window.location.search.indexOf("das=pw_spsrd_hit")>-1||window.location.search.indexOf("pw_unlock_mgclink")>-1){if(localStorage.setItem("wp_sponsored",window.location.pathname),"function"==typeof window.history.replaceState){var e=window.location.href;e=e.replace(/das=[^\&]*/,""),window.history.replaceState({},null,e)}return!0}return!(!t||window.location.pathname!==t)}())d.status="final",d.action=0,d.data.action=0;else if(!0!==(null===(p=t.data)||void 0===p||null===(p=p.userAttributes)||void 0===p?void 0:p.isSubscriber)&&"acquisition"!==(null==n?void 0:n.content_type)&&"checkout"!==(null==n?void 0:n.content_type)){var h;Ct(null===(h=d.data)||void 0===h?void 0:h.action,w,d)}else d.status="final";return Y(d),d}function It(t,e){t=t||{},e=e||"info",Y({status:"error"});var n={process:"pwapiproxy-response",xhrstatus:t.statusCode};t.timeout&&(n.timeout=t.timeout),K({logType:e,message:t.msg,state:n,innerFunction:"handlePwapiError"})}function Pt(t,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a="v2",i="POST",r=!0,s=7e3,c=[202,469,499];return new Promise((function(l){try{if(t){var u=new XMLHttpRequest;u.open(i,t),u.timeout=s,u.withCredentials=r,u.onload=function(){if(window["pwapi".concat(a,"Response")]=(new Date).getTime()-q,window["pwapiAPI".concat(a,"End")]=(new Date).getTime()-(Q.navigationStart||0),u.readyState===XMLHttpRequest.DONE&&200===u.status){window["pwapiAPI".concat(a,"Ready")]=(new Date).getTime()-(Q.navigationStart||0);var e={};try{(e=JSON.parse(u.response)).statusCode=u.status,o||At(e,t,n),l(e)}catch(t){t.statusCode=-1;var i={status:"error",statusCode:-1,msg:"pwapiproxy response invalid".concat(t.statusText?" - ".concat(t.statusText):"")};o||It(i,"error"),l(i)}}else if(u.readyState===XMLHttpRequest.DONE&&c.indexOf(u.status)>-1)l({status:"error",msg:"ignored status code"});else{var r={status:"error",statusCode:u.status,msg:"pwapiproxy invalid status code"};o||It(r,"error"),l(r)}},u.onerror=function(t){window["pwapiAPI".concat(a,"End")]=(new Date).getTime()-(Q.navigationStart||0);var e={status:"error",statusCode:t&&t.statusCode?t.statusCode:500,msg:"pwapiproxy error"};o||It(e,"error"),l(e)},u.ontimeout=function(){var t={status:"error",statusCode:504,timeout:((new Date).getTime()-q)/1e3,msg:"PWAPIPROXY TIMEOUT"};o||It(t,"expectedError"),l(t)},u.setRequestHeader("Content-Type","application/json");var p,d=z(n),w=window.location.href&&window.location.href.split("?")[0]||"",g="".concat(w,"?").concat(d),f=A("pwapi_token");p=JSON.stringify({articles:[e(e({article:g},Rt()),f&&{parameters:{pwapi_token:f}})]}),window["pwapiAPI".concat(a,"Start")]=(new Date).getTime()-(Q.navigationStart||0),u.send(p)}}catch(t){var m={status:"error",statusCode:500};m.msg="pwapiproxy error".concat(t.message?" - ".concat(t.message):""),o||It(m,"error"),l(m)}}))}function Lt(t){var e=function(){var t=(document.cookie.match(/wp_pwapi=([^\;]*);/)||{})[1]||F(),e=G[t].tetroApi||G.prod.tetroApi;if([/^www-washingtonpost-com/].some((function(t){return t.test(window.location.hostname)}))){var n=document.createElement("a");return n.href=e,n.pathname}return e}();Promise.all([Pt(e,t)]).then((function(){window&&window.RProfiler&&window.pwapiPaywallResponse&&"error"!==window.pwapiPaywallResponse.status&&(window.RProfiler.addInfo("tracepoint","componentmetering","meteringApi"),window.pwapiAPIv2Start&&window.RProfiler.addInfo("indicator","meterstart",window.pwapiAPIv2Start),window.pwapiAPIv2End&&window.RProfiler.addInfo("indicator","meterend",window.pwapiAPIv2End))})).catch((function(){}))}window.consumers=window.consumers||[],window.extConsumers=window.extConsumers||[],B.status="init",window.registerPwapiConsumer=function(t){window.consumers.push(t),t(B)},window.registerExtUpdates=function(t){window.extConsumers.push(t),t(B)},window.extListener=function(t){Y(t)};var jt="GetroSetro",Nt="getroSetroQueue",Dt=["get","set"],Ut=36e5,xt=15e3,Mt=Object.freeze({DEBUG:"DEBUG",INFO:"INFO",ERROR:"ERROR"}),Gt=Object.freeze({DEBUG:[Mt.DEBUG,Mt.INFO,Mt.ERROR],INFO:[Mt.ERROR],ERROR:[Mt.ERROR],NONE:[]}),Ft=[],Wt={},Jt={},Qt={logLevel:Mt.ERROR,ttl:Ut,lastUpdatedTTL:6e4},qt={logLevel:Mt.DEBUG,ttl:Ut,disableLS:!1,disableCheckPref:!1},Bt=function(t){window.dispatchEvent(new CustomEvent(jt,{detail:t}))},Yt=function(t,e){return Bt({type:"value",preference:e,value:t})},Vt=function(t,e){return Bt({type:"update",preference:e,value:t})},Ht=function(t,e){return Bt({type:"verified",preference:e,value:t})};function Kt(t){var e=t.level,n=t.location,o=t.message,a=t.obj,i={timestamp:Date.now(),level:e,location:n,message:o};if(a&&Gt.DEBUG.includes(this.settings.logLevel)&&(i.obj=a),Ft.push(i),Gt.INFO.includes(e)&&(e===Mt.INFO&&K({appName:jt,locationId:n,logType:"info",message:o}),e===Mt.ERROR&&(a=a instanceof Error?{lineNumber:a.lineNumber,message:a.message}:a,K({appName:jt,locationId:n,logType:"error",message:o,state:a||{}}))),Gt[this.settings.logLevel].includes(e)){var r="[".concat(jt,"][").concat(n,"][").concat(e,"]: ").concat(o);e===Mt.ERROR?console.error(r):console.info(r),a&&this.settings.logLevel===Mt.DEBUG&&console.info(a)}}function zt(){try{var t=S()?JSON.parse(localStorage.getItem(jt)):{};return(null==t?void 0:t.GetroSetro)||{}}catch(t){Kt.call(this,{level:Mt.ERROR,location:"getSettings",message:"Failed to load settings",obj:t})}return{}}function Xt(){try{var t=this.settings.hasLocalStorage?JSON.parse(localStorage.getItem(jt)):Wt;return null==t||delete t.GetroSetro,t||{}}catch(t){Kt.call(this,{level:Mt.ERROR,location:"getPreferences",message:"Failed to load preferences",obj:t})}return{}}function $t(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),e=Xt.call(this);return Object.entries(e).filter((function(e){var n=p(e,2);return n[0],n[1].timestamp<t})).map((function(t){return p(t,1)[0]}))}function Zt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=zt.call(this),o=Xt.call(this);if(Object.keys(n).length)Kt.call(this,{level:Mt.DEBUG,location:"setDebug",message:"debug mode disabled"}),this.settings=e(e(e({},this.settings),qt),Qt);else{var a=e(e({},qt),t);this.settings=e(e({},this.settings),a),o[jt]=a,Kt.call(this,{level:Mt.DEBUG,location:"setDebug",message:"debug mode enabled"})}if(o!==Wt)try{localStorage.setItem(jt,JSON.stringify(o)),Kt.call(this,{level:Mt.DEBUG,location:"setDebug",message:"debug mode stashed"})}catch(t){Kt.call(this,{level:Mt.DEBUG,location:"setDebug",message:"localStorage error",obj:t})}}var te=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null===(t=window)||void 0===t||null===(t=t.location)||void 0===t?void 0:t.hostname;return e.includes("www")?"checkpref.washingtonpost.com":["preview.now.washingtonpost.com","pb-impact","subs-stage","localhost.washingtonpost.com"].some((function(t){return e.includes(t)}))?"checkpref-stage.washingtonpost.com":e.includes("subs-preprod")?"checkpref-preprod.washingtonpost.com":["subs-dev","subscribe","localhost.digitalink.com"].some((function(t){return e.includes(t)}))?"checkpref-dev.washingtonpost.com":e};function ee(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location,e=t.origin,n=t.hostname;return"".concat(e.replace(n,te(n)),"/user/").concat(this.settings.loginID)}function ne(){var t=this;return new Promise((function(n,o){t.settings.disableCheckPref&&n({lastUpdated:null});var a=Date.now();a-t.settings.lastUpdatedTimestamp<t.settings.lastUpdatedTTL?n({lastUpdated:t.settings.lastUpdated}):R(ee.call(t),null,null,{withCredentials:!1,timeout:xt}).then((function(o){var i=o.lastUpdated;t.settings=e(e({},t.settings),{},{lastUpdated:i,lastUpdatedTimestamp:a}),n(o)})).catch(o)}))}var oe=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null===(t=window)||void 0===t||null===(t=t.location)||void 0===t?void 0:t.hostname;return[".preview.now.washingtonpost.com","pb-impact","subs-stage"].some((function(t){return e.includes(t)}))?"subs-stage.washingtonpost.com":["localhost","subs-stage.washingtonpost.com","subs-preprod.washingtonpost.com"].some((function(t){return e===t}))?e:"subscribe.washingtonpost.com"},ae=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(e=window)||void 0===e?void 0:e.location,o=n.origin,a=n.hostname;return t=(t=Array.isArray(t)?t:[t]).map((function(t){return"preferences=".concat(t)})).join("&"),"".concat(o.replace(a,oe(a)),"/preferenceapi/v1/current/preferences/get?").concat(t)};function ie(t){return Xt.call(this)[t]||{value:void 0,timestamp:void 0}}function re(t,e){if(t!==jt){var n=Date.now(),a="object"===o(e)?JSON.stringify(e):e;if(this.settings.hasLocalStorage)try{var i=JSON.parse(localStorage.getItem(jt))||{};i[t]={value:e,timestamp:n},localStorage.setItem(jt,JSON.stringify(i)),Kt.call(this,{level:Mt.DEBUG,location:"stashLocal",message:"".concat(t,":").concat(a," [localStorage]")})}catch(t){Kt.call(this,{level:Mt.ERROR,location:"stashLocal",message:"Failed to store locally",obj:t})}else Wt[t]={value:e,timestamp:n},Kt.call(this,{level:Mt.DEBUG,location:"stashLocal",message:"".concat(t,":").concat(a," [shortTermMemory]")})}}function se(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};t=Array.isArray(t)?t:[t];var a=Xt.call(this),i=Object.keys(Jt),r=t.reduce((function(t,e){var n=t.prefsRequested,o=t.prefsToRequest;return i.includes(e)?n.push(e):o.push(e),{prefsRequested:n,prefsToRequest:o}}),{prefsRequested:[],prefsToRequest:[]}),s=r.prefsRequested,c=r.prefsToRequest;s.forEach((function(t){Jt[t].callbacks.push(n),Jt[t].verifiers.push(o)})),c.length&&(c.forEach((function(t){Jt[t]={callbacks:[Vt,n],verifiers:[Ht,o]}})),R(ae(c),null,null,{timeout:xt}).then((function(t){var n=c;"SUCCESS"===(null==t?void 0:t.status)&&Array.isArray(null==t?void 0:t.preferenceValues)?(t.preferenceValues.forEach((function(o){var i,r=o.id.preference.name,s=o.value;n=n.filter((function(t){return t!==r}));var c=JSON.stringify(s);re.call(e,r,s),JSON.stringify(null===(i=a[r])||void 0===i?void 0:i.value)!==c?Jt[r].callbacks.forEach((function(t){return t(s,r)})):Jt[r].verifiers.forEach((function(t){return t(s,r)})),Kt.call(e,{level:Mt.DEBUG,location:"fetchRemote",message:"".concat(r,":").concat(c," - success"),obj:t})})),n.forEach((function(t){return Jt[t].verifiers.forEach((function(e){return e(void 0,t)}))}))):Kt.call(e,{level:Mt.ERROR,location:"fetchRemote",message:"".concat(c," - failure ").concat(t.state),obj:t})})).catch((function(t){Kt.call(e,{level:Mt.ERROR,location:"fetchRemote",message:"".concat(c," - error"),obj:t})})).finally((function(){c.forEach((function(t){return delete Jt[t]}))})))}function ce(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};e=Array.isArray(e)?e:[e];var i=!0,r=Xt.call(this);e.length&&ne.call(this).then((function(r){var s=r.lastUpdated;!s||!n||s>n?(Kt.call(t,{level:Mt.INFO,location:"fetchRemoteCheck",message:"".concat(e," - stale [lastUpdated: ").concat(s," local: ").concat(n,"]")}),i=!1,se.call(t,e,o,a)):Kt.call(t,{level:Mt.INFO,location:"fetchRemoteCheck",message:"".concat(e," - fresh [lastUpdated: ").concat(s," local: ").concat(n,"]")})})).catch((function(e){Kt.call(t,{level:Mt.ERROR,location:"fetchRemoteCheck",message:"checkpref - failure",obj:e})})).finally((function(){i&&e.forEach((function(t){var e,n;Ht(null===(e=r[t])||void 0===e?void 0:e.value,t),a(null===(n=r[t])||void 0===n?void 0:n.value,t)}))}))}var le=/"/g;function ue(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(e&&void 0!==n){var i="object"===o(n)?JSON.stringify(n).replace(le,"'"):n,r=ie.call(this,e).value;re.call(this,e,n),R(function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(e=window)||void 0===e?void 0:e.location,o=n.origin,a=n.hostname;return"".concat(o.replace(a,oe(a)),"/preferenceapi/v1/current/preferences/").concat(t,"/set")}(e),"POST",{value:n},{contentType:"application/json",timeout:xt}).then((function(n){"SUCCESS"===n.status?a({type:"success",preference:e,method:"set"}):(a({type:"error",preference:e,method:"set"}),re.call(t,e,r)),Kt.call(t,{level:Mt.DEBUG,location:"stashRemote",message:"".concat(e,":").concat(i," - success"),obj:n})})).catch((function(n){a({type:"error",preference:e,method:"set"}),re.call(t,e,r),Kt.call(t,{level:Mt.ERROR,location:"stashRemote",message:"".concat(e),obj:n})}))}}function pe(t,e,n,o){var a=Date.now()-this.settings.ttl;!e||e<a?(e?Kt.call(this,{level:Mt.INFO,location:"getLocalCheck",message:"".concat(t," - stale [TTL: ").concat(this.settings.ttl,"]")}):Kt.call(this,{level:Mt.DEBUG,location:"getLocalCheck",message:"".concat(t," - no result")}),ce.call(this,t,e,n,o)):Kt.call(this,{level:Mt.INFO,location:"getLocalCheck",message:"".concat(t," - fresh [TTL: ").concat(this.settings.ttl,"]")})}function de(){var t=this;return new Promise((function(e){$t.call(t,Date.now()-t.settings.ttl).length?ne.call(t).then((function(n){var o=n.lastUpdated;e($t.call(t,o))})).catch((function(n){Kt.call(t,{level:Mt.ERROR,location:"initialGet",message:"checkpref - failure",obj:n}),e([])})):e([])}))}function we(){var t=Xt.call(this),e=window[Nt]||[];return delete window[Nt],e.filter((function(e){return!t.hasOwnProperty(e)||(Yt(t[e].value,e),!1)}))}function ge(){var t=this,e=we.call(this);de.call(this).then((function(n){return se.call(t,[].concat(d(e),d(n)))}))}var fe=function(){function t(){var n=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t);var a,i=S(),s=_("wapo_login_id"),c=_("wapo_secure_login_id"),l=!(!s||!c),u=zt();this.settings=e(e(e({},Qt),o),u),this.settings.hasLocalStorage=!u.disableLS&&i,this.settings.loginID=s,this.settings.logLevel===Mt.DEBUG&&(this.getLog=function(){return Ft}),l?(Dt.forEach((function(t){n[t]=n[t].bind(n)})),ge.call(this),a=function(){return Bt({type:"ready",getroSetro:n})},setTimeout((function(){return a()}),0)):Dt.forEach((function(t){n[t]=function(){}}))}return c(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(t&&"string"==typeof t){var o=ie.call(this,t),a=o.value,i=o.timestamp;return Yt(a,t),pe.call(this,t,i,e,n),a}}},{key:"set",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};"upupdowndownleftrightleftrightbastart"===t?Zt.call(this,e):t&&"string"==typeof t&&ue.call(this,t,e,n)}}]),t}(),me="osn",he=!1,ve=function(t){return K(e({appName:"OSN",locationId:"tetroClient"},t))},ye={};window.osnConsumers=window.osnConsumers||[],window.registerOsnConsumer=function(t){window.osnConsumers.push(t),t(ye)};var be=function(t){Object.assign(ye,t),window.osnEngineResponse=ye;for(var e=0;e<window.osnConsumers.length;e++)window.osnConsumers[e](ye)},Se=function(){var t,n,o,a;R((n=F(),o=(null===(t=window)||void 0===t?void 0:t.wpMetaData)||{},a=new URL(G[n].osnApi||G.prod.osnApi),["alt_sections","commercial_node","content_section","content_type"].forEach((function(t){return a.searchParams.set(t,o[t])})),a.toString()),null,null,{timeout:15e3}).then((function(t){var n=t.action,o=t.data.actionCodes;be(e(e({},t),{},{status:"final"}));200===t.action?(et(t.data),window.registerDisplay({participant:me,callback:function(e){e.name===me&&window.registerWallConsumer&&!0===e.readyDisplay&&window.registerWallConsumer(t)}}),window.registerDisplay({participant:me,status:"ready"}),ve({logType:"info",message:"".concat(n," ").concat(o)})):window.registerDisplay({participant:me,status:"final"})})).catch((function(t){be({status:"error"}),ve({logType:"error",message:"Error fetching OSN Engine",state:t})})),he=!0};var _e="undefined"!=typeof window,Ee=_e&&window.location&&window.location.search.indexOf("debug=true")>-1||!1,Oe=["express-checkout","leaderboard_ad","video","audio","registration"],Te=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=(t?[t]:window.dQ.participants).filter((function(t){var n=window.dQ.participantStatus[t],o=n&&n.info?e({},n.info):{};return n&&null!=n.timeout&&"ready"!==n.status&&"timer started"!==o.statusMsg}));n.forEach((function(t){var n=window.dQ.participantStatus[t];n.info=n&&n.info?e({},n.info):{},n.info.statusMsg="timer started",setTimeout((function(t){var e=window.dQ.participantStatus[t];if("ready"!==e.status&&"final"!==e.status){var n="final"===e.status?"timer ended":"timeout";window.registerDisplay({participant:t,status:"final",info:{statusMsg:n}});var o=window.dConsumers.filter((function(e){return e.participant===t}));if(o.length>0&&"timeout"===n)for(var a=0;a<o.length;a+=1)o[a].callback(e)}}),n.timeout,n.name)}))},ke=function(){if(_e){var t={status:"",readyDisplay:!1,displayGroup:"2"},n=window.dQ||{};n.hold=n.hold||[],window.dConsumers=window.dConsumers||[],n=Object.assign(n,{displayable:{max:3,total:0,1:{concurrent_displayable:1},2:{concurrent_displayable:1}},status:"init",participantStatus:{iab_banner:{name:"iab_banner",status:"",readyDisplay:!1,displayGroup:"1",timeout:3e4},paywall:{name:"paywall",status:"",readyDisplay:!1,displayGroup:"1"},regwall:{name:"regwall",status:"",readyDisplay:!1,displayGroup:"1"},softwall:{name:"softwall",status:"",readyDisplay:!1,displayGroup:"2"}}});var o=!1;try{var a=window.__privacyapi("GEO");a&&(o=a.includes("OPT_IN"))}catch(t){console.error("__privacyapi Error in getting geo status",t)}var i=["paywall","regwall","iab_banner","softwall"];for(o||i.splice(2,1),n.participants=n.participants||i,it()&&(n.participants.unshift(D),n.participantStatus[D]={name:D,status:"",readyDisplay:!1,displayGroup:"1"}),P()&&n.participants.indexOf("osn")<0&&(n.participants.push("osn"),n.participantStatus.osn={name:"osn",status:"",readyDisplay:!1,displayGroup:"2"}),window.dQ=n,window.registerDisplay=function(){var o=arguments.length<=0?void 0:arguments[0],a=o.participant,i=o.status,r=o.callback,s=o.info,c=void 0===s?null:s,l=o.config,u=void 0===l?{}:l,p=o.queueable;if(null!=a){var d=Array.isArray(a)?a:a.split(),w=function(t,e){var o,a=n.participantStatus[t]||{},i=window.dQ.displayable.total;i>0&&!1!==a.queueable&&(null!=e&&e.incrementTotal||null!=e&&e.decrementTotal)&&null!=e&&e.modifyReason&&(null==a||null===(o=a.info)||void 0===o||!o.totalModified)&&(window.dQ.displayable.total=null!=e&&e.incrementTotal?i+1:i-1,e.totalModified=!0),!Ee&&(null==e?void 0:e.modifyReason)&&(null==e||delete e.modifyReason)};d.forEach((function(o){var a=o;if(a&&(n.participantStatus[a]||(n.participantStatus[a]=e(e(e(e({name:a},t),u),null!==c&&{info:c}),(!1===p||Oe.includes(a))&&{queueable:!1}),n.participants.indexOf(a)<0&&n.participants.push(a))),a&&r)!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.participant,n=t.callback;window.dConsumers.push(t),n(window.dQ.participantStatus[e])}({participant:a,callback:r});else if(a&&i)null!==c&&(w(a,c),Object.assign(n.participantStatus[a],{info:e(e({},n.participantStatus[a].info),c)})),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(_e&&null!==(e=e.toLowerCase()).toLowerCase().match(/(ready|final|error)/)&&(!window.dQ.participantStatus[t]||"error"!==window.dQ.participantStatus[t].status)){window.dQ.participantStatus[t].status=e,"final"!==e&&"error"!==e||(window.dQ.participantStatus[t].readyDisplay=!1);var o=window.dQ.participants.filter((function(t){return window.dQ.participantStatus[t]&&""===window.dQ.participantStatus[t].status&&!1!==window.dQ.participantStatus[t].queueable}));Ee&&(console.groupCollapsed("[DF][".concat(t,"-").concat(e,"] still waiting on response...(").concat(o.length,")")),console.table(o),console.groupEnd());var a=!0,i=window.dQ.participants.filter((function(t){var e=window.dQ.participantStatus[t];return!!e&&(("ready"!==e.status&&"final"!==e.status&&!1!==e.queueable||!0===e.readyDisplay)&&(a=!1),"ready"===e.status&&!1===e.readyDisplay&&!1!==e.queueable&&!0===a)}));if(Ee&&(console.groupCollapsed("[DF][".concat(t,"-").concat(e,"] displayable queue(").concat(i.length,"):")),console.table(i),console.groupEnd()),i.length>0){window.dQ.displayableGroup=window.dQ.participantStatus[i[0]]&&window.dQ.participantStatus[i[0]].displayGroup;var r=window.dQ.displayable[window.dQ.displayableGroup],s=window.dQ.participants.filter((function(t){var e=window.dQ.participantStatus[t];return!!e&&!1!==e.queueable&&"ready"===e.status&&e.displayGroup===window.dQ.displayableGroup}));if(s.filter((function(t){var e=window.dQ.participantStatus[t];return!!e&&"ready"===e.status&&e.readyDisplay&&e.displayGroup===window.dQ.displayableGroup})).length<r.concurrent_displayable)for(var c=0,l=0;l<s.length;l+=1){var u=window.dQ.participantStatus[i[l]];u&&r.concurrent_displayable>c&&window.dQ.displayable.total<window.dQ.displayable.max&&(u.readyDisplay=!0,c+=1,window.dQ.displayable.total+=1)}n instanceof Object&&n.alwaysRunCallback&&i.push(t);for(var p=0;p<window.dConsumers.length;p+=1){var d=window.dConsumers[p],w=d.participant,g=d.callback;if(i.indexOf(w)>=0)try{g(window.dQ.participantStatus[w])}catch(t){console.error("Error in display framework callback",t)}}}else if(n instanceof Object&&n.alwaysRunCallback){var f=window.dConsumers.filter((function(e){return e.participant===t}));if(f.length>0)for(var m=0;m<f.length;m+=1){var h=f[m],v=h.participant;(0,h.callback)(window.dQ.participantStatus[v])}}Ee&&(console.groupCollapsed("[DF][".concat(t,"-").concat(e,"] Current participantStatus queue:")),console.table(window.dQ.participantStatus),console.table({"Display Group":window.dQ.displayableGroup,"Total Displayed":window.dQ.displayable.total,"Max Displayable":window.dQ.displayable.max}),console.groupEnd())}}(a,i,c);else if(a&&c){w(a,c),Object.assign(n.participantStatus[a],{info:e(e({},n.participantStatus[a].info),c)}),window.dConsumers.filter((function(t){return t.participant===a})).forEach((function(t){t.callback(n.participantStatus[t.participant])}))}else r||i||c||!a||(n.participantStatus[a]=e(e(e({name:a},t),n.participantStatus[a]),u),n.participants.indexOf(a)<0&&n.participants.push(a));u.timeout&&Te(a)}))}};n.hold.length>0;){var r=n.hold.splice(0,1);window.registerDisplay(r[0])}}},Ce={status:"init"},Re={default:["hd_sub_promo","s_v"],homepage:["hp_sub_promo"]};window.offerConsumers=window.offerConsumers||[],window.registerOfferConsumer=function(t){window.offerConsumers.push(t),t(Ce)};var Ae=function(t){Object.assign(Ce,t);for(var e=0;e<window.offerConsumers.length;e++)window.offerConsumers[e](Ce)},Ie=function(t){var e=Re.default;Re[t.content_type]&&(e=e.concat(Re[t.content_type]));var n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=F(),n=new URL(G[e].offerApi||G.prod.offerApi);return n.searchParams.set("keys",t.join(",")),n.searchParams.set("rawResponse","true"),n.searchParams.set("tosFlag","true"),n.toString()}(e);R(n,null,null,{timeout:3e3}).then((function(t){t.status="SUCCESS",Ae(t)})).catch((function(t){t.status="ERROR",t.timeout&&K({logType:"error",innerFunction:"timeout",message:"Failed to get offer data from tetro client"}),Ae(t)}))};function Pe(){Ie(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}var Le="T",je="1",Ne="wp_s",De=".";function Ue(t){var e=t.join(De);return E(Ne,e,Date.now()+63072e6,!0,!0),e}function xe(t){var e;return/(\/(acq))|((subscribe|subscription)\.)/i.test(window.location.href)?"3":t&&!["homepage","front"].includes(null==(e=t)?void 0:e.content_type)?"2":"1"}function Me(t){var e=_(Ne),n=[];n=e?e.split(De):Fe().split(De),["0","4"].includes(n[5])&&"final"===t.status&&t.data&&t.data.refererType&&(n[5]=t.data.refererType||"0",Ue(n))}function Ge(t){if(!t||!t.document)return"0";var e=t.document.referrer,n=t.location.search,o="1",a=/utm_medium=(email|social)/.exec(n);return a?(o="2","email"===a[1]&&(o="5")):e?/\.(google|bing|ecosia)\.|(duckduckgo|search\.yahoo)\./.test(e)?o="3":/(pinterest|facebook|linkedin|youtube|digg|snapchat|instagram|reddit)\.com|t\.co\/|raindrop\.io|washingtonpostheadlines\.|twitter/.test(e)&&(o="2"):o="4",o}function Fe(t){var e=window,n=_(Ne),o=Math.floor(Date.now()/1e3),a=/\?\S*utm_\S*/.test(e.location.search)?"1":"0",i=[],r=!0;(n&&(i=n.split(De).filter(String)),i.length>7)&&(o>parseInt(i[3],10)+1800?r=!0:(i[3]=o,r=!1));return r||1!=a||0!=i[6]||(r=!0),r?i=[Le,je,o,o,"1","0",a,Ge(e)]:["0","4"].includes(i[7])&&(i[7]=Ge(e)),t&&(i[4]=t),Ue(i)}function We(t){var e,n;Fe(xe(t)),window.registerPwapiConsumer(Me),e=window.dataLayer||[],n=e.push,e.push=function(t){n.call(e,t),t&&t.event&&!t.event.match(/gtm\./)&&Fe(/^acq/.test(t.event)?"4":xe(window.wpMetaData))}}var Je,Qe=["pwapi_contentsection","pwapi_ct_tags","pwapi_sct_tags"],qe=!1,Be=function(t){return K(e({appName:"MAP-walls",locationId:"tetroClient"},t))},Ye={};window.mapConfigConsumers=window.mapConfigConsumers||[],window.registerMAPConfigConsumer=function(t){window.mapConfigConsumers.push(t),t(Ye)};var Ve=function(t){Object.assign(Ye,t),window.getMAPConfigResponse=Ye;for(var e=0;e<window.mapConfigConsumers.length;e++)window.mapConfigConsumers[e](Ye)},He=function(t){var n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=F(),n=new URL(G[e].getMAPConfigAPI||G.prod.getMAPConfigAPI);return Object.keys(t).forEach((function(e){return n.searchParams.set(e,t[e])})),n.toString()}(t);R(n,null,null,{timeout:15e3}).then((function(t){"SUCCESS"===t.status?(Ve(e(e({},t),{},{status:"final"})),Je&&function(t){var n,o,a=t.find((function(t){return"map_external_event"===t.MAP_TYPE&&t.MAP_EXTERNAL_EVENT_TYPE===D}));if(a&&null!=a&&a.wallOutputName){window.registerDisplay({participant:D,status:"ready"});var i={action:(null===(n=window.pwapiPaywallResponse)||void 0===n?void 0:n.action)||6,data:e({action:6},null===(o=window.pwapiPaywallResponse)||void 0===o?void 0:o.data),sideLoad:!0,wallOutputName:null==a?void 0:a.wallOutputName,sideLoadImmediately:!0,mapWall:!0};window.registerWallConsumer?window.registerWallConsumer(i):(window.registerDisplay({participant:U,queueable:!1,callback:function(t){var e;"ready"===t.status&&"final"!==(null===(e=window)||void 0===e||null===(e=e.dQ)||void 0===e||null===(e=e.participantStatus)||void 0===e||null===(e=e[D])||void 0===e?void 0:e.status)&&window.registerWallConsumer(i)}}),setTimeout((function(){var t;"ready"!==(null===(t=window)||void 0===t||null===(t=t.dQ)||void 0===t||null===(t=t.participantStatus)||void 0===t||null===(t=t[U])||void 0===t?void 0:t.status)&&(window.registerWallConsumer?window.registerWallConsumer(i):(Be({logType:"error",message:"registerWallConsumer not found",state:{state:{error:"timeout",requirePrivacyBanner:Je}}}),window.registerDisplay({participant:D,status:"final",info:{alwaysRunCallback:!0,timeout:!0}})))}),2e4))}else window.registerDisplay({participant:D,status:"final",info:{alwaysRunCallback:!0}})}(t.mapConfigs)):(Ve({status:"error"}),Be({logType:"error",message:"Error fetching MAPConfig",state:{error:"status:".concat(t.status),requirePrivacyBanner:Je}}),Je&&window.registerDisplay({participant:D,status:"final",info:{alwaysRunCallback:!0}}))})).catch((function(t){Ve({status:"error"});var n="object"===o(t)?e(e({},t),{},{requirePrivacyBanner:Je}):t;null!=t&&t.timeout&&(n.error="timeout"),Be({logType:"error",message:"Error fetching MAPConfig",state:n}),Je&&window.registerDisplay({participant:D,status:"final",info:{alwaysRunCallback:!0}})})),qe=!0},Ke=function(t,n,o){var a,i,r,s=(null===(a=window)||void 0===a||null===(a=a.wpMetaData)||void 0===a?void 0:a.canonical_url)||"".concat(window.location.origin).concat(window.location.pathname);null!==(i=window)&&void 0!==i&&i.wpMetaData&&(window.wpMetaData.canonical_url=s);var c=null!==(r=window)&&void 0!==r&&r.wpMetaData?e({},window.wpMetaData):{canonical_url:s},l=e(e({},t),{},{destination:c.canonical_url,section:null==t?void 0:t.pwapi_contentsection,ct_tags:c.ct_tags||t.pwapi_ct_tags,sct_tags:c.sct_tags||t.pwapi_sct_tags,refererType:n,action:o});return l.pwapi_contentsection,l.pwapi_ct_tags,l.pwapi_sct_tags,u(l,Qe)};var ze=function(t){console.log("[JTS] Processing"),window.__tcfapi||"S"!==t?window.__tcfapi||(console.log("[JTS] US Reject Mode"),window.jentis.consent.engine.DenyAll()):(console.log("[JTS] US Accept Mode"),window.jentis.consent.engine.AcceptAll()),_jts.push({dnsSetting:window.__tcfapi?"TCF":t,track:"uspapi"}),_jts.push({track:"submit"}),window.__tcfapi?console.log("[JTS] Consent mgmt delegated to OneTrust"):jentis.consent.engine.setConsentData({ga:!0,googleanalytics:!0})},Xe=function(t,e,n,a){null!==window.localStorage&&"object"===o(window.localStorage)&&"function"==typeof window.localStorage.getItem&&null!==window.sessionStorage&&"object"===o(window.sessionStorage)&&"function"==typeof window.sessionStorage.getItem&&(a=window.sessionStorage.getItem("jts_preview_version")||window.localStorage.getItem("jts_preview_version")||a),window.jentis=window.jentis||{},window.jentis.config=window.jentis.config||{},window.jentis.config.frontend=window.jentis.config.frontend||{},window.jentis.config.frontend.cdnhost=t+"/get/"+n+"/web/"+a+"/",window.jentis.config.frontend.vers=a,window.jentis.config.frontend.env=n,window.jentis.config.frontend.project=e,window._jts=window._jts||[];var i=document.createElement("script");i.async=!0,i.src=window.jentis.config.frontend.cdnhost+"lrnojf.js",i.onload=function(){try{__uspapi("getUSPData",1,(function(t,e){console.log("[JTS] check usp api",t,e);var n="DNS";try{e&&t&&(n="Y"===t.uspString.split("")[2]?"DNS":"S")}catch(t){console.log("[JTS] uspData retrieve failed")}ze(n)}))}catch(e){if(window.__tcfapi)console.log("[JTS] Consent mgmt delegated to OneTrust");else{var t="S";/wp_usp=1[-YN]Y[-YN]/.test(document.cookie)&&(t="DNS"),ze(t)}}_jts.push({track:"pageview"}),_jts.push({track:"submit"})},document.head.appendChild(i),window.jentisInitialized=!0};function $e(t){return Ze.apply(this,arguments)}function Ze(){return(Ze=i(n().mark((function t(e){var o,a,i,r,s,c,l,u;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.containerEl,a=e.iframeSrc,i=e.postMessageAction,r=e.postMessageResponseAction,s=e.timeout,c=void 0===s?2e3:s,!(o instanceof HTMLDivElement&&a instanceof URL&&i&&r)){t.next=11;break}return(l=document.createElement("iframe")).id="query-iframe",l.style="border: none;",l.width="0",l.height="0",t.next=9,Promise.race([new Promise((function(t){l.addEventListener("load",(function(){var e;window.addEventListener("message",(function e(n){n.data.action===r&&(window.removeEventListener("message",e),t(n.data))}),!0),null===(e=l.contentWindow)||void 0===e||e.postMessage({action:i},a.origin)})),l.src=a.toString(),o.appendChild(l)})),new Promise((function(t,e){return setTimeout(e,c)}))]).catch((function(){return Promise.resolve(null)})).finally((function(){var t;null===(t=l.parentNode)||void 0===t||t.removeChild(l)}));case 9:return u=t.sent,t.abrupt("return",u);case 11:return t.abrupt("return",null);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function tn(t){switch(t){case"stage":case"fStage":return"https://subs-stage.washingtonpost.com/jucid_iframe/jucid_iframe.html";case"qa":case"fQa":return"https://subscribe.digitalink.com/jucid_iframe/jucid_iframe.html";default:return"https://www.washingtonpost.com/subscribe/jucid_iframe/jucid_iframe.html"}}function en(){return en=i(n().mark((function t(){var e,o,a,i,r,s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=new URLSearchParams(window.location.search),"https://games.washingtonpost.com"!==window.location.origin&&"true"!==e.get("test_jucid_sync")&&"true"!==localStorage.getItem("test_jucid_sync")){t.next=13;break}return o=document.body.firstChild,(a=document.createElement("div")).style="display: none;",a.setAttribute("data-test-id","jucid-sync-container"),o.before(a),i=F(),r=tn(i),t.next=11,$e({containerEl:a,iframeSrc:new URL(r),postMessageAction:"getJucid",postMessageResponseAction:"getJucidResponse"});case 11:if((s=t.sent)&&s.jucid){localStorage.setItem("uuid",s.jucid);try{at("ADD_KEYVALUES",{j_ucid:s.jucid})}catch(t){console.debug(t)}}case 13:case"end":return t.stop()}}),t)}))),en.apply(this,arguments)}function nn(){return V(window,"wpMetaData.authors")}var on,an,rn={};rn.pwapi_contentsection=V(window,"wpMetaData.content_section"),rn.pwapi_ct_tags=(on=nn(),an=V(window,"wpMetaData.ct_tags"),on&&void 0!==an&&an.indexOf(on)<0&&tt("ct_tags",on,"fusion"),V(window,"wpMetaData.ct_tags")),rn.pwapi_sct_tags=V(window,"wpMetaData.sct_tags"),rn.commercial_node=V(window,"wpMetaData.commercial_node"),rn.content_type=V(window,"wpMetaData.content_type"),rn.is_amp="0",rn.env=window.renderingEnv||"",rn.tetro_authors=nn(),rn.tetro_alt_sections=V(window,"wpMetaData.alt_sections"),rn.tetro_subtype=V(window,"wpMetaData.subType"),rn.tetro_published_date=(V(window,"wpMetaData.published_date")||"").toString(),rn.tetro_display_date=(V(window,"wpMetaData.display_date")||"").toString(),rn.arcid=V(window,"wpMetaData.arc_id")||V(window,"wpAdFusion.pageId")||"";var sn,cn=rn,ln=W()||{},un=(sn=ln.env,y[sn]);function pn(t){for(var e=0;e<window.authConsumers.length;e++)window.authConsumers[e](t)}function dn(t){var e=!!_(j),n=!(!t||!t.ccpa||"Y"!==t.ccpa.optOut),o=un&&un[e?"signed":"anon"][n?"optedOut":"default"]||0;return Date.now()+o}function wn(){var t=null;if(S()&&localStorage.getItem(L)){var e=function(){var t=!1;if(S()&&localStorage.getItem(L)){var e=JSON.parse(localStorage.getItem(L));e.e&&Date.now()>e.e&&(t=!0)}return t}();e?S()&&localStorage.removeItem(L):t=JSON.parse(localStorage.getItem(L))}return t}function gn(t){if(S()&&b(window.location.hostname)){var e=localStorage.getItem(L);e=e&&JSON.parse(e)||{};var n=Object.assign(e,t),o=dn(n.privacySetting||{});n.e=o,localStorage.setItem(L,JSON.stringify(n))}}function fn(t){if(S()&&localStorage.getItem(L))return JSON.parse(localStorage.getItem(L))[t]}function mn(t){var e,n,o,a,i,r;return t=t||(e=_(j),n=_(N),o=_("wapo_login_id"),a=fn("signedIn"),i=fn("wapo_login_id"),!1===a&&e?"sip":(window.wp_meta_data&&window.wp_meta_data.tags_for_paywall&&-1!==window.wp_meta_data.tags_for_paywall.indexOf("ccpa")||window.wpMetaData&&window.wpMetaData.ct_tags&&-1!==window.wpMetaData.ct_tags.indexOf("ccpa")||!!(O(wn())||e&&!n||!e&&!0===a||o&&i&&o!==i))&&"auth-status"),new Promise((function(e){!1!==t?function(t){return new Promise((function(e,n){if("auth-status"===t){var o=P(),a=_("wapo_login_id")||"none";R("".concat(ln.authStatusUrl,"?_v=").concat((new Date).getTime())).then((function(t){var n=P();!0===o&&!1===n&&K({logType:"info",message:"authStatus logged user out",state:{url:window.location.href,wapoLoginId:a}}),e(t)})).catch((function(){n({status:"FAIL",errorState:"Auth Status failed"})}))}else if("sip"===t){var i=wn(),r=document.cookie.match(/wp_ucp=[|]?EAC:(1|0)/),s=r&&r.length>1?parseInt(r[1],10):-1,c={caller:"SubsStorageManager",requestId:I(),authStatus:!0,eacFlag:s};c=Object.assign(c,i),R(ln.sipUrl,"POST",c,{contentType:"application/json"}).then((function(t){e(t)})).catch((function(){n("Auth Status failed")}))}else n("Invalid action: ".concat(t))}))}(t).then((function(t){t&&"SUCCESS"===t.status&&gn(r=t.userState)})).finally((function(){pn(r=wn()),e(r)})):(pn(r=wn()),e(r))}))}function hn(t){var e=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");return e?e[2]:null}window.authConsumers=window.authConsumers||[],window.registerAuthConsumer=function(t){window.authConsumers.push(t);var e=wn(),n=document.cookie.match(/wapo_actmgmt=([^;]*)/);n=n&&n[1]||null,null===e&&null!==n&&n.match(/isub:1/gi)||t(wn())},window.updateIdentity=function(t){if(S()){var e=b(window.location.hostname),n=localStorage.getItem(L);if(e&&null!=n)try{n=n&&JSON.parse(n)||{};var o=Object.assign(n,t);localStorage.setItem(L,JSON.stringify(o))}catch(t){}}},window.storePrivacySetting=function(t){t="object"===o(t)?t:{};var n=fn("privacySetting")||{};if(n.ccpa=e(e(e({},M),n.ccpa),t.ccpa),"Y"!==n.ccpa.optOut&&"N"!==n.ccpa.optOut||(n.ccpa.explicitNotice="-"===n.ccpa.explicitNotice?"Y":n.ccpa.explicitNotice,n.ccpa.lspa="Y"),!O(n)){var a=_(j),i="".concat(n.ccpa.iabSpec,n.ccpa.explicitNotice,n.ccpa.optOut,n.ccpa.lspa);if(gn({privacySetting:n}),a)mn("sip");else{var r=F(),s=dn(n);E(N,i,s,!0,!0,r)}}};var vn=function(t,e){var n=t||"1NYY",o={uspString:n,uspStringSet:!1,getUSPString:function(t){return"".concat(t.iabSpec,t.explicitNotice,t.optOut,t.lspa)},setUSPString:function(t){o.uspString=t},getUSPFromLS:function(t){var a=n;if(o.uspStringSet&&o.uspString.length>=4)t(o.uspString);else try{var i,r=hn("wp_ucp");try{i=window.__privacyapi("GEO")}catch(t){e.debug("__privacyapi is not available",t),i="DNS|"}var s=!!i&&i.includes("DNS|"),c=!1;i&&(c=i.includes("OPT_IN|")),!c&&r&&/EAC:0\|/.test(r)||s&&navigator.globalPrivacyControl?a="1YYY":hn("wp_usp")?a=hn("wp_usp"):s||(a="1---");try{if("1YYY"!==a&&localStorage.getItem("wapo_identity")){var l=JSON.parse(localStorage.getItem("wapo_identity"));a=o.getUSPString(l.privacySetting.ccpa)}}catch(t){}if(!a)throw e.log("no usp data in ls or cookie"),new Error("no usp data in ls or cookie");o.setUSPString(a),o.uspStringSet=!0,t(o.uspString)}catch(o){return e.debug("error in accessing usp from local storage: ".concat(o,", returning default")),void t(n)}},getUSPData:function(t,e){o.getUSPFromLS((function(n){e({version:t,uspString:n},o.uspStringSet)}))},v1:{getUSPData:function(t){t?o.getUSPData(1,t):e.log("No uspapi callback received",t)}}};return function(t){window.ucp=window.ucp||{},window.ucp.usp=window.ucp.usp||{},window.ucp.usp.uspStringSet&&(t.uspString=window.ucp.usp.uspString,t.uspStringSet=window.ucp.usp.uspStringSet),window.ucp.usp=t}(o),o},yn=function(t){var e=!1,n=t;try{var o=!!n.addressState&&window.__privacystub.geoInfo(n.addressState,"simple");o&&o.includes("DNS|")&&(e=!0);var a=!!n.geoState&&window.__privacystub.geoInfo(n.geoState,"simple");a&&a.includes("DNS|")&&(e=!0)}catch(t){this.logger.debug("Error checking identity state, window.__privacystub may not be available",t)}return e},bn=function(t){try{if(navigator.globalPrivacyControl&&yn(t))this.uspapi.uspStringSet=!0,this.uspapi.setUSPString("1YYY");else if(t.privacySetting&&t.privacySetting.ccpa){var e=this.uspapi.getUSPString(t.privacySetting.ccpa);this.uspapi.setUSPString(e)}else yn(t)||this.uspapi.setUSPString("1---")}catch(t){this.logger.log("--USP DEBUG-- Auth Processing Failed",t)}},Sn=function(t,e){try{window.registerAuthConsumer?(console.log("Auth Consumer exists"),window.registerAuthConsumer(bn.bind({uspapi:t,logger:e}))):(window.authConsumers=window.authConsumers||[],window.authConsumers.push(bn.bind({uspapi:t,logger:e})))}catch(t){e.log("--USP DEBUG-- Can not register AuthConsumer.",t)}},_n=c((function t(e){r(this,t),window.__uspapi||function(t,e){var n=vn("1NYY",e);window.__uspapi=function(t,o,a){return n["v"+o]&&"[object Function]"==={}.toString.call(n["v"+o][t])?a?void n["v"+o][t].apply(null,[a]):(e.log("No callback"),n["v"+o][t]):(e.log("Malformed uspapi call"),!1)},window.addEventListener("message",(function(t){if(t.data.hasOwnProperty("__uspapiCall")){t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=t.data.__uspapiCall.command,n=t.data.__uspapiCall.version;e&&n&&window.__uspapi(e,n,(function(e,n){var o={__uspapiReturn:{returnValue:e,callId:t.data.__uspapiCall.callId,success:n}};t.source.postMessage(o,t.origin)}))}return null}),!1),t&&t(n,e)}(Sn,e)}));J.name="fusion",function(){try{new _n({log:function(){},debug:console.debug})}catch(t){console.error("USP API attachment may have failed.")}}(),function(t){window.pwapiVersion="Version 1.41.5 on Mon, 03 Mar 2025 20:33:54 GMT",window.pwapiStart=q-(Q.navigationStart||0),window.dataLayer=window.dataLayer||[],ke(),window.registerPwapiConsumer((function(t){("error"===t.status||0===t.action||"final"===t.status&&t.action>0)&&Object.entries({3:"paywall",6:"softwall",9:"regwall"}).forEach((function(e){var n=p(e,2),o=n[0],a=n[1],i="final";o===(t&&t.action||0).toString()&&(i="ready"),window.registerDisplay({participant:a,status:i})}))})),ot(t),function(){var t={};nt(t);var e=[];Object.entries(t).forEach((function(t){var n=p(t,2),o=n[0],a=n[1];""!==a&&null!==a&&e.push("".concat(o,"_").concat(a).toLowerCase())})),tt("ct_tags",e.join(","))}(),We(t),Lt(t),Te(),ct(F()),window.getroSetroQueue=window.getroSetroQueue||[],window.getroSetroQueue.push("newsprint-attributes"),window.getroSetroQueue.push("newsprint-state"),window.getroSetro=new fe,window.registerPwapiConsumer((function(e){"error"!==e.status&&"final"!==e.status||(Pe(t),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.action,o=e.data,a=void 0===o?{userAttributes:{}}:o,i=a.refererType,r=a.userAttributes,s=(void 0===r?{}:r).isSignedIn&&[0,6].includes(n);if(((Je=it())||s)&&!qe&&"classic"!==(null==t?void 0:t.env)){var c=Ke(t,i,n);He(c)}}(t,e),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.action,n=t.data,o=(void 0===n?{userAttributes:{}}:n).userAttributes,a=(void 0===o?{}:o).isSignedIn&&[0,6].includes(e);be({status:"init"}),a&&window.registerDisplay&&!he?Se():be({status:"final",action:0,data:{action:0}})}(e),function(){if(-1!==window.location.href.indexOf("/sf/")){var t=W().privacyFooterUrl,e=document.createElement("script");e.src=t,e.defer=!0,e.type="module",e.id="privacy-footer-script",document.head.appendChild(e)}}(),ct(F(),!0),window.dataLayer.push({event:"tetroEvaluateComplete"}))})),function(){var t=W();if(t&&t.privacyApiWrapperUrl){var e=t.privacyApiWrapperUrl,n=document.createElement("script");n.src=e,n.async=!0,n.id="privacy-wrapper-script",document.head.appendChild(n)}}(),setTimeout((function(){void 0===window.pwapiPaywallResponse&&Pe(t)}),5e3),window.jentisInitialized||(window.__tcfapi?__tcfapi("addEventListener",2,(function(t,e){e&&"tcloaded"===t.eventStatus||"useractioncomplete"===t.eventStatus?(Xe("https://ny77jj.washingtonpost.com","washingtonpost-com","live","_"),__tcfapi("removeEventListener",2,(function(t){}),t.listenerId)):console.log("[JTS] TC Data request has failed")})):Xe("https://ny77jj.washingtonpost.com","washingtonpost-com","live","_"));var e=function(){var t,e=null!==(t=_("wp_ucp"))&&void 0!==t&&t;if(!1!==e&&e.includes("EAC"))return!0;if("build"===window.location.host.split(".")[0])return!0;var n=window.location.search.match(/(gtml|gtmlp)=true/);if(""!==(n?n[1]:""))return!0;var o=!1;try{var a=window.__privacyapi("GEO");o=Boolean(a&&a.match(/OPT_IN\|/))}catch(t){console.error("__privacyapi Error checking GEO status",t)}return o}();window.dataLayer.push({event:"tetroInitComplete",EEAAllocated:e}),function(){en.apply(this,arguments)}()}(cn);try{setTimeout((function(){mn()}),0)}catch(t){}}();
